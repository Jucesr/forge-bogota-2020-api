{"version":3,"sources":["webpack://Autodesk.Extensions.[name]/webpack/bootstrap","webpack://Autodesk.Extensions.[name]/./node_modules/css-loader/dist/runtime/api.js","webpack://Autodesk.Extensions.[name]/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://Autodesk.Extensions.[name]/./Measure/Measure.css?f623","webpack://Autodesk.Extensions.[name]/./Measure/Measure.css","webpack://Autodesk.Extensions.[name]/./node_modules/css-loader/dist/runtime/getUrl.js","webpack://Autodesk.Extensions.[name]/./Measure/res/icon-spinner-sm.svg","webpack://Autodesk.Extensions.[name]/./Measure/Calibration.css?4a6a","webpack://Autodesk.Extensions.[name]/./Measure/Calibration.css","webpack://Autodesk.Extensions.[name]/./Measure/MeasurementsManager.js","webpack://Autodesk.Extensions.[name]/./Measure/Indicator.js","webpack://Autodesk.Extensions.[name]/./Measure/MeasureToolIndicator.js","webpack://Autodesk.Extensions.[name]/./Measure/MeasureTool.js","webpack://Autodesk.Extensions.[name]/./Measure/CalibrationToolIndicator.js","webpack://Autodesk.Extensions.[name]/./Measure/CalibrationPanels.js","webpack://Autodesk.Extensions.[name]/./Measure/CalibrationTool.js","webpack://Autodesk.Extensions.[name]/./Measure/MagnifyingGlass.js","webpack://Autodesk.Extensions.[name]/./Measure/MeasureToolbar.js","webpack://Autodesk.Extensions.[name]/./Measure/Measure.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","useSourceMap","list","toString","this","map","item","content","cssMapping","btoa","sourceMapping","sourceMap","base64","unescape","encodeURIComponent","JSON","stringify","data","concat","sourceURLs","sources","source","sourceRoot","join","cssWithMappingToString","mediaQuery","alreadyImportedModules","length","id","_i","push","memo","stylesInDom","isOldIE","Boolean","window","document","all","atob","getTarget","target","styleTarget","querySelector","HTMLIFrameElement","contentDocument","head","e","listToStyles","options","styles","newStyles","base","part","css","media","parts","addStylesToDom","domStyle","j","refs","addStyle","insertStyleElement","style","createElement","attributes","nonce","keys","forEach","setAttribute","insert","Error","appendChild","textStore","replaceText","index","replacement","filter","applyToSingletonTag","remove","obj","styleSheet","cssText","cssNode","createTextNode","childNodes","removeChild","insertBefore","applyToTag","firstChild","singleton","singletonCounter","update","styleIndex","parentNode","removeStyleElement","newObj","newList","mayRemove","_domStyle","locals","___CSS_LOADER_URL___0___","getUrl","url","needQuotes","default","test","slice","replace","Autodesk","Viewing","MeasureCommon","MeasurementsManager","viewer","init","proto","getCurrentMeasurement","currentMeasurement","selectMeasurementById","measurement","measurementsList","changeCurrentMeasurement","createMeasurement","measurementType","measurementsCounter","Measurement","dispatchEvent","type","Events","MEASUREMENT_CHANGED_EVENT","removeCurrentMeasurement","reset","destroy","Indicator","tool","snapper","getSnapper","materialExtensionLine","materialExtensionFace","extensionLines","extensionFaces","grayOutPlane","materialPoint","materialLine","materialAngle","materialAngleOutline","materialGreyOutPlane","materialFace","angleArc","angleOutline","showMeasureResult","visibleLabels","overlayName","xAxis","autocam","getWorldRightVector","yAxis","getWorldUpVector","zAxis","getWorldFrontVector","updateDistance","updateAngle","clear","updateLabelsPosition","render","picks","hasPick","renderPick","renderRubberband","changeEndpointOnEditStyle","endpointNumber","isEditing","handleResize","setNoTopology","setFetchingTopology","setTopologyAvailable","clientToCanvasCoords","event","rect","impl","getCanvasBoundingClientRect","res","canvasX","x","center","left","canvasY","y","top","pointers","clientX","clientY","initLabelMobileGestures","label","pointNumber","magnifyingGlass","toolController","getTool","hammer","Hammer","Manager","recognizers","GestureRecognizers","drag","singletap","handlePointerEventMouse","inputClass","isIE11","PointerEventInput","TouchInput","onSingleTapBinded","pos","onMouseDown","editEndpoint","onDragStartBinded","editByDrag","handlePressHold","handleGesture","onDragMoveBinded","onDragEndBinded","handleButtonUp","on","clearLabelMobileGestures","off","updateVisibleLabelsArray","isVisible","indexOf","splice","hideEndpoints","endpoints","endpoint","hideLabel","showEndpoints","showLabel","safeToggle","changeEndpointEditableStyle","isEditable","changeAllEndpointsEditableStyle","changeAllEndpointsOnEditStyle","hideLabelsOutsideOfView","model","is2d","show","navigation","isPointVisible","point","classList","contains","toggle","showClick","pickNumber","getActivePointIndex","hideClick","createEndpoint","renderEndpointGeometry","geometry","getSnapResultPosition","getPick","position","clone","drawEdgeAsCylinder","geom","material","linewidth","cylinderGeometry","cylinder","edge","vertices","cylinderMesh","setCylinderScale","drawDashedLine","p1","p2","dashSize","gapSize","width","THREE","Geometry","line","Vector3","subVectors","lineLength","lineDirection","normalize","currLength","addVectors","multiplyScalar","getNewCylinderGeometry","addMultipleOverlays","drawLineAsCylinder","addOverlay","CylinderGeometry","pointX","pointY","direction","orientation","Matrix4","lookAt","Object3D","up","multiply","set","Mesh","applyMatrix","lmv_line_width","z","scale","nearestPointInPointToSegment","getPosition","setScale","navapi","camera","getCamera","distance","isPerspective","sub","getEyeVector","fov","getVerticalFov","Math","tan","degToRad","getScreenViewport","height","alignLabelWithLine","offset","camUpVector","getCameraUpVector","cameraAngle","angleTo","PI","angle","deltaX","deltaY","atan2","abs","transform","isTouchDevice","endPoint","removeEventListener","isSafari","onMouseClickBinded","mousewheel","MeasurementTypes","MEASUREMENT_DISTANCE","previewsPick","activePick","start","end","renderDistanceMeasurement","MEASUREMENT_ANGLE","renderAngleMeasurement","MEASUREMENT_AREA","renderAreaMeasurement","initMouseEvent","pointerType","addEventListener","MeasureToolIndicator","measureTool","lines","xyz","axis","createLineMaterial","className","iconText","segments","dashedLine","simple","angleLabel","areaLabel","labels","isLeaflet","topologyStatus","TOPOLOGY_NOT_AVAILABLE","tmpVector","surfaceColor","MeshBasicMaterial","color","parseInt","opacity","transparent","depthTest","depthWrite","side","DoubleSide","constructor","TOPOLOGY_FETCHING","_tipHeight","_tipWidth","_axisLineWidth","isLeftIntersect","current","other","right","isRightIntersect","isMiddleIntersect","moveRight","currentLabel","currentRect","otherRect","moveDown","bottom","setValueMeasurementLabelText","strValue","div","textContent","setDeltaMeasurementLabelText","setVisibilityMeasurementLabelSpinner","display","MeasureTool","sharedMeasureConfig","_viewer","_names","_sharedMeasureConfig","av","Extensions","Measure","_active","_isDragging","_endpointMoved","_activePoint","_consumeSingleClick","_singleClickHandled","_downX","_downY","_isolateMeasure","_measurementsManager","_currentMeasurement","_onIndicatorCreatedCB","_snapper","_isPressing","_picksBackup","_cursorPosition","_closeAreaSnapRange","_preMeasureIsolatedNodes","_preMeasureHiddenNodes","_measurementType","getActivePick","getMaxNumberOfPicks","countPicks","getPreviousPick","noPicksSet","allPicksSet","enableMeasurementsTouchEvents","indicator","enableSelectionAreas","isNoPicksSet","snapToFirstPick","currentPick","forceSnap","closedArea","firstPick","firstPickPoint","firstPickPosition","project","currentPickPoint","currentPickPosition","distanceTo","onMouseMove","copyTo","showResult","hasResult","computeResult","enable","enableLabelsTouchEvents","areAllPicksSet","register","deregister","deactivate","isActive","getNames","getName","getPriority","getCursor","getCurrentMeasurementRaw","startNewMeasurement","attachIndicator","Function","changeMeasurementType","activate","isEditingEndpoint","pauseHighlight","getIsolatedNodes","getHiddenNodes","clearSelection","activateTool","onMeasurementChangedBinded","onMeasurementChanged","onSwitchMeasurementBinded","onSwitchMeasurement","onRemoveMeasurementBinded","onRemoveMeasurement","getJsonBinded","getJson","CAMERA_CHANGE_EVENT","onCameraChange","ISOLATE_EVENT","onIsolate","clearCurrentMeasurement","deactivateTool","getUnits","units","setUnits","updateResults","getPrecision","precision","setPrecision","getDistanceXYZ","getDistanceAux","distanceXYZ","getDistanceX","distanceX","getDistanceY","distanceY","getDistanceZ","distanceZ","measurementDistance","Private","convertUnits","getUnitString","calibrationFactor","formatValueWithUnits","getAngle","String","fromCharCode","getArea","area","getMeasurement","unitType","geomTypes","from","getGeometry","to","deltaZ","clearPick","updateViewportId","clearIsolate","setIsolateMeasure","isolateMeasurement","isolationGroup","snapNode","isolate","showAll","hide","nodeIdArray","deselectAllMeasurements","undoEditEndpoint","setSimple","unfocusLabels","isComplete","measurementId","isMobileDevice","_handleMouseEvent","setPick","focusLabels","deleteCurrentMeasurement","deleteCurrentPick","count","setViewportId","viewport","viewportIndex2d","correctPickPosition","active","geomType","SnapType","SNAP_VERTEX","geomVertex","intersectPoint","passive","correctPerpendicularPicks","nextPick","valid","isSnapped","copyResults","container","getBoundingClientRect","inverseProject","lastPick","_doConsumeSingleClick","renderSucceeded","hasEqualPicks","measurementComplete","handleButtonDown","button","ctrlKey","metaKey","shiftKey","altKey","handleMouseMove","restoreMouseListeners","controller","enableMouseButtons","handleSingleClick","updateScale","clearOverlays","clearSnapped","handleDoubleClick","handleSingleTap","handleDoubleTap","handleKeyDown","keyCode","KeyCode","BACKSPACE","DELETE","loadJson","json","addMeasurement","addPick","inp","parse","assign","fromTopology","radius","MarkupID","detail","console","log","currLabel","getData","onSelectionAreaClickedBinded","onSelectionAreaClicked","createMeasurementLabel","onCameraChangeBinded","handleButtonUpBinded","createSnapResultLabel","xy","visible","floor","clientHeight","clientWidth","p1Projected","p2Projected","invalidate","xyzDirection","itemDirection","cross","dot","needToStackLabels","labelsStacked","backupPositions","labelsOverlapDetection","stackLabels","staticLabel","labelsList","dynamicLabel","moved","staticRect","dynamicRect","causeStacking","topLabel","space","drawXYZLine","self","tmpVec","normal","drawLineSegment","tips","drawTip","redrawDashedLine","removeMultipleOverlays","p1Scale","isDashedLine","drawSurface","points","shape","Shape","moveTo","lineTo","ShapeGeometry","face","drawSegmentAndPush","isEqualVectors","EPSILON","isPolygonSimple","showAreaLabel","getPolygonVisualCenter","updateArea","clearAngleMeshes","removeOverlay","drawAngle","ep1","ep2","midPoint","MeshPhongMaterial","ambient","createCommonOverlay","min","circleGeometry","CircleGeometry","arc","V","add","updateMatrixWorld","vA","vB","applyMatrix4","matrixWorld","v1","v2","v3","v4","ra","a13","a14","a23","a24","rotWorldMatrix","makeRotationAxis","matrix","rotation","setFromRotationMatrix","outlineGeometry","copy","round","dir","crossVectors","showAngleLabel","createDistanceLabel","setVisibilityMeasurementLabelText","axisIcon","innerText","updateLine","x1","y1","z1","x2","y2","z2","showAxis","getAlignedUpVector","isParallel","displayAxis","setTimeout","setWidth","getWidth","is3d","maxWidth","max","setLineVisible","pointerEvents","setLabelsZIndex","zIndex","tip","clearSelectionAreas","clearOverlay","selectionArea","overlayScenes","removeOverlayScene","clearXYZLine","forAll","segment","spinner","text","delta","label_icon","hitArea","createSelectionArea","updateSelectionArea","v","Vector2","_selectorAreaSize","transformOrigin","element","getElementById","CalibrationToolIndicator","calibrationTool","calibrationLabel","rubberbandDefaultMaterial","rubberbandSnappedMaterial","rubberbandTipMaterial","clearRubberband","updateLabelValue","i18n","translate","changeLabelClickableMode","clickable","showAddCalibrationLabel","onClick","showPanel","renderCalibrationLabel","mid","labelPosition","drawMeasurementLineTip","flip","tipMaterial","lineNormal","lineMaterial","getSnapResult","isPerpendicular","ave","avp","avu","UI","CalibrationPanel","title","addFooter","DockingPanel","parentContainer","resize","closer","setVisible","clearSize","heightAdjustment","marginTop","createScrollContainer","calibrationMenu","scrollContainer","table","tbody","row","insertRow","requestedSizeTextbox","autofocus","split","updateLabel","ESCAPE","requestedSize","cursorIndex","selectionStart","isSimple","unitList","selectedIndex","simpleInput","isPositiveNumber","isSimpleDecimal","calculatePrecision","getMaxPrecision","preventDefault","cell","insertCell","caption","matches","unitNames","OptionDropDown","paddingLeft","paddingRight","setCalibration","requestedUnits","calibrate","match","isNaN","parseFloat","ViewerPanelMixin","uninitialize","findUnits","selectedUnits","getCurrentUnits","setPanelValue","size","setSelectedIndex","parsedNumber","UnitParser","parsePositiveNumber","updatePanelPosition","labelOffset","cornerX","cornerY","rubberbandDirection","sqrt","pow","canvas","CalibrationRequiredDialog","measureExt","dialogBox","calibrateNow","buttonsWrapper","cancel","calibrateNowButton","enableCalibrationTool","CalibrationTool","_measurement","_options","_maxPrecision","maxPrecision","_isCalibrated","_distance","_calibrationTaken","_selectedSize","_selectedUnits","_selectedP1","_selectedP2","_waitingForInput","_calibrationPanel","_hasUI","GuiViewer3D","addPanel","screenSizeChangedBinded","screenSizeChanged","removePanel","parsedRequestedSize","VIEWER_RESIZE_EVENT","hidePanel","clearAllPicks","setCalibrationFactor","getCalibrationFactor","isCalibrationValid","currentSize","defualtPrecision","requestedPrecision","getExtension","calibrateByScale","requestedScale","CLOSE_CALIBRATION_PANEL_EVENT","focus","onKeyUp","OPEN_CALIBRATION_PANEL_EVENT","isCalibrated","CLEAR_CALIBRATION_SIZE_EVENT","clearMeasurement","repickEndpoint","hasPreviousPick","MagnifyingGlass","_magnifyingGlassCanvas","_imageData","_imageBuffer","_clientX","_clientY","_needsClear","updateMagnifyingGlassBinded","updateMagnifyingGlass","pixelRatio","devicePixelRatio","normlizedDiameter","diameter","getContext","createImageData","ceil","Uint8Array","buffer","ctx","gl","readPixels","RGBA","UNSIGNED_BYTE","putImageData","drawImage","setGlassPosition","clearMagnifyingGlass","requestUpdate","hasEventListener","RENDER_PRESENTED_EVENT","once","drawMagnifyingGlass","handleWheelInput","MeasureToolbar","measureExtension","buttonsList","toolbar","getToolbar","navigationBar","getControl","TOOLBAR","NAVTOOLSID","toolbarOptions","measureToolbar","ControlGroup","MEASURETOOLSID","addControl","measureSimpleDistanceBtn","Button","setToolTip","setIcon","getState","State","ACTIVE","measureAngleBtn","measureAreaBtn","calibrationToolBtn","CALIBRATION","separator","deleteBtn","settingsBtn","settingsControlPanel","setButtonActive","setButtonInactive","root","initialIndex","getDisplayUnit","shift","toUnits","setupPrecision","logger","track","category","precisionList","OptionCheckbox","checked","updateSettingsPanel","setVisibility","disableUnitOption","measureDoneBtn","doneText","cancelLabel","btnContainer","iconEle","getElementsByClassName","exitMeasurementMode","closeToolbar","enableMeasureTool","toggleVisible","viewerToolbarContainer","viewerContainerChildrenCount","children","MODELTOOLSID","measurementToolbarButton","setState","INACTIVE","deactivateAllButtons","activateButtonByType","dropdownElement","lastChild","precisions","elem","disabled","visibility","AutodeskNamespace","DEFAULT_MEASUREMENT_TYPE","MeasureExtension","Extension","modes","onModelLoaded","populateSharedMeasureConfig","createUI","bindedOnToolbarCreated","onToolbarCreated","TOOLBAR_CREATED_EVENT","load","hasUI","escapeHotkeyId","measureToolOptions","snapperOptions","forceCalibrate","Snapper","renderSnappedTopology","registerTool","onFinishedCalibration","activateInitiator","MODEL_ROOT_LOADED_EVENT","unloaded","unload","destroyUI","deregisterTool","setActive","getUnitOptions","getPrecisionOptions","isFractional","getDefaultUnit","openCalibrationRequiredDialog","initiator","CALIBRATION_REQUIRED_EVENT","FINISHED_CALIBRATION_FOR_DIMENSION_EVENT","activeStatus","success","enterMeasurementMode","warn","selectedTool","checkAndFetchTopology","OPEN_TOOL_AFTER_CALIBRAION","UNITS_CALIBRATION_STARTS_EVENT","_measurementMode","navigationControls","measureControls","modelTools","measureButtonId","getId","removeControl","centerToolBar","hotkeys","keycodes","onRelease","getHotkeyManager","pushHotkeys","uiCreated","modelHasTopology","fetchTopology","then","topoData","catch","err","submenu","popHotkeys","theExtensionManager","registerExtension"],"mappings":"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","file":"Measure/Measure.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 16);\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \"{\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    for (var i = 0; i < this.length; i++) {\n      // eslint-disable-next-line prefer-destructuring\n      var id = this[i][0];\n\n      if (id != null) {\n        alreadyImportedModules[id] = true;\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = modules[_i]; // skip already imported module\n      // this implementation is not 100% perfect for weird media query combinations\n      // when a module is imported multiple times with different media queries.\n      // I hope this will never occur (Hey this way we have smaller bundles)\n\n      if (item[0] == null || !alreadyImportedModules[item[0]]) {\n        if (mediaQuery && !item[2]) {\n          item[2] = mediaQuery;\n        } else if (mediaQuery) {\n          item[2] = \"(\".concat(item[2], \") and (\").concat(mediaQuery, \")\");\n        }\n\n        list.push(item);\n      }\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot).concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","\"use strict\";\n\nvar stylesInDom = {};\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nfunction listToStyles(list, options) {\n  var styles = [];\n  var newStyles = {};\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var css = item[1];\n    var media = item[2];\n    var sourceMap = item[3];\n    var part = {\n      css: css,\n      media: media,\n      sourceMap: sourceMap\n    };\n\n    if (!newStyles[id]) {\n      styles.push(newStyles[id] = {\n        id: id,\n        parts: [part]\n      });\n    } else {\n      newStyles[id].parts.push(part);\n    }\n  }\n\n  return styles;\n}\n\nfunction addStylesToDom(styles, options) {\n  for (var i = 0; i < styles.length; i++) {\n    var item = styles[i];\n    var domStyle = stylesInDom[item.id];\n    var j = 0;\n\n    if (domStyle) {\n      domStyle.refs++;\n\n      for (; j < domStyle.parts.length; j++) {\n        domStyle.parts[j](item.parts[j]);\n      }\n\n      for (; j < item.parts.length; j++) {\n        domStyle.parts.push(addStyle(item.parts[j], options));\n      }\n    } else {\n      var parts = [];\n\n      for (; j < item.parts.length; j++) {\n        parts.push(addStyle(item.parts[j], options));\n      }\n\n      stylesInDom[item.id] = {\n        id: item.id,\n        refs: 1,\n        parts: parts\n      };\n    }\n  }\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n\n  if (typeof options.attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      options.attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(options.attributes).forEach(function (key) {\n    style.setAttribute(key, options.attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  }\n\n  if (sourceMap && btoa) {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {};\n  options.attributes = typeof options.attributes === 'object' ? options.attributes : {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  var styles = listToStyles(list, options);\n  addStylesToDom(styles, options);\n  return function update(newList) {\n    var mayRemove = [];\n\n    for (var i = 0; i < styles.length; i++) {\n      var item = styles[i];\n      var domStyle = stylesInDom[item.id];\n\n      if (domStyle) {\n        domStyle.refs--;\n        mayRemove.push(domStyle);\n      }\n    }\n\n    if (newList) {\n      var newStyles = listToStyles(newList, options);\n      addStylesToDom(newStyles, options);\n    }\n\n    for (var _i = 0; _i < mayRemove.length; _i++) {\n      var _domStyle = mayRemove[_i];\n\n      if (_domStyle.refs === 0) {\n        for (var j = 0; j < _domStyle.parts.length; j++) {\n          _domStyle.parts[j]();\n        }\n\n        delete stylesInDom[_domStyle.id];\n      }\n    }\n  };\n};","var content = require(\"!!../node_modules/css-loader/dist/cjs.js!./Measure.css\");\n\nif (typeof content === 'string') {\n  content = [[module.id, content, '']];\n}\n\nvar options = {}\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = require(\"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\")(content, options);\n\nif (content.locals) {\n  module.exports = content.locals;\n}\n","exports = module.exports = require(\"../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Imports\nvar getUrl = require(\"../node_modules/css-loader/dist/runtime/getUrl.js\");\nvar ___CSS_LOADER_URL___0___ = getUrl(require(\"./res/icon-spinner-sm.svg\"));\n// Module\nexports.push([module.id, \"/* hover shouldn't work on mobile devices */\\n.adsk-viewing-viewer .measure-length:hover.measure-length.enable-hover\\n{\\n\\tbox-shadow: 0 0 16px 3px rgba(0, 117, 210, 0.7);\\n\\t-webkit-box-shadow: 0 0 16px 3px rgba(0, 117, 210, 0.7);\\n    -moz-box-shadow: 0 0 16px 3px rgba(0, 117, 210, 0.7);\\n}\\n\\n.adsk-viewing-viewer .measure-length {\\n    display: none;\\n    position: absolute;\\n\\n    height: 19px;\\n\\n    left: 0px;\\n    top:  0px;\\n\\n    padding: 2px 0 2px 0;\\n\\n    background-color: #009bff;\\n    box-shadow: 0px 1px 3px 1px rgba(0,0,0,0.25);\\n\\n    color: #f4f4f4;\\n    font-size:12px;\\n    text-align: center;\\n    line-height: 1.2;\\n    white-space: nowrap;\\n\\n    border-radius: 8px;\\n    pointer-events: none;\\n    cursor: pointer;\\n    z-index: 2;\\n\\n    -webkit-tap-highlight-color: rgba(0,0,0,0);\\n}\\n\\n.adsk-viewing-viewer .measure-length.visible {\\n    display: block;\\n}\\n\\n.adsk-viewing-viewer .measure-length.fetching-topology {\\n    background-color: rgba(34, 34, 34, 0.8);\\n    box-shadow: 0 0.5px 1.5px 0 rgba(0, 0, 0, 0.3);\\n}\\n\\n.adsk-viewing-viewer .measure-length-text {\\n    display: inline-block;\\n    margin: 0 5px 0 5px;\\n    vertical-align: middle;\\n    font-size: 16px;\\n    pointer-events: none;\\n}\\n\\n.adsk-viewing-viewer .measure-delta-text {\\n    margin: 0 5px 0 5px;\\n    align-self: center;\\n    font-size: 14px;\\n\\toverflow: hidden;\\n\\twhite-space: nowrap;\\n\\theight: 16px;\\n\\tline-height: 16px;\\n\\tvertical-align: middle;\\n\\tpointer-events: none;\\n}\\n\\n.adsk-viewing-viewer .measure-length-button {\\n    display: inline-block;\\n    width: 16px;\\n    height: 16px;\\n    font-size: 16px;\\n    float: right;\\n\\n    color: #FFFFFF;\\n    opacity: 0.7;\\n}\\n\\n.adsk-viewing-viewer .measure-length-button:hover {\\n    background-color: rgba(166,194,255, 0.7);\\n    -webkit-transition: all 0.2s ease;\\n    -moz-transition: all 0.2s ease;\\n    -ms-transition: all 0.2s ease;\\n    -o-transition: all 0.2s ease;\\n    transition: all 0.2s ease;\\n}\\n\\n/* hover shouldn't work on mobile devices */\\n.adsk-viewing-viewer .measure-label:hover.measure-label.enable-hover,\\n.adsk-viewing-viewer .measure-label.on-edit {\\n\\tbox-shadow: 0 0 4px 4px #0d69ca;\\n\\t-webkit-box-shadow: 0 0 4px 4px #0d69ca;\\n    -moz-box-shadow: 0 0 4px 4px #0d69ca;\\n}\\n\\n.adsk-viewing-viewer .measure-label.editable {\\n\\tpointer-events: all;\\n}\\n\\n.adsk-viewing-viewer .measure-label {\\n    display: none;\\n    position: absolute;\\n    width: 7px;\\n    height: 7px;\\n    cursor: move;\\n    pointer-events: none; \\n    border-radius:100px;\\n}\\n\\n.adsk-viewing-viewer .measure-label-hit-area {\\n\\tdisplay: inline-block;\\n    position: absolute;\\n    width: 44px;\\n    height: 44px;\\n    left: -22px;\\n    top: -22px;\\n    border-radius:100px;\\n    z-index: 2;\\n}\\n\\n.adsk-viewing-viewer .measure-label-icon {\\n    display: inline-block;\\n    position: absolute;\\n    width: 7px;\\n    height: 7px;\\n    left: -2px;\\n    top: -2px;\\n    background-color: #009bff;\\n    border-style: solid;\\n    border-width: 2px;\\n    border-color: #FFFFFF;\\n    border-radius:100px;\\n\\tbox-shadow: 0 2px 5px 0 #182A3D;\\n\\tz-index: 2;\\n}\\n\\n.adsk-viewing-viewer .measure-label.visible {\\n    display: block;\\n}\\n\\n\\n.adsk-viewing-viewer .measure-label-text {\\n    display: inline-block;\\n    margin: 0px 5px 0px 5px;\\n    vertical-align: middle;\\n}\\n\\n.adsk-viewing-viewer .measure-horizontal-divider\\n{\\n    height: 1px;\\n    border-top: 1px solid rgba(200,200,200,0.8);\\n}\\n\\n.adsk-viewing-viewer .measure-submenu-select\\n{\\n    display: block;\\n    position: relative;\\n    width: calc(100% - 40px);\\n    padding: 10px 20px 0px 20px;\\n    opacity: 0.3;\\n}\\n\\n.adsk-viewing-viewer .option-drop-down:disabled {\\n    opacity: 0.3;\\n}\\n\\n.adsk-viewing-viewer .measure-submenu-selectlabel\\n{\\n    position: relative;\\n    display:  inline-block;\\n    padding-right:  20px;\\n    padding-bottom:  4px;\\n}\\n\\n/*.measure-result {*/\\n    /*display: inline-block;*/\\n    /*padding: 10px 0px  10px 20px;*/\\n/*}*/\\n\\n.adsk-viewing-viewer .measure-results {\\n    position: relative;\\n    display: block;\\n    padding: 5px 0px  10px 30px;\\n}\\n\\n.adsk-viewing-viewer .measure-result-label {\\n    display: inline-block;\\n    padding-right: 10px;\\n}\\n\\n.adsk-viewing-viewer .measure-result-number {\\n    display: inline-block;\\n}\\n\\n.adsk-viewing-viewer .measure-delta-collapse {\\n    position: absolute;\\n    right: 20px;\\n    display: inline-block;\\n    background-color: rgba(255,255,255, .12);\\n    margin: 0px 4px 0px 4px;\\n    padding: 0px 4px 0px 4px;\\n    cursor: pointer;\\n    text-align: center;\\n}\\n\\n.adsk-viewing-viewer .measure-delta-collapse:hover {\\n    background-color: rgba(166,194,255, 0.7);\\n    -webkit-transition: all 0.2s ease;\\n    -moz-transition: all 0.2s ease;\\n    -ms-transition: all 0.2s ease;\\n    -o-transition: all 0.2s ease;\\n    transition: all 0.2s ease;\\n}\\n\\n.adsk-viewing-viewer .measure-selection-repick {\\n    position: absolute;\\n    right: 20px;\\n    display: inline-block;\\n    background-color: rgba(255,255,255, .12);\\n    margin: 4px 4px 4px 4px;\\n    padding: 4px 4px 4px 4px;\\n    cursor: pointer;\\n    text-align: center;\\n}\\n\\n.adsk-viewing-viewer .measure-selection-repick:hover {\\n    background-color: rgba(166,194,255, 0.7);\\n    -webkit-transition: all 0.2s ease;\\n    -moz-transition: all 0.2s ease;\\n    -ms-transition: all 0.2s ease;\\n    -o-transition: all 0.2s ease;\\n    transition: all 0.2s ease;\\n}\\n\\n.adsk-viewing-viewer .measure-restart {\\n    margin: 10px 20px 15px 20px;\\n    padding: 6px 10px 6px 10px;\\n    width: calc(100% - 55px);\\n    cursor: pointer;\\n    text-align: center;\\n    border-style: solid;\\n    border-width: 1px;\\n    border-color: rgba(255, 255, 255, 0.2);\\n    border-radius: 3px;\\n}\\n\\n.adsk-viewing-viewer .docking-panel:hover .measure-restart {\\n    background-color: rgba(255,255,255, .12);\\n}\\n\\n.adsk-viewing-viewer .docking-panel .measure-restart:hover {\\n    background-color: rgba(166,194,255, 0.7);\\n    -webkit-transition: all 0.2s ease;\\n    -moz-transition: all 0.2s ease;\\n    -ms-transition: all 0.2s ease;\\n    -o-transition: all 0.2s ease;\\n    transition: all 0.2s ease;\\n}\\n\\n.adsk-viewing-viewer .measure-panel-title {\\n    padding-top:   0px;\\n    padding-left: 20px;\\n    margin-top: 10px;\\n}\\n\\n.adsk-viewing-viewer .measure-panel-title:hover {\\n    cursor: pointer;\\n}\\n\\n.adsk-viewing-viewer .measure-panel-title.collapsed  {\\n    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkEwMDhBMzY4QTYyODExRTM5REY0Q0MwMTM3MTVFOTMzIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkEwMDhBMzY5QTYyODExRTM5REY0Q0MwMTM3MTVFOTMzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QTAwOEEzNjZBNjI4MTFFMzlERjRDQzAxMzcxNUU5MzMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QTAwOEEzNjdBNjI4MTFFMzlERjRDQzAxMzcxNUU5MzMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6WHWu4AAAAcElEQVR42mL8//8/AzmAiYFMgEtjGSFDcUmGAfEEIOYix6lWQLwUiGXJ8SNI00IgNiIncPiAeCoQ+5ITqsxQA+CAhQhN34C4AoiPkaLxGRAXAfEdUvx4DohjsGkCA1CSw4LrgZgVhxwYM9I9rQIEGACZNDs01yUXlAAAAABJRU5ErkJggg==);\\n    background-repeat:no-repeat;\\n}\\n\\n.adsk-viewing-viewer .measure-panel-title.expanded  {\\n    background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkE3QzFFQUQ1QTYyODExRTM5NzE2RjcyN0QxQjg0QTREIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkE3QzFFQUQ2QTYyODExRTM5NzE2RjcyN0QxQjg0QTREIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QTdDMUVBRDNBNjI4MTFFMzk3MTZGNzI3RDFCODRBNEQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QTdDMUVBRDRBNjI4MTFFMzk3MTZGNzI3RDFCODRBNEQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6XuY60AAAARklEQVR42mL8//8/AzmAiYFMQBeNqSg8kB+JwKlAfAZZjIlIm9JJdSpWTYQ04tSETyNeTbg0EtSETSNRmkCAcegkOYAAAwDGjDZHvY373AAAAABJRU5ErkJggg==);\\n    background-repeat:no-repeat;\\n}\\n\\n.adsk-viewing-viewer .adsk-viewing-viewer .measure-table td {\\n    padding: 10px 0px  10px 20px;\\n}\\n\\n.adsk-viewing-viewer .measure-result-container {\\n\\n}\\n\\n.adsk-viewing-viewer .measure-selection-one-label {\\n    display: inline-block;\\n    margin: 18px 18px 18px 18px;\\n    width: 16px;\\n    height: 16px;\\n    font-size: 16px;\\n    float: left;\\n\\n    padding: 2px;\\n    background-color: #0033FF;\\n    border-radius:         10px;\\n    opacity: 0.6;\\n}\\n\\n.adsk-viewing-viewer .measure-selection-two-label {\\n    display: inline-block;\\n    margin: 18px 18px 18px 18px;\\n    width: 16px;\\n    height: 16px;\\n    font-size: 16px;\\n    float: left;\\n\\n    padding: 2px;\\n    background-color: #0033FF;\\n    border-radius:         10px;\\n    opacity: 0.6;\\n}\\n\\n.adsk-viewing-viewer .measure-repick {\\n    display: inline-block;\\n    cursor: default;\\n    margin: 20px 20px 20px 20px;\\n    width: 16px;\\n    height: 16px;\\n    font-size: 16px;\\n    float: right;\\n    opacity: 0.5;\\n}\\n\\n.adsk-viewing-viewer .measure-repick:hover {\\n    opacity: 1;\\n}\\n\\n.adsk-viewing-viewer .measure-selection-result {\\n    display: inline-block;\\n    margin: 21px 0px 21px 0px;\\n}\\n\\n.adsk-viewing-viewer .measure-distance-icon {\\n    display: inline-block;\\n    margin: 20px 2px 20px 2px;\\n    font-size: 52px;\\n    color: #FF9900;\\n    float: left;\\n}\\n\\n.adsk-viewing-viewer .measure-angle-icon {\\n    display: inline-block;\\n    margin: 20px 2px 20px 2px;\\n    font-size: 52px;\\n    color: #FF9900;\\n    float: left;\\n}\\n\\n.adsk-viewing-viewer .adsk-viewing-viewer .measure-result {\\n    font-size: 20px;\\n    color: #FF9900;\\n    display: inline-block;\\n    margin: 38px 0px 38px 0px;\\n}\\n\\n.adsk-viewing-viewer .measure-initial {\\n    font-size: 20px;\\n    display: inline-block;\\n    margin: 38px 0px 38px 56px;\\n}\\n\\n.adsk-viewing-viewer .measure-settings-button {\\n    cursor: default;\\n    position: relative;\\n    top: 20px;\\n    right: 20px;\\n    width: 16px;\\n    height: 16px;\\n    font-size: 18px;\\n    float: right;\\n    opacity: 0.5;\\n}\\n\\n.adsk-viewing-viewer .measure-settings-button:hover {\\n    opacity: 1;\\n}\\n\\n.adsk-viewing-viewer .measure-delta-button {\\n    position: relative;\\n    top: 56px;\\n    right: 4px;\\n    width: 16px;\\n    height: 16px;\\n    font-size: 16px;\\n    float: right;\\n    opacity: 0.5;\\n    -webkit-transform : rotate(-90deg);\\n    -moz-transform : rotate(-90deg);\\n    -ms-transform : rotate(-90deg);\\n    -o-transform : rotate(-90deg);\\n    transform : rotate(-90deg);\\n}\\n\\n.adsk-viewing-viewer .measure-delta-button.rotated {\\n    -webkit-transform : rotate(90deg);\\n    -moz-transform : rotate(90deg);\\n    -ms-transform : rotate(90deg);\\n    -o-transform : rotate(90deg);\\n    transform : rotate(90deg);\\n}\\n\\n.adsk-viewing-viewer .measure-delta-button:hover {\\n    opacity: 1;\\n}\\n\\n.adsk-viewing-viewer .measure-delta-result {\\n    display: inline-block;\\n    margin: 0px 0px 20px 0px;\\n    padding: 0px 0px 0px 56px;\\n}\\n\\n.adsk-viewing-viewer .measure-label-axis {\\n    display: none;\\n    position: absolute;\\n\\n    width: 16px;\\n    height: 16px;\\n\\n    left: 0px;\\n    top:  0px;\\n\\n    background-color: #f4f4f4;\\n    border-radius: 8px;\\n    pointer-events: none;\\n}\\n\\n.adsk-viewing-viewer .measure-label-axis-icon.X {\\n    background-color: #EC4545;\\n}\\n\\n.adsk-viewing-viewer .measure-label-axis-icon.Y {\\n    background-color: #45C345;\\n}\\n\\n.adsk-viewing-viewer .measure-label-axis-icon.Z {\\n    background-color: #5757DA;\\n}\\n\\n.adsk-viewing-viewer .measure-label-axis-icon {\\n\\twidth: 20px;\\n    height: 18px;\\n    color: #f4f4f4;\\n    border-radius: 8px 0 0 8px;\\n    font-size: 12px;\\n    padding-top: 4px;\\n    line-height: 15px;\\n    text-align: center;\\n}\\n\\n/* hover shouldn't work on mobile devices */\\n.adsk-viewing-viewer .measure-label-axis-delta.enableTransition{\\n\\ttransition: opacity 0.1s linear;\\n}\\n\\n.adsk-viewing-viewer .measure-label-axis-delta {\\n    display: none;\\n    position: absolute;\\n    font-size: 18px;\\n\\n    left: 0px;\\n    top:  0px;\\n\\n    background-color: #ffffff;\\n    pointer-events: none;\\n    \\n    opacity: 0;\\n\\n    border-radius: 8px;\\n    box-shadow: 0px 1px 3px 1px rgba(0,0,0,0.25);\\n}\\n\\n.adsk-viewing-viewer .measure-label-axis.visible {\\n    display: block;\\n}\\n\\n.adsk-viewing-viewer .measure-label-axis-delta.visible {\\n    display: flex;\\n}\\n\\n.adsk-viewing-viewer .measure-label-axis-x {\\n    color: #EC4545;\\n}\\n\\n.adsk-viewing-viewer .measure-label-axis-y {\\n    color: #45C345;\\n}\\n\\n.adsk-viewing-viewer .measure-label-axis-z {\\n    color: #5757DA;\\n}\\n\\n\\n.adsk-viewing-viewer .magnifying-glass.visible {\\n    display: block;\\n}\\n\\n.adsk-viewing-viewer .magnifying-glass {\\n    position: absolute;\\n    display: none;\\n    -moz-border-radius: 100%;\\n    -webkit-border-radius: 100%;\\n    border-radius: 100%;\\n    background: transparent;\\n    box-shadow: 2px 2px 4px rgba(0,0,0,0.5), inset 2px 2px 4px rgba(0,0,0,.5);\\n    -webkit-box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5), inset 2px 2px 4px rgba(0,0,0,.5);  \\n    -moz-box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5), inset 2px 2px 4px rgba(0,0,0,.5);\\n    z-index: 4;\\n}\\n\\n.adsk-viewing-viewer .measure-fetching-topology {\\n    display: inline-block;\\n    width: 10px;\\n    height: 10px;\\n    background: url(\" + ___CSS_LOADER_URL___0___ + \");\\n    margin: 3px 0px -2px 3px;\\n    animation: measure-topology-fetching-anim 1.4s infinite linear;\\n    -webkit-animation: measure-topology-fetching-anim 1.4s infinite linear;\\n}\\n\\n@keyframes measure-topology-fetching-anim {\\n    0% {\\n        -webkit-transform: rotate(0deg);\\n        transform: rotate(0deg);\\n    }\\n    100% {\\n        -webkit-transform: rotate(360deg);\\n        transform: rotate(360deg);\\n    }\\n}\\n\\n@-webkit-keyframes measure-topology-fetching-anim {\\n    0% {\\n        -webkit-transform: rotate(0deg);\\n        transform: rotate(0deg);\\n    }\\n    100% {\\n        -webkit-transform: rotate(360deg);\\n        transform: rotate(360deg);\\n    }\\n}\\n\\n.adsk-viewing-viewer .docking-panel.measure-settings-popup {\\n    display: flex;\\n    justify-content: center;\\n    flex-direction: column;\\n    bottom: 120%;\\n    box-sizing: border-box;\\n    text-align: left;\\n    position: absolute;\\n    padding-top: 15px;\\n    padding-bottom: 15px;\\n}\\n\\n.adsk-viewing-viewer .docking-panel.measure-settings-popup .adsk-lmv-tftable tr.switch-slider-row td {\\n    width: auto;\\n    padding-bottom: 0px;\\n    padding-top: 0px;\\n    vertical-align: inherit;\\n}\\n\\n.adsk-viewing-viewer .docking-panel.measure-settings-popup.hide {\\n    display: none;\\n}\\n\\n.adsk-viewing-viewer .measure-settings-popup tbody {\\n    top: 15px;\\n}\\n\\n.measure-toolbar-seperator {\\n    height: 18px;\\n    width: 1px;\\n    background-color: #999;\\n    float: left;\\n    margin: 16px 5px;\\n}\\n\\n.adsk-viewing-viewer .measure-selection-area {\\n\\tdisplay: block;\\n\\tposition: absolute;\\n\\tcursor: pointer;\\n\\tz-index: 1;\\n\\t-webkit-tap-highlight-color: rgba(0,0,0,0);\\n}\", \"\"]);\n","\"use strict\";\n\nmodule.exports = function (url, needQuotes) {\n  // eslint-disable-next-line no-underscore-dangle, no-param-reassign\n  url = url.__esModule ? url.default : url;\n\n  if (typeof url !== 'string') {\n    return url;\n  } // If url is already wrapped in quotes, remove them\n\n\n  if (/^['\"].*['\"]$/.test(url)) {\n    // eslint-disable-next-line no-param-reassign\n    url = url.slice(1, -1);\n  } // Should url be wrapped?\n  // See https://drafts.csswg.org/css-values-3/#urls\n\n\n  if (/[\"'() \\t\\n]/.test(url) || needQuotes) {\n    return \"\\\"\".concat(url.replace(/\"/g, '\\\\\"').replace(/\\n/g, '\\\\n'), \"\\\"\");\n  }\n\n  return url;\n};","module.exports = \"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='10' height='10' viewBox='0 0 10 10'%3E %3Cdefs%3E %3ClinearGradient id='linear-gradient' y1='5' x2='10' y2='5' gradientUnits='userSpaceOnUse'%3E %3Cstop offset='0' stop-color='%23fff' stop-opacity='0'/%3E %3Cstop offset='1' stop-color='%23fff'/%3E %3C/linearGradient%3E %3C/defs%3E %3Ctitle%3EAsset 6%3C/title%3E %3Cg id='Layer_2' data-name='Layer 2'%3E %3Cg id='finals_24px'%3E %3Cpath d='M5,10A5,5,0,0,1,0,5,1.2,1.2,0,0,1,2.3,5,2.7,2.7,0,1,0,5,2.3,1.2,1.2,0,0,1,5,0,5,5,0,0,1,5,10Z' fill='url(%23linear-gradient)'/%3E %3C/g%3E %3C/g%3E %3C/svg%3E\"","var content = require(\"!!../node_modules/css-loader/dist/cjs.js!./Calibration.css\");\n\nif (typeof content === 'string') {\n  content = [[module.id, content, '']];\n}\n\nvar options = {}\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = require(\"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\")(content, options);\n\nif (content.locals) {\n  module.exports = content.locals;\n}\n","exports = module.exports = require(\"../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"@font-face {\\n    font-family: 'calibration-icon';\\n    src: url('data:application/octet-stream;base64,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') format('woff');\\n    font-weight: normal;\\n    font-style: normal;\\n}\\n\\n[class^=\\\"calibration-icon\\\"], [class*=\\\" calibration-icon\\\"] {\\n    font-family: 'calibration-icon';\\n    font-style: normal;\\n    font-weight: normal;\\n    font-variant: normal;\\n    line-height: 1;\\n    padding-top: 2px;\\n    speak: none;\\n    text-transform: none;\\n    -webkit-font-smoothing: antialiased;\\n    -moz-osx-font-smoothing: grayscale;\\n}\\n\\n.adsk-viewing-viewer .calibration-icon:before {\\n    content: 'a';\\n}\\n\\n.adsk-viewing-viewer .calibration-panel {\\n    left:calc(50% - 190px);\\n    top: calc(50% - 145px);\\n    width: 300px;\\n    height: auto;\\n    z-index: 4;\\n}\\n\\n.adsk-viewing-viewer .measure-settings-popup .option-drop-down,\\n.adsk-viewing-viewer .calibration-panel .option-drop-down {\\n    width: 100%;\\n    padding-right: 0px;\\n    box-sizing: border-box;\\n}\\n\\n.adsk-viewing-viewer .measure-settings-popup .adsk-lmv-tftable tr td,\\n.adsk-viewing-viewer .calibration-panel .adsk-lmv-tftable tr td {\\n    width: auto;\\n    padding: 2px 15px 2px 0px;\\n}\\n\\n.adsk-viewing-viewer .calibration-panel .adsk-lmv-tftable tr td input {\\n    margin: 0px;\\n    box-sizing: border-box;\\n    width: 100%;\\n}\\n\\n.adsk-viewing-viewer .measure-settings-popup .switch {\\n    margin-left: 25px;\\n}\\n.adsk-viewing-viewer .measure-settings-popup .switch .slider {\\n    width: 26px;\\n}\\n\\n.adsk-viewing-viewer .calibration-textbox::-webkit-inner-spin-button, \\n.adsk-viewing-viewer .calibration-textbox::-webkit-outer-spin-button { \\n    -webkit-appearance: none; \\n    margin: 0; \\n}\\n\\n.adsk-viewing-viewer .calibration-text {\\n    text-align: left;\\n    padding: 6px 10px 6px 10px;\\n    margin: 20px 20px 14px 20px;\\n    font-size: 14px;\\n    -webkit-font-smoothing: antialiased;\\n}\\n\\n.adsk-viewing-viewer .calibration-button {\\n    margin-top: 15px;\\n}\\n\\n.adsk-viewing-viewer .calibration-button-left {\\n    width: calc(50% - 15px);\\n    margin-right: 5px !important;\\n    display: inline-block;\\n}\\n\\n.adsk-viewing-viewer .calibration-button-right {\\n    width: calc(50% - 15px);\\n    margin-left: 5px !important;\\n    display: inline-block;\\n}\\n\\n.adsk-viewing-viewer .calibration-line {\\n    position: absolute;\\n    display: block;    \\n    top:0;\\n    left:0;\\n    pointer-events: none;\\n    z-index: 0;\\n}\\n\\n.adsk-viewing-viewer .calibration-label {\\n    display: none;\\n    position: absolute;\\n    pointer-events: none;\\n    text-align: 'center';\\n    vertical-align: middle;\\n    cursor: default;\\n    padding: 2px;\\n    color: #000000;\\n    background: #FFFFFF;\\n    border-radius: 10px;\\n    -webkit-transform-origin: 50%  53%;\\n}\\n\\n.adsk-viewing-viewer .calibration-label-text {\\n    display: inline-block;\\n    pointer-events: none;\\n    text-align: 'center';\\n    vertical-align: middle;\\n    font-size: 12px;\\n    cursor: default;\\n    padding: 2px;\\n    color: #000000;\\n    background: #FFFFFF;\\n    border-bottom: 1px dashed #000000;\\n    text-decoration: none;\\n    text-transform: uppercase;\\n    -webkit-font-smoothing: antialiased;\\n}\\n\\n.adsk-viewing-viewer .calibration-label-text:hover {\\n    color: #039be5;\\n    border-bottom: 1px dashed #039be5;\\n}\\n\\n.adsk-viewing-viewer .calibration-label.visible {\\n    display: block;\\n}\\n\\n.adsk-viewing-viewer .calibration-endpoint:hover.calibration-endpoint.enable-hover,\\n.adsk-viewing-viewer .calibration-endpoint.edit {\\n    background-color: #039be5;\\n}\\n\\n.adsk-viewing-viewer .calibration-endpoint:hover.calibration-endpoint.enable-hover > * ,\\n.adsk-viewing-viewer .calibration-endpoint.edit > * {\\n    color: #ffffff;\\n}\\n\\n.adsk-viewing-viewer .calibration-endpoint.editable {\\n    pointer-events: all;\\n}\\n\\n.adsk-viewing-viewer .calibration-endpoint {\\n    display: none;\\n    position: absolute;\\n    cursor: move;\\n    pointer-events: none;\\n    width: 30px;\\n    height: 30px;\\n    background-color: #ffffff;\\n    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.24), 0 0 8px 0 rgba(0, 0, 0, 0.12);\\n    -moz-border-radius: 50px;\\n    -webkit-border-radius: 50px;\\n    border-radius: 50px;\\n    justify-content:center;\\n    align-items:center;\\n    text-align: center;\\n}\\n\\n.adsk-viewing-viewer .calibration-endpoint.visible {\\n    display: block;\\n}\\n\\n.adsk-viewing-viewer .calibration-endpoint-text {\\n    display: inline-block;\\n    font-size: 14px;\\n    vertical-align: middle;\\n    cursor: default;\\n    margin: 5px 5px 5px 5px;\\n    vertical-align: middle;\\n    text-align: center;\\n    color: #039be5;\\n    text-decoration: none;\\n    text-transform: uppercase;\\n    pointer-events: none;\\n}\\n\\n.adsk-viewing-viewer .calibration-buttons-wrapper {\\n    text-align: center;\\n}\\n\", \"\"]);\n","\n    var MeasureCommon = Autodesk.Viewing.MeasureCommon; //These come from main lmv bundle.\n\n    // /** @constructor */\n    export function MeasurementsManager(viewer)\n    {   \n        this.viewer = viewer;\n        this.init();\n    }\n\n    var proto = MeasurementsManager.prototype;\n\n    proto.getCurrentMeasurement = function() {\n        return this.currentMeasurement;\n    };\n\n    proto.selectMeasurementById = function(id) {\n        var measurement = this.measurementsList[id];\n        \n        if (measurement) {\n            this.changeCurrentMeasurement(measurement);\n            return this.currentMeasurement;    \n        }\n\n        return false;\n    };\n\n    proto.createMeasurement = function(measurementType) {\n        var id = this.measurementsCounter;\n        var measurement = new MeasureCommon.Measurement(measurementType, id);\n        this.measurementsList[id] = measurement;\n        this.measurementsCounter++;\n        this.changeCurrentMeasurement(measurement);\n        return this.currentMeasurement;\n    };\n\n    proto.changeCurrentMeasurement = function(measurement) {\n        this.currentMeasurement = measurement;\n        this.viewer.dispatchEvent({ type: MeasureCommon.Events.MEASUREMENT_CHANGED_EVENT, data: { type: measurement.measurementType, id: measurement.id }});\n    };\n\n    proto.removeCurrentMeasurement = function() { \n        // Remove current measurement from the list\n        if (Object.keys(this.measurementsList).length > 0) {\n            delete this.measurementsList[this.currentMeasurement.id];\n        }\n    };\n\n    proto.init = function() {\n        this.reset();\n    };\n\n    proto.destroy = function() {\n        this.reset();\n    };\n\n    proto.reset = function() {\n        this.currentMeasurement = null;\n        this.measurementsList = {};\n        this.measurementsCounter = 0;\n    };\n\n","\n    var av = Autodesk.Viewing;\n    var MeasureCommon = av.MeasureCommon;\n    \n    /**\n     * Base class for an indicator.\n     */\n\n    export var Indicator = function(viewer, measurement, tool)\n    {\n        this.viewer = viewer;\n        this.measurement = measurement;\n        this.tool = tool;\n        this.snapper = tool.getSnapper();\n        this.materialExtensionLine = null;\n        this.materialExtensionFace = null;\n        this.extensionLines = [];\n        this.extensionFaces = [];\n        this.grayOutPlane = [];\n        this.materialPoint = null;\n        this.materialLine = null;\n        this.materialAngle = null;\n        this.materialAngleOutline = null;\n        this.materialGreyOutPlane = null;\n        this.materialFace = null;\n        this.angleArc = null;\n        this.angleOutline = [];\n        this.showMeasureResult = false;\n        this.visibleLabels = [];\n        this.overlayName = 'measure-indicator-overlay-' + (measurement.id || '');\n        this.xAxis = this.viewer.autocam.getWorldRightVector();\n        this.yAxis = this.viewer.autocam.getWorldUpVector();\n        this.zAxis = this.viewer.autocam.getWorldFrontVector();\n    };\n\n\n\n    var proto = Indicator.prototype;\n\n    proto.init = function() {\n        return false;\n    };\n\n    proto.updateDistance = function() {\n        return false;\n    };\n\n    proto.updateAngle = function() {\n        return false;\n    };\n\n    proto.clear = function() {\n        return false;\n    };\n\n    proto.updateLabelsPosition = function() {\n        return false;\n    };\n\n    // Renders the measurement and the labels.\n    proto.render = function(picks, showMeasureResult) {\n\n        this.showMeasureResult = showMeasureResult;\n\n        this.clear();\n\n        for (var i = 1; i <= Object.keys(picks).length; i++) {\n            if (this.measurement.hasPick(i)) {\n                this.renderPick(i);\n            }\n        }\n            \n        this.renderRubberband(picks);\n        \n        this.updateLabelsPosition();\n    };\n\n    proto.changeEndpointOnEditStyle = function(endpointNumber, isEditing) {\n        return false;\n    };\n\n    proto.handleResize = function() {\n        return false;\n    };\n\n    proto.setNoTopology = function() {\n        return false;\n    };\n\n    proto.setFetchingTopology = function() {\n        return false;\n    };\n\n    proto.setTopologyAvailable = function() {\n        return false;\n    };\n\n    proto.clientToCanvasCoords = function(event) {\n        var rect = this.viewer.impl.getCanvasBoundingClientRect();\n        var res = {};\n        if( event.hasOwnProperty(\"center\") )\n        {\n            event.canvasX = res.x = event.center.x - rect.left;\n            event.canvasY = res.y = event.center.y - rect.top;\n        }\n        else\n        {\n            event.canvasX = res.x = event.pointers[0].clientX - rect.left;\n            event.canvasY = res.y = event.pointers[0].clientY - rect.top;\n        }\n\n        return res;\n    };\n\n    proto.initLabelMobileGestures = function(label, pointNumber) {\n        var magnifyingGlass = this.viewer.toolController.getTool(\"magnifyingGlass\");\n\n        this.hammer = new av.Hammer.Manager(label, {\n                recognizers: [\n                    av.GestureRecognizers.drag,\n                    av.GestureRecognizers.singletap\n                ],\n                handlePointerEventMouse: false,\n                inputClass: av.isIE11 ? av.Hammer.PointerEventInput : av.Hammer.TouchInput\n            });\n\n        this.onSingleTapBinded = function(event) { \n                                    var pos = this.clientToCanvasCoords(event);\n                                    this.snapper.onMouseDown(pos);\n                                    this.tool.editEndpoint(event, pointNumber, this.measurement.id); \n                                }.bind(this);\n\n        this.onDragStartBinded = function(event) {\n                                    var pos = this.clientToCanvasCoords(event);\n                                    this.snapper.onMouseDown(pos);\n                                    this.tool.editEndpoint(event, pointNumber, this.measurement.id);\n                                    this.tool.editByDrag = true;\n\n                                    // Activate Magnifying Glass and tool by faking press event.\n                                    event.type = \"press\";\n                                    magnifyingGlass.handlePressHold(event);\n                                    this.tool.handlePressHold(event);\n                                    event.type = \"dragstart\";\n                                    magnifyingGlass.handleGesture(event);\n                                    this.tool.handleGesture(event);\n                                }.bind(this);\n\n        this.onDragMoveBinded = function(event){ \n                                    var pos = this.clientToCanvasCoords(event);\n                                    this.snapper.onMouseDown(pos);\n\n                                    magnifyingGlass.handleGesture(event);\n                                    this.tool.handleGesture(event);\n                                }.bind(this);\n\n        this.onDragEndBinded = function(event){ \n                                    var pos = this.clientToCanvasCoords(event);\n                                    this.snapper.onMouseDown(pos);\n                                    \n                                    // Deactivate Magnifying Glass and tool by faking pressup event.\n                                    magnifyingGlass.handleGesture(event);\n                                    this.tool.handleGesture(event);\n                                    event.type = \"pressup\";\n                                    magnifyingGlass.handlePressHold(event);\n                                    this.tool.handlePressHold(event);\n\n                                    this.tool.handleButtonUp(event);\n                                }.bind(this);\n\n        this.hammer.on(\"singletap\", this.onSingleTapBinded);\n        this.hammer.on(\"dragstart\", this.onDragStartBinded);\n        this.hammer.on(\"dragmove\", this.onDragMoveBinded);\n        this.hammer.on(\"dragend\", this.onDragEndBinded);\n    };\n\n    proto.clearLabelMobileGestures = function() {\n        if (this.hammer) {\n            this.hammer.off(\"singletap\", this.onSingleTapBinded);\n            this.hammer.off(\"dragstart\", this.onDragStartBinded);\n            this.hammer.off(\"dragmove\", this.onDragMoveBinded);\n            this.hammer.off(\"dragend\", this.onDragEndBinded);\n            this.hammer = null;\n        }\n    };\n\n    proto.updateVisibleLabelsArray = function(label, isVisible) {\n        if (isVisible) {\n            if (!(this.visibleLabels.indexOf(label) > -1)) {\n                this.visibleLabels.push(label);        \n            }\n        } else {\n            // remove from array\n            var index = this.visibleLabels.indexOf(label);\n            if (index > -1) {\n                this.visibleLabels.splice(index, 1);\n            }\n        }\n    };\n\n    proto.hideEndpoints = function() {\n        for (var name in this.endpoints) {\n            if (this.endpoints.hasOwnProperty(name)) {\n                var endpoint = this.endpoints[name];\n                if (endpoint.label) {\n                    this.hideLabel(endpoint.label);\n                }\n            }\n        }\n    };\n\n    proto.showEndpoints = function() {\n        for (var name in this.endpoints) {\n            if (this.endpoints.hasOwnProperty(name)) {\n                var endpoint = this.endpoints[name];\n                if (this.measurement.hasPick(name) && endpoint.label) {\n                    this.showLabel(endpoint.label);\n                }\n            }\n        }\n    };\n\n    proto.hideLabel = function(label) {\n        if (label) {\n            MeasureCommon.safeToggle(label, 'visible', false);\n            this.updateVisibleLabelsArray(label, false);      \n        }\n    };\n\n    proto.showLabel = function(label) {\n        if (label) {\n            MeasureCommon.safeToggle(label, 'visible', true);\n            this.updateVisibleLabelsArray(label, true);\n        }\n    };\n\n    proto.changeEndpointOnEditStyle = function(endpointNumber, isEditing) {\n        if (this.endpoints[endpointNumber] && this.endpoints[endpointNumber].label) {\n            MeasureCommon.safeToggle(this.endpoints[endpointNumber].label, 'on-edit', isEditing);\n        }\n    };\n\n    proto.changeEndpointEditableStyle = function(endpointNumber, isEditable) {\n        if (this.endpoints[endpointNumber] && this.endpoints[endpointNumber].label) {\n            MeasureCommon.safeToggle(this.endpoints[endpointNumber].label, 'editable', isEditable);\n        }\n    };\n\n    proto.changeAllEndpointsEditableStyle = function(isEditable) {\n        for (var name in this.endpoints) {\n            if (this.endpoints.hasOwnProperty(name)) {\n                this.changeEndpointEditableStyle(name, isEditable);    \n            }\n        }\n    };\n\n    proto.changeAllEndpointsOnEditStyle = function(isEditing) {\n        for (var name in this.endpoints) {\n            if (this.endpoints.hasOwnProperty(name)) {\n                this.changeEndpointOnEditStyle(name, isEditing);\n            }\n        }\n    };\n\n    proto.hideLabelsOutsideOfView = function() {\n        // For each label, check if it's inside the camera viewport.\n        if (this.viewer.model && !this.viewer.model.is2d()) {\n            this.visibleLabels.forEach(function(label) {\n                var show = this.viewer.navigation.isPointVisible(label.point);\n\n                if ((label.classList.contains('visible') && !show) || (!label.classList.contains('visible') && show)) {\n                    label.classList.toggle('visible', show);    \n                } \n\n            }.bind(this));\n        }\n    };\n\n    proto.showClick = function(pickNumber) {\n        if (this.tool.getActivePointIndex() !== pickNumber) {\n            this.showLabel(this.endpoints[pickNumber].label);\n        }\n    };\n\n    proto.hideClick = function(pickNumber) {\n\n        if (this.endpoints[pickNumber]) {\n            this.hideLabel(this.endpoints[pickNumber].label);    \n        }\n    };\n\n    proto.renderPick = function(pickNumber) {\n        if (!this.endpoints[pickNumber]) {\n            this.createEndpoint(pickNumber);\n        }\n\n        this.renderEndpointGeometry(pickNumber);\n        this.showClick(pickNumber);\n    };\n\n    proto.renderEndpointGeometry = function(pickNumber) {\n        var geometry = MeasureCommon.getSnapResultPosition(this.measurement.getPick(pickNumber), this.viewer);\n        this.endpoints[pickNumber].position = geometry.clone();\n    };\n\n\n    // This is a workaround to deal with the limitation on linewidth on Windows due to the ANGLE library\n    proto.drawEdgeAsCylinder = function(geom, material, linewidth, type, cylinderGeometry) {\n\n        // The array for all cylinders\n        var edge = [];\n        var cylinder;\n\n        if (type == 1) { // LinePieces\n            for (var i = 0; i < geom.vertices.length; i += 2) {\n                cylinder = this.cylinderMesh(geom.vertices[i], geom.vertices[i + 1], material, linewidth, cylinderGeometry);\n                this.setCylinderScale(cylinder, geom.vertices[i], geom.vertices[i + 1]);\n                edge.push(cylinder);\n            }\n        }\n        else { // LineStrip\n            for (var i = 0; i < geom.vertices.length - 1; i++) {\n                cylinder = this.cylinderMesh(geom.vertices[i], geom.vertices[i + 1], material, linewidth, cylinderGeometry);\n                this.setCylinderScale(cylinder, geom.vertices[i], geom.vertices[i + 1]);\n                edge.push(cylinder);\n            }\n        }\n\n\n        return edge;\n    };\n\n    proto.drawDashedLine = function(p1, p2, dashSize, gapSize, material, width, overlayName) {\n\n        var geometry = new THREE.Geometry();\n        var line = new THREE.Vector3().subVectors(p2, p1);\n        var lineLength = line.length() - gapSize;\n        var lineDirection = line.normalize();\n        \n        var i = 0;\n        var pos = p1.clone();\n        var currLength = 0;\n\n        while (currLength < lineLength) {\n            var isPointVisible = this.viewer.navigation.isPointVisible(pos);\n            \n            if (isPointVisible) {\n                geometry.vertices[i] = pos.clone();\n                i++;\n            }\n            \n            pos.addVectors(pos, lineDirection.clone().multiplyScalar(dashSize));\n            \n            if (isPointVisible) {\n                geometry.vertices[i] = pos.clone();\n                i++;\n            }\n            \n            pos.addVectors(pos, lineDirection.clone().multiplyScalar(gapSize));\n\n            currLength += dashSize + gapSize;\n        }\n        \n        line = this.drawEdgeAsCylinder(geometry, material, width, 1, this.getNewCylinderGeometry());\n        this.viewer.impl.addMultipleOverlays(overlayName, line);\n\n        return line;\n    };\n\n    // This is a workaround to deal with the limitation on linewidth on Windows due to the ANGLE library\n    proto.drawLineAsCylinder = function(geom, material, linewidth, overlayName) {\n\n        var line;\n\n        if (geom.vertices.length == 2) {\n            line = this.cylinderMesh(geom.vertices[0], geom.vertices[1], material, linewidth, this.getNewCylinderGeometry());\n            this.setCylinderScale(line, geom.vertices[0], geom.vertices[1]);\n            this.viewer.impl.addOverlay(overlayName, line);\n        }\n\n        return line;\n    };\n\n    proto.getNewCylinderGeometry = function() {\n        return new THREE.CylinderGeometry(0.1, 0.1, 1, 8, 1, true);\n    };\n\n\n    proto.cylinderMesh = function(pointX, pointY, material, linewidth, cylinderGeometry) {\n\n        var direction = new THREE.Vector3().subVectors(pointY, pointX);\n        var orientation = new THREE.Matrix4();\n        orientation.lookAt(pointX, pointY, new THREE.Object3D().up);\n        orientation.multiply(new THREE.Matrix4().set(linewidth, 0, 0, 0,\n            0, 0, linewidth, 0,\n            0, -direction.length(), 0, 0,\n            0, 0, 0, 1));\n\n        var edge = new THREE.Mesh(cylinderGeometry, material);\n        edge.applyMatrix(orientation);\n        edge.lmv_line_width = linewidth;\n        edge.position.x = (pointY.x + pointX.x) / 2;\n        edge.position.y = (pointY.y + pointX.y) / 2;\n        edge.position.z = (pointY.z + pointX.z) / 2;\n\n        return edge;\n    };\n\n    // Set scale for cylinder\n    proto.setCylinderScale = function(cylinderMesh, p1, p2) {\n        var scale;\n\n        if (p1 && p2) {\n            var point = MeasureCommon.nearestPointInPointToSegment(this.viewer.navigation.getPosition(), p1, p2);\n            scale = this.setScale(point);    \n        } else {\n            scale = this.setScale(cylinderMesh.position);\n        }\n\n        if (cylinderMesh.hasOwnProperty(\"lmv_line_width\"))\n            scale *= cylinderMesh.lmv_line_width;\n        cylinderMesh.scale.x = scale;\n        cylinderMesh.scale.z = scale;\n    };\n\n\n    // Set scale for vertex and extension dashed line\n    proto.setScale = function(point) {\n\n        var pixelSize = 5;\n\n        var navapi = this.viewer.navigation;\n        var camera = navapi.getCamera();\n        var position = navapi.getPosition();\n\n        var p = point.clone();\n\n        var distance = camera.isPerspective ? p.sub(position).length()\n            : navapi.getEyeVector().length();\n\n        var fov = navapi.getVerticalFov();\n        var worldHeight = 2.0 * distance * Math.tan(THREE.Math.degToRad(fov * 0.5));\n\n        var viewport = navapi.getScreenViewport();\n        var scale = pixelSize * worldHeight / viewport.height;\n\n        return scale;\n    };\n\n    proto.alignLabelWithLine = function(label, p1, p2, offset, viewer){\n        var camUpVector = viewer.navigation.getCameraUpVector();\n        var worldUpVec = new THREE.Vector3(0,1,0);\n        var cameraAngle = worldUpVec.angleTo(camUpVector) * 180 / Math.PI;\n\n        cameraAngle = camUpVector.x >= 0 ? cameraAngle : -cameraAngle;\n        \n        var angle = null;\n\n        var deltaX = p1.x - p2.x;\n        var deltaY = p1.y - p2.y;\n\n        if (p1.x < p2.x) {\n            angle =  Math.atan2(-deltaY , -deltaX) * 180 / Math.PI;    \n        } \n        else {\n            angle =  Math.atan2(deltaY , deltaX) * 180 / Math.PI;    \n        }\n\n        angle = -(angle + cameraAngle);\n\n        if (Math.abs(angle) > 90){\n            angle = angle + 180;\n        }\n\n        label.style.transform = 'rotate('+ angle +'deg) translate(0px, ' + offset + 'px)';\n    };\n\n    proto.destroy = function() {\n        this.materialPoint = null;\n        this.materialFace = null;\n        this.materialLine = null;\n        this.materialAngle = null;\n\n        if (av.isTouchDevice()) {\n            this.clearLabelMobileGestures();    \n        }\n\n        for (var name in this.endpoints) {\n            if (this.endpoints.hasOwnProperty(name)) {\n                var endPoint = this.endpoints[name];\n\n                if (endPoint.label) {\n                    endPoint.label.removeEventListener(av.isSafari() ? 'mousedown' : 'pointerdown', this.onMouseClickBinded);\n                    endPoint.label.removeEventListener('mousewheel', this.viewer.toolController.mousewheel);\n                    endPoint.label.parentNode.removeChild(endPoint.label);\n                    endPoint.label = null;\n                }\n            }\n        }\n\n        this.visibleLabels = [];\n    };\n\n    proto.renderRubberband = function(picks) {\n\n        switch (this.measurement.measurementType) {\n            case MeasureCommon.MeasurementTypes.MEASUREMENT_DISTANCE:\n                var previewsPick = picks[1];\n                var activePick = picks[2];\n                var start = MeasureCommon.getSnapResultPosition(previewsPick, this.viewer);\n                var end = MeasureCommon.getSnapResultPosition(activePick, this.viewer);\n                \n                if (start && end) {\n                    this.renderDistanceMeasurement(start, end);\n                }\n                break;\n\n            case MeasureCommon.MeasurementTypes.MEASUREMENT_ANGLE:\n                this.renderAngleMeasurement(picks);\n                break;\n\n            case MeasureCommon.MeasurementTypes.MEASUREMENT_AREA:\n                this.renderAreaMeasurement(picks);\n                break;\n        }\n    };\n\n    proto.initMouseEvent = function(label, pointNumber) {\n        \n        var isSafari = av.isSafari();\n        this.onMouseClickBinded = function(event) { \n            if(isSafari || event.pointerType === 'mouse'){\n                event.canvasX = event.clientX;\n                event.canvasY = event.clientY;\n                this.tool.editEndpoint(event, pointNumber, this.measurement.id); \n            }\n        }.bind(this);\n        label.addEventListener(isSafari ? 'mousedown' : 'pointerdown', this.onMouseClickBinded);         \n    };\n","import { Indicator } from './Indicator'\n\n    var av = Autodesk.Viewing;\n    var MeasureCommon = Autodesk.Viewing.MeasureCommon;\n\n\n    // /** @constructor */\n    export function MeasureToolIndicator( viewer, measurement, measureTool )\n    {\n        Indicator.call(this, viewer, measurement, measureTool);\n        this.measureTool = measureTool;\n        this.endpoints = [];\n        this.lines = { \n            xyz: {axis: false, material: createLineMaterial('FF0000'), className: 'adsk-icon-axis-delta' + '-xyz measure-label-axis-delta' + ' measure-label-axis-xyz'},\n            x:   {axis: true,  material: createLineMaterial('F12C2C'), className: 'adsk-icon-axis-delta' + '-x measure-label-axis-delta' + ' measure-label-axis-x', iconText: 'X'},\n            y:   {axis: true,  material: createLineMaterial('0BB80B'), className: 'adsk-icon-axis-delta' + '-y measure-label-axis-delta' + ' measure-label-axis-y', iconText: 'Y'},\n            z:   {axis: true,  material: createLineMaterial('2C2CF1'), className: 'adsk-icon-axis-delta' + '-z measure-label-axis-delta' + ' measure-label-axis-z', iconText: 'Z'}\n        };\n        this.segments = [];\n        this.dashedLine = {};\n        this.simple = false;\n        this.angleLabel = {};\n        this.areaLabel = {};\n        this.labels = [];\n        this.isLeaflet = false;\n        this.topologyStatus = TOPOLOGY_NOT_AVAILABLE;\n        this.tmpVector = new THREE.Vector3();\n        this.surfaceColor = new THREE.MeshBasicMaterial({\n            color: parseInt('FF0000', 16),\n            opacity: 0.15,\n            transparent: true,\n            depthTest: false,\n            depthWrite: false,\n            side: THREE.DoubleSide\n        });   \n    }\n\n    MeasureToolIndicator.prototype = Object.create(Indicator.prototype);\n    MeasureToolIndicator.prototype.constructor = MeasureToolIndicator;\n    var proto = MeasureToolIndicator.prototype;\n\n    function createLineMaterial(color) {\n        return new THREE.MeshBasicMaterial({\n            color: parseInt(color, 16),\n            depthTest: false,\n            depthWrite: false,\n            side: THREE.DoubleSide\n        });   \n    }\n\n    var _labelsSpace = 4;\n    var _angleLabelOffset = 5;\n    var TOPOLOGY_NOT_AVAILABLE = 0;\n    var TOPOLOGY_FETCHING = 1; \n    var TOPOLOGY_AVAILABLE = 2;\n    var _selectorAreaSize = 15;\n\n    var _tipHeight = 2;\n    var _tipWidth = 3;\n    var _segmentWidth = 4;\n    var _dashedSegmentWidth = 3;\n    var _axisLineWidth = 2;\n    var _dashSize = 2;\n    var _gapSize = 1;\n\n    var _angleArcWidth = 2;\n\n    function isVisible(label) {\n        return label.classList.contains('visible');\n    }\n\n    proto.init = function() {\n        this.isLeaflet = this.viewer.model.getData().isLeaflet;\n        // Create HTML Labels\n        var currLabel;\n\n        this.onSelectionAreaClickedBinded = this.onSelectionAreaClicked.bind(this);\n\n        // Line\n        if (!this.lines.xyz.label) {\n            currLabel = this.lines.xyz.label = this.createMeasurementLabel(); // Measurement result\n            currLabel.addEventListener('mousewheel', this.viewer.toolController.mousewheel);\n            currLabel.addEventListener('click', this.onSelectionAreaClickedBinded);\n            this.viewer.container.appendChild(currLabel);\n        }\n        switch (this.topologyStatus) {\n            case TOPOLOGY_FETCHING:\n                this.setFetchingTopology();\n                break;\n            case TOPOLOGY_AVAILABLE:\n                this.setTopologyAvailable();\n                break;\n            case TOPOLOGY_NOT_AVAILABLE:\n                this.setNoTopology();\n                break;\n        }\n\n        this.showMeasureResult = false;\n\n        this.onCameraChangeBinded = this.onCameraChange.bind(this);\n        this.viewer.addEventListener(av.CAMERA_CHANGE_EVENT, this.onCameraChangeBinded);\n\n        this.handleButtonUpBinded = this.measureTool.handleButtonUp.bind(this.measureTool);\n        window.addEventListener('mouseup', this.handleButtonUpBinded);\n    };\n\n    proto.createEndpoint = function(index) {\n        this.endpoints[index] = {};\n        var currLabel = this.endpoints[index].label = this.createSnapResultLabel(index);\n        this.viewer.container.appendChild(currLabel);    \n    };\n\n    proto.updateLabelsPosition = function() {\n\n        var point,\n            xy,\n            label,\n            key;\n\n\n        for (key in this.endpoints) {\n            if (this.endpoints.hasOwnProperty(key)) {\n                    label = this.endpoints[key].label;\n                    point = this.endpoints[key].position;\n\n                if (label && point && isVisible(label)) {\n                    xy = MeasureCommon.project(point, this.viewer);\n\n                    xy.x = xy.x - label.getBoundingClientRect().width / 2;\n                    xy.y = xy.y - label.getBoundingClientRect().height / 2;\n                    \n                    label.style.top  = xy.y + 'px';\n                    label.style.left = xy.x + 'px';\n                    label.point = point;\n                    this.labels.push(label);\n                }\n            }\n        }\n\n        for (var name in this.lines) {\n            if (this.lines.hasOwnProperty(name)) {\n                var item = this.lines[name];\n                    label = item.label;\n\n                if (label && item.p1 && item.p2 && isVisible(label)) {\n                    \n                    item.line.visible = item.visible;\n\n                    point = { x: (item.p1.x + item.p2.x)/2, y: (item.p1.y + item.p2.y)/2, z: (item.p1.z + item.p2.z)/2 };\n                    \n                    xy = MeasureCommon.project(point, this.viewer);\n                    label.style.top  = xy.y - Math.floor(label.clientHeight / 2) + 'px';\n                    label.style.left = xy.x - Math.floor(label.clientWidth / 2) + 'px';\n\n                    if (this.viewer.model && this.viewer.model.is2d()) {\n                        var offset = item === this.lines.xyz ? 0 : label.clientHeight;\n\n                        var p1Projected = MeasureCommon.project(item.p1, this.viewer);\n                        var p2Projected = MeasureCommon.project(item.p2, this.viewer);\n\n                        if (label.clientWidth >= p1Projected.distanceTo(p2Projected) - this.endpoints[1].label.clientWidth) {\n                            if (item === this.lines.xyz) {\n                                offset = label.clientHeight;\n                            } else {\n                                // Hide all axis labels and quit the loop\n                            \n                                this.lines.x.line.visible = false;\n                                this.lines.y.line.visible = false;\n\n                                this.viewer.impl.invalidate(false, false, /*overlayDirty=*/true);\n\n                                for (name in this.lines) {\n                                    if (this.lines.hasOwnProperty(name)) {\n                                        if (this.lines[name] !== this.lines.xyz) {\n                                            var currLabel = this.lines[name].label;\n                                            if (currLabel) {\n                                                currLabel.style.opacity = 0;\n                                            }\n                                        }\n                                    }\n                                }\n\n                                break;\n                                \n                            }\n                        }\n\n                        if (item !== this.lines.xyz) {\n                            var xyzDirection = new THREE.Vector3();\n                            var itemDirection = new THREE.Vector3();\n                            xyzDirection.subVectors(this.lines.xyz.p1, this.lines.xyz.p2).normalize();\n                            itemDirection.subVectors(item.p1, item.p2).normalize();\n                            var normal = xyzDirection.cross(this.viewer.navigation.getEyeVector()).normalize();\n                            var angle = normal.dot(itemDirection);\n                            \n                            if (angle < 0) {\n                                offset = -offset;\n                            }\n                        }\n\n                        this.alignLabelWithLine(label, item.p1, item.p2, offset, this.viewer);\n                    }\n\n                    label.style.opacity = 1;\n                    label.point = point;\n                    this.labels.push(label);\n                }\n            }\n        }\n\n        if (this.angleLabel) {\n\n            label = this.angleLabel.label;\n\n            if (label && this.angleLabel.p1 && this.angleLabel.p2 && isVisible(label)) {\n                point = { x: (this.angleLabel.p1.x + this.angleLabel.p2.x)/2, y: (this.angleLabel.p1.y + this.angleLabel.p2.y)/2, z: (this.angleLabel.p1.z + this.angleLabel.p2.z)/2 };\n                xy = MeasureCommon.project(point, this.viewer, _angleLabelOffset);\n                label.style.top = xy.y - Math.floor(label.clientHeight / 2) + 'px';\n                label.style.left = xy.x - Math.floor(label.clientWidth / 2) + 'px';\n                label.point = point;\n                this.labels.push(label);\n            }\n        }\n\n        if (this.areaLabel) {\n\n            label = this.areaLabel.label;\n\n            if (label && this.areaLabel.p1 && this.areaLabel.p2 && isVisible(label)) {\n                point = { x: (this.areaLabel.p1.x + this.areaLabel.p2.x)/2, y: (this.areaLabel.p1.y + this.areaLabel.p2.y)/2, z: (this.areaLabel.p1.z + this.areaLabel.p2.z)/2 };\n                xy = MeasureCommon.project(point, this.viewer);\n                label.style.top  = xy.y - Math.floor(label.clientHeight / 2) + 'px';\n                label.style.left = xy.x - Math.floor(label.clientWidth / 2) + 'px';\n                label.point = point;\n                this.labels.push(label);\n            }\n        }\n\n        if (this.viewer.model && !this.viewer.model.is2d()) {\n    \n            var needToStackLabels = false;\n            this.labelsStacked = false;\n            var currentLabel, i;\n\n            // Backup lable's positions in case of the need of stacking them later\n            var backupPositions = [];\n            for (i = 0; i < this.labels.length; i++) {\n                backupPositions.push({left: this.labels[i].style.left, top:this.labels[i].style.top});\n            }\n\n            // Detect and move in case of overlapping.\n            for (i = 0; i < this.labels.length && !needToStackLabels; i++) {\n                currentLabel = this.labels[i];\n                needToStackLabels = this.labelsOverlapDetection(currentLabel, this.labels);\n            }\n\n            // If we found out that the labels need to be stacked, restore their positions from the backup first, and then start again.\n            if (needToStackLabels) {\n\n                for (i = 0; i < this.labels.length; i++) {\n                    this.labels[i].style.left = backupPositions[i].left;\n                    this.labels[i].style.top = backupPositions[i].top;\n                }\n\n                this.stackLabels(this.labels);\n\n                for (i = 0; i < this.labels.length; i++) {\n                    currentLabel = this.labels[i];\n                    this.labelsOverlapDetection(currentLabel, this.labels);\n                }\n            } \n        }\n\n        this.labels = [];\n        \n    };\n\n    function isLeftIntersect(current, other) {\n        return current.right >= other.left && current.right <= other.right;\n    }\n\n    function isRightIntersect(current, other) {\n        return current.left >= other.left && current.left <= other.right;\n    }\n\n    function isMiddleIntersect(current, other) {\n        return current.left <= other.left && current.right >= other.right;\n    }\n\n    function isVerticalIntersect(current, other) {\n        return current.top < other.bottom && current.bottom > other.top;\n    }\n\n    function moveLeft(currentLabel, currentRect, otherRect) {\n        currentLabel.style.left = parseInt(currentLabel.style.left, 10) - (currentRect.right - otherRect.left) + 'px';\n    }\n\n    function moveRight(currentLabel, currentRect, otherRect) {\n        currentLabel.style.left = parseInt(currentLabel.style.left, 10) + (otherRect.right - currentRect.left) + 'px';\n    }\n\n    function moveDown(currentLabel, currentRect, otherRect) {\n        currentLabel.style.top = parseInt(currentLabel.style.top, 10) + (otherRect.bottom - currentRect.top) + 'px';\n    }\n\n\n    proto.labelsOverlapDetection = function(staticLabel, labelsList) {\n\n        var needToStackLabels = false;\n\n        for (var i = 0; i < labelsList.length ; i++) {\n\n            var dynamicLabel = labelsList[i];\n            var moved = false;\n\n            if (staticLabel !== dynamicLabel) {\n                var staticRect = staticLabel.getBoundingClientRect();\n                var dynamicRect = dynamicLabel.getBoundingClientRect();\n\n                if (isVerticalIntersect(dynamicRect, staticRect)) {\n\n                    if (isLeftIntersect(dynamicRect, staticRect)) {\n                        moveLeft(dynamicLabel, dynamicRect, staticRect);\n                        moved = true;\n                    }\n                    else if (isRightIntersect(dynamicRect, staticRect)) {\n                        moveRight(dynamicLabel, dynamicRect, staticRect);\n                        moved = true;\n                    }\n                    else if (isMiddleIntersect(dynamicRect, staticRect)) {\n                        moveDown(dynamicLabel, dynamicRect, staticRect);\n                        moved = true;\n                    }\n\n                    if (moved) {\n                        var newList = labelsList.slice(0);\n                        newList.splice(newList.indexOf(staticLabel), 1);\n                        this.labelsOverlapDetection(dynamicLabel, newList);    \n                        \n                        if (dynamicLabel.causeStacking && staticLabel.causeStacking) {\n                            needToStackLabels = true;\n                        }\n\n                        // We don't want that after the labels have been stacked, only one of them will move alone.\n                        if (dynamicLabel.causeStacking && this.labelsStacked) {\n                            this.stackLabels(this.labels);\n                        }\n                    }\n                }\n            }\n        }\n\n        return needToStackLabels;\n    };\n\n    proto.stackLabels = function(labels) { \n        var topLabel = this.lines.xyz.label;\n\n        for (var i = 1; i < labels.length; i++) {\n            if (labels[i].causeStacking) {\n                labels[i].style.left = topLabel.style.left;\n            \n                var rect = labels[i-1].getBoundingClientRect();\n                var space = (labels[i-1] == topLabel) ? _labelsSpace : 0;\n                var top = (labels[i] === topLabel) ? topLabel.style.top : labels[i-1].style.top;\n                labels[i].style.top = parseInt(top, 10) + rect.height + space + 'px';\n            }\n            labels[i].style.transform = '';\n        }\n\n        this.labelsStacked = true;\n    };\n\n    proto.drawXYZLine = function(item) {\n        var self = this;\n\n        var p1 = item.p1;\n        var p2 = item.p2;\n\n        if (!p1 || !p2)\n            return;\n\n        var tmpVec = new THREE.Vector3();\n        var geometry = item.geometry = new THREE.Geometry();\n        var direction = new THREE.Vector3().subVectors(p2, p1).normalize();\n        var normal = direction.clone().cross(self.viewer.navigation.getEyeVector()).normalize();\n        var point = MeasureCommon.nearestPointInPointToSegment(self.viewer.navigation.getPosition(), p1, p2);\n        var scale = self.setScale(point);\n\n        item.line = this.drawLineSegment(p1, p2, _segmentWidth, item.material);\n        item.visible = true;\n\n        this.segments.push(item);\n        \n        function drawTip(p) {\n            geometry.vertices = [];\n\n            // Edge\n            tmpVec.addVectors(p, normal.clone().multiplyScalar(_tipHeight * scale));\n            geometry.vertices[0] = tmpVec.clone();\n            tmpVec.subVectors(p, normal.clone().multiplyScalar(_tipHeight * scale));\n            geometry.vertices[1] = tmpVec.clone();\n            var line = self.drawLineAsCylinder(geometry, item.material, _tipWidth, self.overlayName);\n            self.setCylinderScale(line, p1 ,p2);\n            line.visible = true;\n            item.tips.push(line);\n        }\n\n        if (self.showMeasureResult) {\n            item.tips = [];\n\n            drawTip(p1);\n            drawTip(p2);    \n        }        \n    };\n\n    proto.redrawDashedLine = function() {\n        if (!this.dashedLine.p1 || !this.dashedLine.p2)\n            return;\n\n        this.viewer.impl.removeMultipleOverlays(this.overlayName, this.dashedLine.line);\n        \n        var p1Scale = this.setScale(this.dashedLine.p2);\n        var dashSize = _dashSize * p1Scale;\n        var gapSize = _gapSize * p1Scale;\n        this.dashedLine.line = this.drawDashedLine(this.dashedLine.p2, this.dashedLine.p1, dashSize, gapSize, this.lines.xyz.material, _dashedSegmentWidth, this.overlayName);\n\n        return this.dashedLine.line;\n    }; \n\n    proto.drawLineSegment = function(p1, p2, width, material, isDashedLine) {\n        var line;\n\n        if (isDashedLine) {\n            this.dashedLine.p1 = p1;\n            this.dashedLine.p2 = p2;\n            line = this.redrawDashedLine();\n        } else {\n            var geometry = new THREE.Geometry();\n            geometry.vertices.push(p1);\n            geometry.vertices.push(p2);\n            line = this.drawLineAsCylinder(geometry, material, width, this.overlayName);\n            this.setCylinderScale(line, p1, p2);\n        }\n\n        line.visible = true;\n\n        return line;\n    };\n\n    proto.drawSurface = function(points) {\n\n        var shape = new THREE.Shape();\n\n        shape.moveTo( points[0].x, points[0].y );\n\n        for (var i = 1; i < points.length; i++) {\n            shape.lineTo( points[i].x, points[i].y);    \n        }\n\n        // Close shape.\n        shape.lineTo( points[0].x, points[0].y);    \n\n        var geometry = new THREE.ShapeGeometry( shape );\n        var face = new THREE.Mesh(geometry, this.surfaceColor);\n\n        this.viewer.impl.addOverlay(this.overlayName, face);\n    };\n\n    proto.drawSegmentAndPush = function(p1, p2, isDashedLine) {\n        if (!p1 || !p2) {\n            return;\n        }\n\n         var line = this.drawLineSegment(p1, p2, _segmentWidth, this.lines.xyz.material, isDashedLine);\n            \n        if (!isDashedLine) {\n            var item = { line: line, p1: p1, p2: p2 };\n            this.segments.push(item);    \n        }\n    };\n\n    proto.renderAreaMeasurement = function(picks) {\n\n        var count = this.measurement.countPicks();\n        var p1, p2;\n\n        var points = [];\n        \n        for (var i = 1; i < count; i++) {\n            p1 = MeasureCommon.getSnapResultPosition(picks[i], this.viewer);\n            p2 = MeasureCommon.getSnapResultPosition(picks[i + 1], this.viewer);\n\n            this.drawSegmentAndPush(p1, p2);\n            points.push(p1);\n        }\n\n        if (count > 2) {\n            // Draw last line\n            p1 = MeasureCommon.getSnapResultPosition(picks[1], this.viewer);\n            this.drawSegmentAndPush(p1, p2, !this.measurement.closedArea);\n            \n            if(!MeasureCommon.isEqualVectors(p1,p2,MeasureCommon.EPSILON)){\n                points.push(p2);\n            }\n            \n            if (MeasureCommon.isPolygonSimple(points) && this.measurement.area !== 0) {\n                this.drawSurface(points);    \n                this.showAreaLabel(MeasureCommon.getPolygonVisualCenter(points));\n                this.updateArea();\n            }\n        }        \n    };\n\n    proto.clearAngleMeshes = function() {\n        if (this.angleArc) {\n            this.viewer.impl.removeOverlay(this.overlayName, this.angleArc);\n            this.angleArc = null;\n        }\n        if (this.angleOutline.length > 0) {\n            this.viewer.impl.removeMultipleOverlays(this.overlayName, this.angleOutline);\n            this.angleOutline.length = 0;\n        }\n    };\n\n    proto.drawAngle = function(p, ep1, ep2, n, angle, midPoint) {\n\n        var smallNum = 0.001;\n\n        if (!this.materialAngle) {\n\n            this.materialAngle = new THREE.MeshPhongMaterial({\n                    color: 0x999999,\n                    ambient: 0x999999,\n                    opacity: 0.5,\n                    transparent: true,\n                    depthTest: false,\n                    depthWrite: false,\n                    side: THREE.DoubleSide\n                }\n            );\n\n            this.materialAngleOutline = new THREE.MeshBasicMaterial({\n                color: 0xFF9900,\n                depthTest: false,\n                depthWrite: false\n            });\n\n        }\n\n        MeasureCommon.createCommonOverlay(this.viewer, this.overlayName);\n        this.clearAngleMeshes();\n\n        // draw arc of angle\n        var radius = Math.min(p.distanceTo(ep1), p.distanceTo(ep2)) / 4;\n        var segments = 100;\n        //angle = angle * Math.PI / 180;\n\n        var circleGeometry = new THREE.CircleGeometry(radius, segments, 0, angle * Math.PI / 180);\n        var arc = new THREE.Mesh(circleGeometry, this.surfaceColor);\n\n        var center = arc.geometry.vertices[0].clone();\n        arc.geometry.vertices.push(center);\n\n\n        // Translate and rotate the arc to the plane where it should lie in\n        arc.position.set(p.x, p.y, p.z);\n        var V = arc.position.clone();\n        V.add(n);\n        arc.lookAt(V);\n        arc.updateMatrixWorld();\n\n\n        // Rotate the arc in the plane to the right place\n        var vA = arc.geometry.vertices[1].clone();\n        var vB = arc.geometry.vertices[arc.geometry.vertices.length - 2].clone();\n        vA.applyMatrix4(arc.matrixWorld);\n        vB.applyMatrix4(arc.matrixWorld);\n\n        var v1 = new THREE.Vector3();\n        var v2 = new THREE.Vector3();\n        var v3 = new THREE.Vector3();\n        var v4 = new THREE.Vector3();\n        v1.subVectors(vA, p);\n        v2.subVectors(vB, p);\n        v3.subVectors(ep1, p);\n        v4.subVectors(ep2, p);\n\n        var a13 = v1.angleTo(v3);\n        var a14 = v1.angleTo(v4);\n        var a23 = v2.angleTo(v3);\n        var a24 = v2.angleTo(v4);\n\n        //console.log(a13 * 180 / Math.PI + \" \" + a14 * 180 / Math.PI + \" \" + a23 * 180 / Math.PI + \" \" + a24 * 180 / Math.PI);\n\n        var ra;\n        // The arc is in the right place\n        if (((a13 <= smallNum && a13 >= -smallNum) || (a14 <= smallNum && a14 >= -smallNum))\n            && ((a23 <= smallNum && a23 >= -smallNum) || (a24 <= smallNum && a24 >= -smallNum))) {\n\n            ra =0;\n        }\n        // The arc needs to be rotated 180 degree to the right place\n        else if (((a13 <= Math.PI + smallNum && a13 >= Math.PI - smallNum) || (a14 <= Math.PI + smallNum && a14 >= Math.PI - smallNum))\n            && ((a23 <= Math.PI + smallNum && a23 >= Math.PI - smallNum) || (a24 <= Math.PI + smallNum && a24 >= Math.PI - smallNum))) {\n\n            ra = Math.PI;\n        }\n        // The arc needs to be rotated a13 radian\n        else if ((a13 <= a23 + smallNum && a13 >= a23 - smallNum) || (a13 <= a24 + smallNum && a13 >= a24 - smallNum)) {\n\n            ra = a13;\n        }\n        // The arc needs to be rotated a14 radian\n        else {\n\n            ra = a14;\n        }\n\n        var rotWorldMatrix = new THREE.Matrix4();\n        rotWorldMatrix.makeRotationAxis(n, ra);\n        //arc.matrix.multiply(rotWorldMatrix);\n        rotWorldMatrix.multiply(arc.matrix);\n        arc.matrix = rotWorldMatrix;\n        arc.rotation.setFromRotationMatrix(arc.matrix);\n\n        // Check if rotate to the wrong direction, if so, rotate back twice of the degree\n        arc.updateMatrixWorld();\n        vA = arc.geometry.vertices[1].clone();\n        vB = arc.geometry.vertices[arc.geometry.vertices.length - 2].clone();\n        vA.applyMatrix4(arc.matrixWorld);\n        vB.applyMatrix4(arc.matrixWorld);\n\n        v1.subVectors(vA, p);\n        v2.subVectors(vB, p);\n\n        a13 = v1.angleTo(v3);\n        a14 = v1.angleTo(v4);\n        a23 = v2.angleTo(v3);\n        a24 = v2.angleTo(v4);\n\n        //console.log(a13 * 180 / Math.PI + \" \" + a14 * 180 / Math.PI + \" \" + a23 * 180 / Math.PI + \" \" + a24 * 180 / Math.PI);\n\n        if (a13 >= smallNum && a14 >= smallNum) {\n\n            rotWorldMatrix = new THREE.Matrix4();\n            rotWorldMatrix.makeRotationAxis(n, - ra * 2);\n            //arc.matrix.multiply(rotWorldMatrix);\n            rotWorldMatrix.multiply(arc.matrix);\n            arc.matrix = rotWorldMatrix;\n            arc.rotation.setFromRotationMatrix(arc.matrix);\n        }\n\n        // draw outline of the arc\n        var outlineGeometry = new THREE.CircleGeometry(radius, segments, 0, angle * Math.PI / 180);\n        outlineGeometry.vertices.splice(0, 1);\n        arc.updateMatrixWorld();\n        outlineGeometry.applyMatrix(arc.matrixWorld);\n        this.angleOutline = this.drawEdgeAsCylinder(outlineGeometry, this.lines.xyz.material, _angleArcWidth, 0, this.getNewCylinderGeometry());\n\n        this.angleArc = arc;\n        this.viewer.impl.addOverlay(this.overlayName, this.angleArc);\n        this.viewer.impl.addMultipleOverlays(this.overlayName, this.angleOutline);\n\n        // This is used for angle label's position\n        midPoint.copy(arc.geometry.vertices[Math.round(arc.geometry.vertices.length / 2) - 1]);\n        midPoint.applyMatrix4(arc.matrixWorld);\n        var dir = new THREE.Vector3();\n        dir.subVectors(midPoint, p).normalize();\n        dir.multiplyScalar(radius / 2);\n        midPoint.add(dir);\n    };\n\n    proto.renderAngleMeasurement = function(picks) {\n\n        var count = this.measurement.countPicks();\n        var p1, p2;\n\n        var points = [];\n        \n        for (var i = 1; i < count; i++) {\n            p1 = MeasureCommon.getSnapResultPosition(picks[i], this.viewer);\n            p2 = MeasureCommon.getSnapResultPosition(picks[i + 1], this.viewer);\n\n            this.drawSegmentAndPush(p1, p2);\n\n            if (p1) {\n                points.push(p1);    \n            }\n        }\n\n        if (p2) {\n            points.push(p2);\n        }\n        \n        if (points.length === 3 && this.measurement.angle) {\n            var n = new THREE.Vector3();\n            var v1 = new THREE.Vector3();\n            var v2 = new THREE.Vector3();\n            v1.subVectors(points[0], points[1]);\n            v2.subVectors(points[1], points[2]);\n            n.crossVectors(v1, v2);\n            n.normalize();\n\n            var midPoint = new THREE.Vector3();\n            this.drawAngle(points[1], points[0], points[2], n, this.measurement.angle, midPoint);\n            this.showAngleLabel(midPoint);\n            this.updateAngle();\n        }        \n    };\n\n    proto.createDistanceLabel = function(item) {\n        var label = item.label = this.createMeasurementLabel();\n        \n        setVisibilityMeasurementLabelText(label, item === this.lines.xyz);\n\n        // Override main label when displaying only an axis label (X, Y or Z)\n        if (item.axis) {\n            label.className = item.className;\n            var axisIcon = document.createElement('div');\n            axisIcon.className = 'measure-label-axis-icon ' + item.iconText;\n            axisIcon.innerText = item.iconText;\n            label.insertBefore(axisIcon, label.firstChild);\n\n            if (!av.isMobileDevice()) {\n                MeasureCommon.safeToggle(label, 'enableTransition', true);\n            }\n        }\n\n        this.viewer.container.appendChild(label);\n\n        return label;\n    };\n\n    // Draw distance measurement\n    proto.renderDistanceMeasurement = function(p1, p2)\n    {\n        var self = this;\n\n        function updateLine(item, x1, y1, z1, x2, y2, z2, showAxis) {\n            var line = item.line,\n                label = item.label,\n                p1 = new THREE.Vector3(x1, y1, z1),\n                p2 = new THREE.Vector3(x2, y2, z2);\n\n            // Swap points if needed to have consistent axis directions.\n            var tmpVec;\n            if (item === self.lines.x && p2.x > p1.x) {\n                tmpVec = p1.clone();\n                p1 = p2.clone();\n                p2 = tmpVec.clone();\n            } \n            else if (item === self.lines.y && p2.y > p1.y) {\n                tmpVec = p1.clone();\n                p1 = p2.clone();\n                p2 = tmpVec.clone();\n            } \n            else if (item === self.lines.z && p2.z > p1.z) {\n                tmpVec = p1.clone();\n                p1 = p2.clone();\n                p2 = tmpVec.clone();\n            }\n\n            item.line = null;            \n\n            if (!label) {\n                label = self.createDistanceLabel(item);\n            }\n            else {\n                self.hideLabel(label);\n            }\n            \n            if (((self.isLeaflet && item !== self.lines.z) || (p1.distanceTo(p2) >= MeasureCommon.EPSILON)) && showAxis) {\n\n                item.p1 = p1;\n                item.p2 = p2;\n\n                if (item === self.lines.xyz) {\n                    self.drawXYZLine(item);\n                    self.showLabel(label);\n                    self.updateDistance();\n                }\n                else {\n                    line = item.line = self.drawLineSegment(p1, p2, _axisLineWidth, item.material);\n                    var show = !self.simple && self.showMeasureResult;\n\n                    line.visible = show;\n                    item.visible = show;\n\n                    if (show) {\n                        self.showLabel(label);\n                    }\n                    else {\n                        self.hideLabel(label);\n                    }\n                }\n            }\n        }\n\n        // If the line aligns with one of axis, then don't show axis\n        function displayAxis(p1, p2) {\n            self.tmpVector.subVectors(p1, p2);\n            self.tmpVector.normalize();\n\n            return !MeasureCommon.isParallel(self.tmpVector, self.xAxis) && !MeasureCommon.isParallel(self.tmpVector, self.yAxis) && !MeasureCommon.isParallel(self.tmpVector, self.zAxis);\n        }\n\n        updateLine(this.lines.xyz, p1.x, p1.y, p1.z, p2.x, p2.y, p2.z, true);\n\n        var up = this.viewer.navigation.getAlignedUpVector(),\n            x = Math.abs(up.x),\n            y = Math.abs(up.y),\n            z = Math.abs(up.z);\n\n        var showAxis = displayAxis(p1, p2);\n\n        if (z > x && z > y) { // z up\n            updateLine(this.lines.x, p1.x, p1.y, p1.z, p2.x, p1.y, p1.z, showAxis);\n            updateLine(this.lines.y, p2.x, p1.y, p1.z, p2.x, p2.y, p1.z, showAxis);\n            updateLine(this.lines.z, p2.x, p2.y, p1.z, p2.x, p2.y, p2.z, showAxis);\n\n        } else if (y > x && y > z) { // y up\n            updateLine(this.lines.x, p1.x, p1.y, p1.z, p2.x, p1.y, p1.z, showAxis);\n            updateLine(this.lines.z, p2.x, p1.y, p1.z, p2.x, p1.y, p2.z, showAxis);\n            updateLine(this.lines.y, p2.x, p1.y, p2.z, p2.x, p2.y, p2.z, showAxis);\n\n        } else { // x up - do we ever see this?\n            updateLine(this.lines.y, p1.x, p1.y, p1.z, p1.x, p2.y, p1.z, showAxis);\n            updateLine(this.lines.z, p1.x, p2.y, p1.z, p1.x, p2.y, p2.z, showAxis);\n            updateLine(this.lines.x, p1.x, p2.y, p2.z, p2.x, p2.y, p2.z, showAxis);\n        }\n\n    };\n\n    proto.updateResults = function() {\n        this.updateDistance();\n        this.updateAngle();\n        this.updateArea();\n        \n        setTimeout(function(){\n            // This can get called after the viewer is unloaded\n            if (this.viewer.impl)\n                this.updateLabelsPosition();\n        }.bind(this), 0);\n    };\n\n    // Update distance measurement label\n    proto.updateDistance = function() {\n\n        function setWidth(label, value) {\n            if (!label) return;\n            label.style.width = value;\n        }\n\n        function getWidth(label) {\n            return label ? label.clientWidth : 0;\n        }\n\n        Object.keys(this.lines).forEach(function(name) {\n            setWidth(this.lines[name].label, '');\n        }.bind(this));\n        \n        setDeltaMeasurementLabelText(this.lines.x.label, \"~ \" + this.measureTool.getDistanceX(this.measurement));\n        setDeltaMeasurementLabelText(this.lines.y.label, \"~ \" + this.measureTool.getDistanceY(this.measurement));\n        setDeltaMeasurementLabelText(this.lines.z.label, \"~ \" + this.measureTool.getDistanceZ(this.measurement));\n        setValueMeasurementLabelText(this.lines.xyz.label, \"~ \" + this.measureTool.getDistanceXYZ(this.measurement));\n\n        if (this.viewer.model && this.viewer.model.is3d()) {\n            setTimeout(function(){\n                var maxWidth = Math.max(getWidth(this.lines.x.label), getWidth(this.lines.y.label), getWidth(this.lines.z.label), getWidth(this.lines.xyz.label));                \n                Object.keys(this.lines).forEach(function(name) {\n                    setWidth(this.lines[name].label, maxWidth + 'px');\n                }.bind(this));\n            }.bind(this), 0);\n        }\n    };\n\n    // Update angle measurement label\n    proto.updateAngle = function() {\n        setValueMeasurementLabelText(this.angleLabel.label, \"~ \" + this.measureTool.getAngle(this.measurement));\n    };\n\n    // Update area measurement label\n    proto.updateArea = function() {\n        setValueMeasurementLabelText(this.areaLabel.label, \"~ \" + this.measureTool.getArea(this.measurement));\n    };\n\n    // Set if collapse or expand the xyz delta distance\n    proto.setSimple = function(simple) {\n        if (this.simple != simple) {\n            this.simple = simple;\n\n            var isVisible = !simple;\n            this.setLineVisible(this.lines.x, isVisible);\n            this.setLineVisible(this.lines.y, isVisible);\n            this.setLineVisible(this.lines.z, isVisible);\n\n            this.updateLabelsPosition();\n\n            this.viewer.impl.invalidate(false, false, /*overlayDirty=*/true);\n        }\n    };\n\n    proto.setLineVisible = function(item, isVisible) {\n        if (item.line) {\n            item.line.visible = isVisible;\n            item.visible = isVisible;\n\n            if (item.label) {\n                if (isVisible) {\n                    this.showLabel(item.label);\n                }\n                else {\n                    this.hideLabel(item.label);\n                    item.label.style.opacity = 0;\n                }\n            }\n        }\n    };\n\n    proto.enableLabelsTouchEvents = function(enable) {\n        var value = enable ? 'all' : 'none';\n\n        if (this.lines.xyz.label) {\n            this.lines.xyz.label.style.pointerEvents = value;   \n        }\n\n        if (this.angleLabel.label) {\n            this.angleLabel.label.style.pointerEvents = value;   \n        }\n\n        if (this.areaLabel.label) {\n            this.areaLabel.label.style.pointerEvents = value;\n        }\n    };\n\n    proto.setLabelsZIndex = function(zIndex) {\n        for (var name in this.lines) {\n            if (this.lines.hasOwnProperty(name)) {\n                var item = this.lines[name];\n                if (item.label) {\n                    item.label.style.zIndex = zIndex;\n                }\n            }\n        }\n\n        if (this.angleLabel && this.angleLabel.label) {\n            this.angleLabel.label.style.zIndex = zIndex;    \n        }\n\n        if (this.areaLabel && this.areaLabel.label) {\n            this.areaLabel.label.style.zIndex = zIndex;    \n        }\n\n        for (name in this.endpoints) {\n            if (this.endpoints.hasOwnProperty(name)) {\n                var endpoint = this.endpoints[name];\n                if (endpoint.label) {\n                    endpoint.label.style.zIndex = zIndex - 1;\n                }\n            }\n        }\n    };\n\n    proto.focusLabels = function() {\n        this.setLabelsZIndex(3);\n    };\n\n    proto.unfocusLabels = function() {\n        this.setLabelsZIndex(2);\n    };\n\n    proto.clear = function() {\n        var name;\n\n        for (name in this.endpoints) {\n            if (this.endpoints.hasOwnProperty(name)) {\n                var endpoint = this.endpoints[name];\n                if (endpoint.label) {\n                    this.hideLabel(endpoint.label);\n                }\n            }\n        }\n\n        for (name in this.lines) {\n            if (this.lines.hasOwnProperty(name)) {\n                var item = this.lines[name];\n                if (item.line) {\n                    item.line.visible = false;\n                    item.visible = false;\n\n                    item.tips && item.tips.forEach(function(tip) {\n                        tip.visible = false;\n                    });\n                }\n                if (item.label) {\n                    this.hideLabel(item.label);\n                    item.label.style.opacity = 0;\n                    item.label.style.zIndex = 2;\n                }\n            }\n        }\n\n        if (this.angleLabel && this.angleLabel.label) {\n            this.hideLabel(this.angleLabel.label);\n        }\n\n        if (this.areaLabel && this.areaLabel.label) {\n            this.hideLabel(this.areaLabel.label);\n        }\n        \n        this.clearSelectionAreas();\n\n        this.segments = [];\n        this.dashedLine = {};\n\n        this.viewer.impl.clearOverlay(this.overlayName);\n        MeasureCommon.createCommonOverlay(this.viewer, this.overlayName);\n    };\n\n    proto.hideClick = function(pickNumber) {\n\n        Indicator.prototype.hideClick.call(this, pickNumber);\n\n        for (var name in this.lines) {\n            if (this.lines.hasOwnProperty(name)) {\n                var item = this.lines[name];\n                if (item.line) {\n                    item.line.visible = false;\n                    item.visible = false;\n\n                    item.tips && item.tips.forEach(function(tip) {\n                        tip.visible = false;\n                    });\n                }\n                if (item.label) {\n                    this.hideLabel(item.label);\n                    item.label.style.opacity = 0;\n                }\n            }\n        }\n\n        if (this.angleLabel && this.angleLabel.label) {\n            this.hideLabel(this.angleLabel.label);\n        }\n\n        if (this.areaLabel && this.areaLabel.label) {\n            this.hideLabel(this.areaLabel.label);\n        }\n\n        this.enableSelectionAreas(item.selectionArea, false);\n    };\n\n    proto.destroy = function() {\n        var name;\n\n        Indicator.prototype.destroy.call(this);\n\n        for (name in this.lines) {\n            if (this.lines.hasOwnProperty(name)) {\n                var item = this.lines[name];\n                if (item.line) {\n                    this.viewer.impl.clearOverlay(self.overlayName);\n                    item.material = item.line = item.geometry = null;\n                }\n\n                if (item.label) {\n                    if (name === 'xyz') {\n                        item.label.addEventListener('mousewheel', this.viewer.toolController.mousewheel);\n                        item.label.removeEventListener('click', this.onSelectionAreaClickedBinded);    \n                    }\n\n                    item.label.parentNode.removeChild(item.label);\n                    item.label = null;\n                }\n                item.material = item.line = item.geometry = item.label = item.p1 = item.p2 = null;\n            }\n        }\n\n        this.clearAngleMeshes();\n        \n        if (this.angleLabel && this.angleLabel.label) {\n            this.angleLabel.label.parentNode.removeChild(this.angleLabel.label);\n            this.angleLabel.label.removeEventListener('mousewheel', this.viewer.toolController.mousewheel);\n            this.angleLabel.label.removeEventListener('click', this.onSelectionAreaClickedBinded);\n             this.angleLabel.label = this.angleLabel.p1 = this.angleLabel.p2 = null;\n        }\n\n        \n\n        if (this.areaLabel && this.areaLabel.label) {\n            this.areaLabel.label.parentNode.removeChild(this.areaLabel.label);\n            this.areaLabel.label.removeEventListener('mousewheel', this.viewer.toolController.mousewheel);\n            this.areaLabel.label.removeEventListener('click', this.onSelectionAreaClickedBinded);\n            this.areaLabel.label = this.areaLabel.p1 = this.areaLabel.p2 = null;\n        }\n        \n        \n\n        if (this.viewer.impl.overlayScenes[this.overlayName]){\n            this.viewer.impl.removeOverlayScene(this.overlayName);\n        }\n\n        this.viewer.removeEventListener(av.CAMERA_CHANGE_EVENT, this.onCameraChangeBinded);\n        window.removeEventListener('mouseup', this.handleButtonUpBinded);\n    };\n\n    proto.clearXYZLine = function() {\n        this.viewer.impl.removeOverlay(this.overlayName, this.lines.xyz.line);\n\n        this.lines.xyz.tips && this.lines.xyz.tips.forEach(function(tip) {\n            this.viewer.impl.removeOverlay(this.overlayName, tip);\n        }.bind(this));\n    };\n\n    // Update scale for vertex, edge, line and extension dash line\n    proto.updateScale = function() {\n        var name;\n        \n        MeasureCommon.forAll(this.angleOutline, function(cylinderMesh) {\n            this.setCylinderScale(cylinderMesh);\n        }.bind(this));\n\n        for (name in this.lines) {\n            if (this.lines.hasOwnProperty(name)) {\n                var item = this.lines[name];\n                if (item.line && item !== this.lines.xyz) {\n                    this.setCylinderScale(item.line, item.p1, item.p2);\n                }\n            }\n        }\n        \n        for (name in this.segments) {\n            if (this.segments.hasOwnProperty(name)) {\n                var segment = this.segments[name];\n                if (segment.line) {\n                    this.setCylinderScale(segment.line, segment.p1, segment.p2);\n                } \n            }\n        }\n        \n        if (this.measurement.measurementType === MeasureCommon.MeasurementTypes.MEASUREMENT_DISTANCE) {\n            if (this.measurement.isComplete()) {\n                this.clearXYZLine();\n                this.drawXYZLine(this.lines.xyz);\n            }\n        }\n    };\n\n    proto.setNoTopology = function(){\n        this.topologyStatus = TOPOLOGY_NOT_AVAILABLE;\n        if (this.lines.xyz.label) {\n            setVisibilityMeasurementLabelSpinner(this.lines.xyz.label, false, this.topologyStatus);\n            this.lines.xyz.label.classList.remove('fetching-topology');\n        }\n    };\n    proto.setFetchingTopology = function() {\n        this.topologyStatus = TOPOLOGY_FETCHING;\n        if (this.lines.xyz.label) {\n            setVisibilityMeasurementLabelSpinner(this.lines.xyz.label, true, this.topologyStatus);\n                this.lines.xyz.label.classList.add('fetching-topology');\n        }\n    };\n    proto.setTopologyAvailable = function() {\n        this.topologyStatus = TOPOLOGY_AVAILABLE;\n        if (this.lines.xyz.label) {\n            setVisibilityMeasurementLabelSpinner(this.lines.xyz.label, false, this.topologyStatus);\n            this.lines.xyz.label.classList.remove('fetching-topology');\n        }\n    };\n\n    proto.createMeasurementLabel = function() {\n        \n        var label = document.createElement('div');\n        label.className = 'measure-length';\n        \n        var spinner = document.createElement('div');\n        spinner.className = 'measure-fetching-topology';\n        spinner.style.display = 'none';\n        label.appendChild(spinner);\n\n        var text = document.createElement('div');\n        text.className = 'measure-length-text';\n        label.appendChild(text);    \n\n        var delta = document.createElement('div');\n        delta.className = 'measure-delta-text';\n        label.appendChild(delta);\n\n        label.causeStacking = true;\n        \n        if (!av.isMobileDevice()) {\n            MeasureCommon.safeToggle(label, 'enable-hover', true);\n        }\n\n        return label;\n    };\n\n    // Receives an object created with createMeasurementLabel()\n    function setVisibilityMeasurementLabelText(label, isVisible) {\n        var div = label.querySelector('.measure-length-text');\n        div && (div.style.display = isVisible ? '' : 'none');\n    }\n\n    // Receives an object created with createMeasurementLabel()\n    function setValueMeasurementLabelText(label, strValue) {\n        if (!label) return;\n        var div = label.querySelector('.measure-length-text');\n        div && (div.textContent = strValue);\n    }\n\n    // Receives an object created with createMeasurementLabel()\n    function setDeltaMeasurementLabelText(label, strValue) {\n        if (!label) return;\n        var div = label.querySelector('.measure-delta-text');\n        div && (div.textContent = strValue);\n    }\n\n    // Receives an object created with createMeasurementLabel()\n    function setVisibilityMeasurementLabelSpinner(label, isVisible, topologyStatus) {\n        if (!label) return;\n        var div = label.querySelector('.measure-fetching-topology');\n        div && (div.style.display = \n            (isVisible && topologyStatus === TOPOLOGY_FETCHING) ? 'inline-block' : 'none');\n    }\n\n    /**\n     * Helper function that creates the label used for (1) and (2),\n     * which are the 2 mouse clicks for the measurement.\n     */\n    proto.createSnapResultLabel = function(pointNumber) {\n        \n        var label = document.createElement('div');\n        label.className = 'measure-label';\n\n        var label_icon = document.createElement('div');\n        label_icon.className = 'measure-label-icon';\n        label.appendChild(label_icon);\n\n        if (av.isTouchDevice()) {\n            this.initLabelMobileGestures(label, pointNumber, this.measureTool);\n            var hitArea = document.createElement('div');\n            hitArea.className = 'measure-label-hit-area';\n            label.appendChild(hitArea);                      \n        } \n         \n        if (!av.isMobileDevice()) {\n            this.initMouseEvent(label, pointNumber);\n\n            label.addEventListener('mousewheel', this.viewer.toolController.mousewheel);\n            MeasureCommon.safeToggle(label, 'enable-hover', true);  \n        }\n        \n \n        label.causeStacking = false;\n        \n        return label;\n    };\n\n    proto.showAngleLabel = function(midPoint) {\n\n            var label = this.angleLabel.label;\n\n            if (!label) {\n                label = this.angleLabel.label = this.createMeasurementLabel();\n                this.viewer.container.appendChild(label);\n                label.addEventListener('mousewheel', this.viewer.toolController.mousewheel);\n                label.addEventListener('click', this.onSelectionAreaClickedBinded);\n            }\n\n            this.updateAngle();\n            this.showLabel(label);\n\n            this.angleLabel.p1 = midPoint.clone();\n            this.angleLabel.p2 = midPoint.clone();\n\n    };\n\n    proto.showAreaLabel = function(midPoint) {\n\n            var label = this.areaLabel.label;\n\n            if (!label) {\n                label = this.areaLabel.label = this.createMeasurementLabel();\n                this.viewer.container.appendChild(label);\n                label.addEventListener('mousewheel', this.viewer.toolController.mousewheel);\n                label.addEventListener('click', this.onSelectionAreaClickedBinded);\n            }\n\n            this.updateArea();\n            this.showLabel(label);\n\n            this.areaLabel.p1 = midPoint;\n            this.areaLabel.p2 = midPoint;\n\n    };\n\n    proto.onSelectionAreaClicked = function() {\n        this.measureTool.selectMeasurementById(this.measurement.id);\n    };\n\n    proto.createSelectionArea = function() {\n        var selectionArea = document.createElement('div');\n        selectionArea.id = 'measurement-selection-area-' + this.measurement.id;\n        this.viewer.container.appendChild(selectionArea);\n        selectionArea.className = 'measure-selection-area';\n        selectionArea.style.display = 'none';\n        selectionArea.addEventListener('mousewheel', this.viewer.toolController.mousewheel);\n        selectionArea.addEventListener('click', this.onSelectionAreaClickedBinded);\n        return selectionArea;\n    };\n\n    proto.updateSelectionArea = function() {\n\n        this.segments.forEach(function(item) \n        {\n            if (item.p1 && item.p2) {\n                var p1 = MeasureCommon.project(item.p1, this.viewer);\n                var p2 = MeasureCommon.project(item.p2, this.viewer);\n\n                if (!item.selectionArea) {\n                    item.selectionArea = this.createSelectionArea();\n                }\n\n                var selectionArea = item.selectionArea;\n\n                var v = new THREE.Vector2();\n\n                selectionArea.style.top = (p1.y - (_selectorAreaSize / 2)) + 'px';\n                selectionArea.style.left = p1.x  + 'px';\n                selectionArea.style.width = v.subVectors(p1, p2).length() + 'px';\n                selectionArea.style.height = _selectorAreaSize + 'px';\n\n                var angle = null;\n                var deltaX = p1.x - p2.x;\n                var deltaY = p1.y - p2.y;\n\n                angle =  Math.atan2(-deltaY , -deltaX) * 180 / Math.PI;    \n\n                selectionArea.style.transform = 'rotate('+ angle +'deg)';\n                selectionArea.style.transformOrigin = '0px ' + (_selectorAreaSize / 2) + 'px';\n            }\n        }.bind(this));\n\n        if (this.measureTool.areAllPicksSet()) {\n            this.enableSelectionAreas(true);    \n        }\n    };\n\n    proto.clearSelectionAreas = function() {\n        this.segments.forEach(function(item) \n        {  \n            if (item.selectionArea) {\n                item.selectionArea.removeEventListener('mousewheel', this.viewer.toolController.mousewheel);\n                item.selectionArea.removeEventListener('click', this.onSelectionAreaClickedBinded);\n                var element = document.getElementById('measurement-selection-area-' + this.measurement.id);\n                if (element) {\n                    element.parentNode.removeChild(element);\n                }\n                item.selectionArea = null;\n            }\n        }.bind(this));\n    };\n\n    proto.enableSelectionAreas = function(enable) {\n        this.segments.forEach(function(item) \n        {   \n            if (item.selectionArea) {\n                if (enable) {\n                    item.selectionArea.style.display = 'block';\n                } \n                else {\n                    item.selectionArea.style.display = 'none';\n                }\n            }\n        }.bind(this));\n    };\n\n    proto.render = function(picks, showMeasureResult) {\n        Indicator.prototype.render.call(this, picks, showMeasureResult);\n\n        this.updateSelectionArea();\n    };\n\n    proto.onCameraChange = function() {\n        this.redrawDashedLine();\n        this.updateSelectionArea();\n        this.hideLabelsOutsideOfView();\n        this.updateLabelsPosition();\n    };\n\n    proto.handleResize = function() {\n        this.redrawDashedLine();\n        this.updateSelectionArea();\n        this.updateLabelsPosition();\n    };\n\n","import { MeasurementsManager } from './MeasurementsManager'\nimport { MeasureToolIndicator } from './MeasureToolIndicator'\n\n//\n// /** @constructor */\n//\n//\nexport function MeasureTool( viewer, options, sharedMeasureConfig, snapper )\n{\n    var _viewer  = viewer;\n    var _options = options || {};\n    var _names  = [\"measure\"];\n    var _priority = 50;\n\n    // Shared State with CalibrationTool and Indicator\n    var _sharedMeasureConfig = sharedMeasureConfig;\n\n    var av = Autodesk.Viewing;\n    var avem = Autodesk.Viewing.Extensions.Measure;\n    var MeasureCommon = Autodesk.Viewing.MeasureCommon;\n    \n    // Not shared with Indicator.js\n    var _active = false;\n    var _isDragging = false;\n    var _endpointMoved = false;\n    var _activePoint = 0;\n    var _consumeSingleClick = false;\n    var _singleClickHandled = false;\n    var _downX = null;\n    var _downY = null;\n    var _isolateMeasure = false;\n\n    var _measurementsManager = new MeasurementsManager(_viewer);\n    var _currentMeasurement = null;\n    var _onIndicatorCreatedCB = null;\n    \n    var _cursor = \"url(data:image/png;base64,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), auto\";\n\n    // Snapper\n    var _snapper = snapper;\n    \n    var _isPressing = false;\n\n    var _picksBackup = [];\n    var _cursorPosition = null;\n\n    var _closeAreaSnapRange = 25;\n    var _preMeasureIsolatedNodes = [];\n    var _preMeasureHiddenNodes = [];\n\n    var _measurementType = MeasureCommon.MeasurementTypes.MEASUREMENT_DISTANCE;\n\n    function getActivePick()\n    {   \n        if(!_currentMeasurement)\n            return null;\n\n        var index;\n\n        if (_activePoint === 0) {\n            return null;\n        } else if (_activePoint === _currentMeasurement.getMaxNumberOfPicks() + 1) {\n            index = _currentMeasurement.countPicks();\n        } else {\n               index = _activePoint;\n        }\n\n        return _currentMeasurement.getPick(index);\n    }\n\n    function getPreviousPick()\n    {\n        if(!_currentMeasurement)\n            return null;\n\n        var index;\n\n        if (_activePoint === 0) {\n            return null;\n        } else if (_activePoint === 1) {\n            index = _currentMeasurement.countPicks();\n        } else if (_activePoint === _currentMeasurement.getMaxNumberOfPicks() + 1) {\n            index = _currentMeasurement.countPicks() - 1;\n        } else {\n            index = _activePoint - 1;\n        }\n        \n        return _currentMeasurement.getPick(index);\n    }\n\n    function hasPreviousPick()\n    {\n        if(!_currentMeasurement)\n            return false;\n\n        var index;\n\n        if (_activePoint === 0) {\n            return false;\n        } else if (_activePoint === 1) {\n            index = _currentMeasurement.countPicks();\n        } else if (_activePoint === _currentMeasurement.getMaxNumberOfPicks() + 1) {\n            index = _currentMeasurement.countPicks() - 1;\n        } else {\n            index = _activePoint - 1;\n        }\n        \n        return _currentMeasurement.hasPick(index);\n    }\n\n    function noPicksSet() {\n        _activePoint = 0;\n    }\n\n    function allPicksSet() {\n        _activePoint = _currentMeasurement.countPicks() + 1;\n        enableMeasurementsTouchEvents(true);\n        _currentMeasurement.indicator.enableSelectionAreas(true);\n    }\n\n    function isNoPicksSet() {\n        return _activePoint === 0 || !_currentMeasurement;\n    }\n\n    this.areAllPicksSet = function() {\n        return _currentMeasurement && (_activePoint === _currentMeasurement.getMaxNumberOfPicks() + 1);\n    };\n\n    this.register = function()\n    {\n\n    };\n\n    this.deregister = function()\n    {\n        this.deactivate();\n    };\n\n    this.isActive = function()\n    {\n        return _active;\n    };\n\n    this.getNames = function()\n    {\n        return _names;\n    };\n\n    this.getName = function()\n    {\n        return _names[0];\n    };\n\n    this.getPriority = function()\n    {\n        return _priority;\n    };\n\n    this.getCursor = function() {\n        return _isDragging ? null : _cursor;\n    };\n\n    this.getCurrentMeasurementRaw = function() {\n        return _currentMeasurement;\n    };\n\n    this.getActivePointIndex = function() {\n        return _activePoint;\n    };\n\n\n    this.startNewMeasurement = function() {\n\n        _currentMeasurement = _measurementsManager.createMeasurement(_measurementType);\n        _currentMeasurement.attachIndicator(_viewer, this, MeasureToolIndicator);\n\n        if (_onIndicatorCreatedCB instanceof Function) {\n            _onIndicatorCreatedCB();\n            _onIndicatorCreatedCB = null;\n        }\n\n        enableMeasurementsTouchEvents(false);\n    };\n\n    this.changeMeasurementType = function(type) {\n        _measurementType = type;\n    };\n\n    this.activate = function()\n    {\n        _active = true;\n        _measurementsManager.init();\n\n        noPicksSet();\n        _isDragging = false;\n        this.isEditingEndpoint = false;\n        this.editByDrag = false;\n\n        _viewer.impl.pauseHighlight(true);\n        _preMeasureIsolatedNodes = _viewer.getIsolatedNodes();\n        _preMeasureHiddenNodes = _viewer.getHiddenNodes();\n\n        _viewer.clearSelection();\n        _viewer.toolController.activateTool(\"snapper\");\n        _viewer.toolController.activateTool(\"magnifyingGlass\");\n \n       this.onMeasurementChangedBinded = this.onMeasurementChanged.bind(this);\n       this.onSwitchMeasurementBinded = this.onSwitchMeasurement.bind(this);\n       this.onRemoveMeasurementBinded = this.onRemoveMeasurement.bind(this);\n       this.getJsonBinded = this.getJson.bind(this);\n       _viewer.addEventListener(MeasureCommon.Events.MEASUREMENT_CHANGED_EVENT, this.onMeasurementChangedBinded);\n       _viewer.addEventListener(av.CAMERA_CHANGE_EVENT, this.onCameraChange);\n       _viewer.addEventListener(av.ISOLATE_EVENT, this.onIsolate);\n       _viewer.addEventListener(\"newData\", this.onSwitchMeasurementBinded);\n       _viewer.addEventListener(\"removeData\", this.onRemoveMeasurementBinded);\n       _viewer.addEventListener(\"getJson\", this.getJsonBinded);\n    };\n\n    this.deactivate = function()\n    {\n        if (!_active)\n            return;\n\n        _active = false;\n\n        while (Object.keys(_measurementsManager.measurementsList).length > 0) {\n            _currentMeasurement = _measurementsManager.measurementsList[Object.keys(_measurementsManager.measurementsList)[0]];\n            _measurementsManager.changeCurrentMeasurement(_currentMeasurement);\n            this.clearCurrentMeasurement();\n            _currentMeasurement = null;\n        }\n\n        if(_snapper && _snapper.isActive()) {\n            _viewer.toolController.deactivateTool(\"snapper\");\n        }\n\n        _viewer.toolController.deactivateTool(\"magnifyingGlass\");\n\n        _viewer.impl.pauseHighlight(false);\n        _preMeasureIsolatedNodes = [];\n        _preMeasureHiddenNodes = [];\n\n        _measurementsManager.destroy();\n        _viewer.removeEventListener(av.CAMERA_CHANGE_EVENT, this.onCameraChange);\n        _viewer.removeEventListener(MeasureCommon.Events.MEASUREMENT_CHANGED_EVENT, this.onMeasurementChangedBinded);\n        _viewer.removeEventListener(av.ISOLATE_EVENT, this.onIsolate);\n    };\n\n    this.update = function()\n    {\n        return false;\n    };\n\n    this.getUnits = function() {\n        return _sharedMeasureConfig.units;\n    };\n\n    this.setUnits = function( units )\n    {\n        if (_sharedMeasureConfig.units !== units ) {\n            _sharedMeasureConfig.units = units;\n\n            for (var key in _measurementsManager.measurementsList) {\n                if (_measurementsManager.measurementsList.hasOwnProperty(key)) {\n                    // Update UI\n                    var measurement = _measurementsManager.measurementsList[key];\n                    if (measurement.indicator) {\n                        measurement.indicator.updateResults();\n                    }\n                }\n            }\n        }\n    };\n\n    this.getPrecision = function() {\n        return _sharedMeasureConfig.precision;\n    };\n\n    this.setPrecision = function( precision ) {\n\n        if (_sharedMeasureConfig.precision !== precision ) {\n            _sharedMeasureConfig.precision = precision;\n\n            for (var key in _measurementsManager.measurementsList) {\n                if (_measurementsManager.measurementsList.hasOwnProperty(key)) {\n                    // Update UI\n                    var measurement = _measurementsManager.measurementsList[key];\n                    if (measurement.indicator) {\n                        measurement.indicator.updateResults();\n                    }\n                }\n            }\n        }\n    };\n\n    this.getDistanceXYZ = function(measurement) {\n        if (!measurement) {\n            measurement = _currentMeasurement;\n        }\n        return this.getDistanceAux(measurement.distanceXYZ);\n    };\n    this.getDistanceX = function(measurement) {\n        if (!measurement) {\n            measurement = _currentMeasurement;\n        }\n        return this.getDistanceAux(measurement.distanceX);\n    };\n    this.getDistanceY = function(measurement) {\n        if (!measurement) {\n            measurement = _currentMeasurement;\n        }\n        return this.getDistanceAux(measurement.distanceY);\n    };\n    this.getDistanceZ = function(measurement) {\n        if (!measurement) {\n            measurement = _currentMeasurement;\n        }\n        return this.getDistanceAux(measurement.distanceZ);\n    };\n\n    /**\n     * @private\n     */\n    this.getDistanceAux = function (measurementDistance) {\n\n        if (_viewer.model) {\n            var d = Autodesk.Viewing.Private.convertUnits(_viewer.model.getUnitString(), _sharedMeasureConfig.units, _sharedMeasureConfig.calibrationFactor, measurementDistance || 0);\n            return Autodesk.Viewing.Private.formatValueWithUnits(d, _sharedMeasureConfig.units, 3, _sharedMeasureConfig.precision);\n        }\n    };\n\n    this.getAngle = function(measurement) {\n\n        if (!measurement) {\n            measurement = _currentMeasurement;\n        }\n        var angle = measurement.angle;\n        return Autodesk.Viewing.Private.formatValueWithUnits(angle, String.fromCharCode(0xb0), 3, _sharedMeasureConfig.precision);\n    };\n\n    this.getArea = function(measurement) { \n\n        if (_viewer.model) {\n\n            if (!measurement) {\n                measurement = _currentMeasurement;\n            }\n\n            var area = Autodesk.Viewing.Private.convertUnits(viewer.model.getUnitString(), _sharedMeasureConfig.units, _sharedMeasureConfig.calibrationFactor, measurement.area, 'square');\n\n            if (_sharedMeasureConfig.units) {\n                return Autodesk.Viewing.Private.formatValueWithUnits(area, _sharedMeasureConfig.units+'^2', 3, _sharedMeasureConfig.precision);\n            }\n            else {\n                return Autodesk.Viewing.Private.formatValueWithUnits(area, null, 3, _sharedMeasureConfig.precision);\n            }\n        }\n    };\n\n    function snapToFirstPick(currentPick, forceSnap) {\n        if (_currentMeasurement.hasPick(1) && _activePoint > 3 && !_currentMeasurement.closedArea) {\n            var firstPick = _currentMeasurement.getPick(1);\n            var firstPickPoint = MeasureCommon.getSnapResultPosition(firstPick, _viewer);\n            var firstPickPosition = MeasureCommon.project(firstPickPoint, viewer);\n            var currentPickPoint = MeasureCommon.getSnapResultPosition(currentPick, _viewer);\n            var currentPickPosition = MeasureCommon.project(currentPickPoint, viewer);\n            \n            if (forceSnap || currentPickPosition.distanceTo(firstPickPosition) < _closeAreaSnapRange) {\n                _snapper.onMouseMove(firstPickPosition);\n                firstPick.copyTo(currentPick);\n            }\n        }\n    }\n\n    function render(showResult) {\n\n        var hasResult = _currentMeasurement.computeResult(_currentMeasurement.picks, _viewer, _snapper);\n\n        _currentMeasurement.indicator.render(_currentMeasurement.picks, _consumeSingleClick || !!showResult);\n\n        return hasResult;\n    }\n\n    /**\n     * TODO: We need to flesh out the return value here.\n     *\n     * @param unitType\n     * @param precision\n     * @returns {Object}\n     */\n    this.getMeasurement = function(unitType, precision) {\n\n        _sharedMeasureConfig.units = unitType || _sharedMeasureConfig.units;\n        _sharedMeasureConfig.precision = precision || _sharedMeasureConfig.precision;\n\n        var geomTypes = ['Vertex', 'Edge', 'Face', 'Circular Arc', 'Curved Edge', 'Curved Face'];\n\n        var measurement = {\n            from: geomTypes[_currentMeasurement.getGeometry(1).type],\n            to: geomTypes[_currentMeasurement.getGeometry(2).type],\n            distance: this.getDistanceXYZ(),\n            deltaX: this.getDistanceX(),\n            deltaY: this.getDistanceY(),\n            deltaZ: this.getDistanceZ(),\n            angle: this.getAngle(),\n            unitType: _sharedMeasureConfig.units,\n            precision: _sharedMeasureConfig.precision\n        };\n\n        return measurement;\n    };\n\n    this.clearCurrentMeasurement = function() {\n        if (_currentMeasurement) {\n            noPicksSet();\n\n            for (var key in _currentMeasurement.picks) {\n                if (_currentMeasurement.picks.hasOwnProperty(key)) {\n                    this.clearPick(key);    \n                }\n            }\n            \n            this.updateViewportId(true);\n\n            if (_isolateMeasure) {\n                this.clearIsolate();    \n            }\n\n            _currentMeasurement.indicator.clear();\n            _currentMeasurement.indicator.destroy();\n            _currentMeasurement = _measurementsManager.removeCurrentMeasurement();\n            _currentMeasurement = null;\n        }\n\n        enableMeasurementsTouchEvents(true);\n    };\n\n    this.clearPick = function(pickNumber) {\n        if (_currentMeasurement && _currentMeasurement.hasPick(pickNumber)) {\n            _currentMeasurement.clearPick(pickNumber);\n            _currentMeasurement.indicator.hideClick(pickNumber);\n        }\n    };\n\n    this.setIsolateMeasure = function(enable) {\n        _isolateMeasure = enable;\n    };\n\n    this.isolateMeasurement = function () {\n        if (_currentMeasurement) {\n            var isolationGroup = [];\n        \n            for (var key in _currentMeasurement.picks) {\n                if (_currentMeasurement.picks.hasOwnProperty(key)) {\n                    isolationGroup.push(_currentMeasurement.getPick(key).snapNode);\n                }\n            }\n            _viewer.removeEventListener(av.ISOLATE_EVENT, this.onIsolate);\n            _viewer.isolate(isolationGroup);\n            _viewer.addEventListener(av.ISOLATE_EVENT, this.onIsolate);\n        }\n    };\n\n    this.clearIsolate = function() {\n        _viewer.removeEventListener(av.ISOLATE_EVENT, this.onIsolate);\n        _viewer.showAll();\n        _viewer.isolate(_preMeasureIsolatedNodes);\n        _viewer.hide(_preMeasureHiddenNodes);\n        _viewer.addEventListener(av.ISOLATE_EVENT, this.onIsolate);\n\n    };\n\n    this.onIsolate = function (event) {\n        // Isolation group is empty. Should enter only when 'Show all objects' is being called.\n        if (!event.nodeIdArray.length) {\n            _preMeasureIsolatedNodes = [];\n            _preMeasureHiddenNodes = [];\n        }\n    };\n\n    this.deselectAllMeasurements = function() {\n        if (_currentMeasurement && !this.areAllPicksSet()) {\n            if (this.isEditingEndpoint) {\n                this.undoEditEndpoint();\n            }\n            else {\n                this.clearCurrentMeasurement();\n            }\n        }\n\n        for (var key in _measurementsManager.measurementsList) {\n            if (_measurementsManager.measurementsList.hasOwnProperty(key)) {\n                var measurement = _measurementsManager.measurementsList[key];\n                if (measurement.indicator) {\n                    measurement.indicator.setSimple(true);        \n                    measurement.indicator.hideEndpoints();\n                    measurement.indicator.unfocusLabels();\n                }\n            }\n        }\n\n        _currentMeasurement = null;\n    };\n\n    this.onMeasurementChanged = function() {\n        \n        this.deselectAllMeasurements();\n\n        _currentMeasurement = _measurementsManager.getCurrentMeasurement();\n        \n        if (_currentMeasurement.isComplete()) {\n            _currentMeasurement.indicator.setSimple(false);        \n            allPicksSet();\n            render(true); \n            this.updateResults();\n        }\n    };\n\n    this.selectMeasurementById = function(measurementId) {\n        if (!_currentMeasurement) {\n            _currentMeasurement = _measurementsManager.selectMeasurementById(measurementId);\n        }\n\n        if (_currentMeasurement.id !== measurementId) {\n            if (!this.areAllPicksSet()) {\n                if (this.isEditingEndpoint) {\n                    this.undoEditEndpoint();\n                }\n                else {\n                    this.clearCurrentMeasurement();\n                }\n            }\n            \n            _currentMeasurement = _measurementsManager.selectMeasurementById(measurementId);\n        }\n    };\n\n    function enableMeasurementsTouchEvents(enable) {\n        for (var key in _measurementsManager.measurementsList) {\n            if (_measurementsManager.measurementsList.hasOwnProperty(key)) {\n                var measurement = _measurementsManager.measurementsList[key];\n                measurement.indicator.changeAllEndpointsEditableStyle(enable);   \n                measurement.indicator.enableSelectionAreas(enable);\n                measurement.indicator.enableLabelsTouchEvents(enable);\n            }\n        }\n    }\n\n    this.editEndpoint = function(event, endpointNumber, measurementId) {\n        if (_currentMeasurement.id === measurementId && _activePoint === endpointNumber) {\n            _currentMeasurement.indicator.changeEndpointOnEditStyle(endpointNumber, false);\n            this.undoEditEndpoint();\n            return;\n        }\n\n        this.selectMeasurementById(measurementId);\n\n        _activePoint = endpointNumber;\n        this.isEditingEndpoint = true;\n\n        _currentMeasurement.indicator.changeEndpointOnEditStyle(endpointNumber, true);\n        enableMeasurementsTouchEvents(false);\n\n        for (var key in _currentMeasurement.picks) {\n            if (_currentMeasurement.picks.hasOwnProperty(key)) {\n                _picksBackup[key] = _currentMeasurement.getPick(key).clone();\n            }\n        }\n\n        this.updateViewportId();\n\n        if (_isolateMeasure) {\n            this.clearIsolate();    \n        }\n\n        if(!av.isMobileDevice()) {\n            this._handleMouseEvent(event);\n        }\n    };\n\n    function canCloseArea() {\n        return _currentMeasurement.countPicks() > 3;\n    }\n\n    this.undoEditEndpoint = function() {\n        _currentMeasurement.indicator.clear();\n\n        for (var key in _currentMeasurement.picks) {\n            if (_currentMeasurement.picks.hasOwnProperty(key)) {\n                _currentMeasurement.setPick(key, _picksBackup[key].clone());\n            }\n        }\n        \n        _currentMeasurement.indicator.changeEndpointOnEditStyle(_activePoint, false);\n        \n        this.isEditingEndpoint = false;\n        this.updateViewportId(true);\n        allPicksSet();\n        render(true);\n    };\n\n    this.updateResults = function() {\n\n        _currentMeasurement.indicator.updateResults();\n        _currentMeasurement.indicator.showEndpoints();\n        _currentMeasurement.indicator.focusLabels();\n\n        if (_isolateMeasure && _currentMeasurement.isComplete()) {\n            this.isolateMeasurement();\n        }\n    };\n\n    this.deleteCurrentMeasurement = function() {\n        this.clearCurrentMeasurement();\n        this.isEditingEndpoint = false;\n        this.editByDrag = false;\n        _isDragging = false;\n    };\n\n    this.deleteCurrentPick = function() {\n\n        var pick = getActivePick();\n        var id = pick.id;\n\n        while (_currentMeasurement.hasPick(id + 1)) {\n            _currentMeasurement.setPick(id, _currentMeasurement.getPick(id + 1));\n            id++;\n        }\n\n        delete _currentMeasurement.picks[id];\n        \n        \n        \n        var count = _currentMeasurement.countPicks();\n        \n        _activePoint--;\n        \n        if (_activePoint <= 0) {\n            _activePoint = count;\n        }\n\n        if (this.isEditingEndpoint) {\n            if (count == 2) {\n                this.deleteCurrentMeasurement();\n                return;\n            }\n\n            _currentMeasurement.indicator.changeAllEndpointsOnEditStyle(false);\n            this.isEditingEndpoint = false;\n            this.updateViewportId(true);\n            allPicksSet();\n            render();\n        } else {\n            this._handleMouseEvent();    \n        }\n    };\n\n    this.updateViewportId = function(clear) {\n        if (_viewer.model && _viewer.model.is2d()) {\n            if (clear || isNoPicksSet()) {\n                _viewer.impl.updateViewportId(0);\n                _snapper.setViewportId(null);\n            }\n            else if (!_isPressing) {\n                var viewport = getPreviousPick().viewportIndex2d || getActivePick().viewportIndex2d;\n                \n                // Pass viewport Id to LineShader to make all other geometries with different viewport transparent\n                _viewer.impl.updateViewportId(viewport);\n                if (_snapper)\n                    _snapper.setViewportId(viewport);  \n            \n            }\n        }\n    };\n\n    this.setNoTopology = function() {\n        if (_currentMeasurement && _currentMeasurement.indicator) {\n            _currentMeasurement.indicator.setNoTopology();\n        }\n        else {\n            _onIndicatorCreatedCB = function() { _currentMeasurement.indicator.setNoTopology(); };\n        }\n    };\n    this.setFetchingTopology = function() {\n        if (_currentMeasurement && _currentMeasurement.indicator) {\n            _currentMeasurement.indicator.setFetchingTopology();\n        }\n        else {\n            _onIndicatorCreatedCB = function() { _currentMeasurement.indicator.setFetchingTopology(); };\n        }\n    };\n    this.setTopologyAvailable = function() {\n        if (_currentMeasurement && _currentMeasurement.indicator) {\n            _currentMeasurement.indicator.setTopologyAvailable();\n        }\n        else {\n            _onIndicatorCreatedCB = function() { _currentMeasurement.indicator.setTopologyAvailable(); };\n        }\n    };\n\n    this.getSnapper = function() {\n        return _snapper;\n    };\n\n    this.correctPickPosition = function() {\n        \n        var active = getActivePick();\n        \n        if (active && !active.getGeometry() && _cursorPosition) {\n            active.geomType = MeasureCommon.SnapType.SNAP_VERTEX;\n            active.geomVertex = _cursorPosition;\n            active.intersectPoint = _cursorPosition;\n        }\n\n        if (hasPreviousPick()) {\n            var passive = getPreviousPick();\n            var corrected = MeasureCommon.correctPerpendicularPicks(passive, active, viewer, _snapper);\n            if (!corrected) {\n\n                // get next pick in case of closed loop measurement.\n                var id = (active.id + 1) % (_currentMeasurement.countPicks() + 1);\n                \n                if (id === 0)\n                    id = 1;\n\n                if (id !== active.id && _currentMeasurement.hasPick(id)) {\n                    var nextPick = _currentMeasurement.getPick(id);   \n                    MeasureCommon.correctPerpendicularPicks(nextPick, active, viewer, _snapper);\n                }\n            }\n            \n            if (_currentMeasurement.measurementType == MeasureCommon.MeasurementTypes.MEASUREMENT_AREA) {\n                snapToFirstPick(active);    \n            }\n        }\n    };\n\n    this._handleMouseEvent = function (event) {\n\n        var valid = false;\n\n        if (_snapper.isSnapped()) {\n            \n            // User picked a new point after two points where already set (or none) - Start a new measurement.\n            if (this.areAllPicksSet() || isNoPicksSet()) {\n                this.startNewMeasurement();\n                \n                if (_isolateMeasure) { \n                    this.clearIsolate();\n                }\n\n                _activePoint = 1;\n            }\n\n            _snapper.copyResults(getActivePick());\n\n            valid = true;\n\n        } \n        else { \n            // In order to draw rubber-band, set the cursor position, so the indicator will use it as active point.\n            if (event && _viewer.model.is2d()) {\n                var viewport = _viewer.container.getBoundingClientRect();\n                var x = event.canvasX || event.clientX - viewport.left;\n                var y = event.canvasY || event.clientY - viewport.top;\n\n                if (x && y) {\n                    _cursorPosition = MeasureCommon.inverseProject({ x:x, y:y }, _viewer);\n                }\n            }\n\n            // In case a measurement is set, and the user clicks on a blank spot - don't do nothing.\n            if (_consumeSingleClick && _currentMeasurement && !this.isEditingEndpoint) {\n                if (_activePoint === _currentMeasurement.getMaxNumberOfPicks() + 1) {\n                    return true;\n                }\n            }\n\n            var lastPick = getActivePick();\n            if (lastPick) {\n                lastPick.clear();\n            }\n        }\n\n        if (_currentMeasurement) {\n            this.correctPickPosition();\n            \n            if (_consumeSingleClick) {\n                this._doConsumeSingleClick();\n            }\n\n            if (!isNoPicksSet()) {\n                var renderSucceeded = render();\n                \n                // If it's the first pick, we don't expect the render of the rubberband to be succeeded.\n                // So enter here only if it's not the first pick.\n                if (_currentMeasurement.hasPick(2)) {\n                    valid &= renderSucceeded;\n                }\n            }\n        }\n\n        // If valid is false, the last pick is not revelant, and will clear it in case of a click.\n        return valid;\n    };\n\n    this._doConsumeSingleClick = function() {\n        // In case the measurement is a closed loop, eliminate the last pick.\n        if (_currentMeasurement.measurementType === MeasureCommon.MeasurementTypes.MEASUREMENT_AREA && !_currentMeasurement.closedArea) {\n            var length = _currentMeasurement.countPicks();\n            var firstPick = _currentMeasurement.getPick(1);\n            var lastPick = _currentMeasurement.getPick(length);\n\n            if (length >= 3 && _currentMeasurement.hasEqualPicks(firstPick, lastPick)) {\n                lastPick.clear();\n                delete _currentMeasurement.picks[length];\n                _currentMeasurement.closedArea = true;\n            }\n        }\n\n        this.updateResults();\n\n        var measurementComplete = _currentMeasurement.isComplete();\n        this.updateViewportId(measurementComplete);\n    };\n\n\n    this.handleButtonDown = function (event, button) {\n        if (av.isMobileDevice()) \n            return false;\n\n        _isDragging = true;\n        if (button === 0 && !event.ctrlKey && !event.metaKey && !event.shiftKey && !event.altKey) {\n            _consumeSingleClick = true;\n            _downX = event.canvasX;\n            _downY = event.canvasY;\n        }\n        return false;\n    };\n\n    this.handleMouseMove = function (event) {\n\n        if (av.isMobileDevice())\n            return false;\n\n        if (event.canvasX !== _downX || event.canvasY !== _downY) {\n            _consumeSingleClick = false;    \n        } \n\n        _endpointMoved = this.isEditingEndpoint;\n\n        if (!isNoPicksSet() && !this.areAllPicksSet()) {\n            this.clearPick(_activePoint);\n            this._handleMouseEvent(event);\n        }\n\n        _snapper.indicator.render();\n\n        return false;\n    };\n\n    this.restoreMouseListeners = function () {\n\n        // When a press event has happend, the default behavior of firefly.js is to disable other mouse events,\n        // So they won't be triggered as well.\n        // The solution is to enable them after the end of the pressing.\n\n        _viewer.toolController.getTool(\"gestures\").controller.enableMouseButtons(true);\n    };\n\n    this.handlePressHold = function (event) {\n        _consumeSingleClick = false;\n\n        if (av.isTouchDevice()) {\n            switch( event.type )\n            {\n                case \"press\":\n                    _isPressing = true;\n\n                    if (this.areAllPicksSet() || isNoPicksSet()) {\n                        this.startNewMeasurement();\n\n                        if (_isolateMeasure) { \n                            this.clearIsolate();\n                        }\n\n                        _activePoint = 1;\n                    }\n\n                    this._handleMouseEvent(event);\n                    _snapper.indicator.render();\n\n                    return true;\n\n                case \"pressup\":\n                    _consumeSingleClick = true;\n                    this.restoreMouseListeners();\n                    _singleClickHandled = !_singleClickHandled;\n                    this.handleSingleClick(event);\n                    _isPressing = false;\n                    return true;\n            }\n        }\n        return false;\n\n    };\n\n\n\n    this.handleGesture = function( event )\n    {   \n        if (av.isTouchDevice()){\n            \n            _consumeSingleClick = false;\n        \n            if (_isPressing) {\n                \n                this.clearPick(_activePoint);\n\n                switch( event.type )\n                {\n                    case \"dragstart\":\n                        this._handleMouseEvent(event);\n                        _snapper.indicator.render();\n\n                        return true;\n\n                    case \"dragmove\":\n                        this._handleMouseEvent(event);\n                        _snapper.indicator.render();\n\n                        return true;\n\n                    case \"dragend\":\n                        _isPressing = false;\n                        _consumeSingleClick = true;\n\n                        if (!this.editByDrag) {\n                            _singleClickHandled = !_singleClickHandled;\n                            this.handleSingleClick(event);    \n                        }\n\n                        this.editByDrag = false;\n                        this.restoreMouseListeners();\n                        return true;\n\n                    case \"pinchstart\":\n                        this._handleMouseEvent(event);\n                        _snapper.indicator.render();\n\n                        break;\n\n                    case \"pinchmove\":\n                        this._handleMouseEvent(event);\n                        _snapper.indicator.render();\n\n                        break;\n\n                    case \"pinchend\":\n                        _consumeSingleClick = true;\n                        _singleClickHandled = !_singleClickHandled;\n                        this.handleSingleClick(event);\n                        this.restoreMouseListeners();\n                        return true;\n                }\n            }\n\n            if (event.type.indexOf('pinch') !== -1) {\n                for (var key in _measurementsManager.measurementsList) {\n                    if (_measurementsManager.measurementsList.hasOwnProperty(key)) {\n                        var measurement = _measurementsManager.measurementsList[key];\n                        measurement.indicator.updateScale();    \n                    }\n                }\n            }\n        }\n\n        return false;\n    };\n\n    this.handleButtonUp = function (event, button) {\n        _isDragging = false;\n        _downX = null;\n        _downY = null;\n        \n        if (_endpointMoved) {\n            _consumeSingleClick = true;\n            _singleClickHandled = !_singleClickHandled;\n            this.handleSingleClick(event);\n            _endpointMoved = false;\n        }\n\n        return false;\n    };\n\n    this.handleSingleClick = function (event, button) {\n        if (_consumeSingleClick) {\n\n            _snapper.indicator.clearOverlays();\n\n            if (_currentMeasurement) {\n                _currentMeasurement.indicator.changeEndpointOnEditStyle(_activePoint, false);    \n            }\n\n            if (this._handleMouseEvent(event)) {\n                this.updateResults();\n                _activePoint++;\n            }\n            else {\n                if (this.isEditingEndpoint) {\n                    this.undoEditEndpoint();\n                }\n                else {\n                    if (_currentMeasurement && _currentMeasurement.measurementType === MeasureCommon.MeasurementTypes.MEASUREMENT_AREA && canCloseArea()) {\n                        snapToFirstPick(getActivePick(), true);\n                        this._handleMouseEvent();\n                    } else {\n                        this.clearCurrentMeasurement();    \n                    }\n                }\n            }\n\n            if (_currentMeasurement && _currentMeasurement.isComplete()) {\n                allPicksSet();\n            }\n\n            _consumeSingleClick = false;\n            _singleClickHandled = !_singleClickHandled;\n            this.isEditingEndpoint = false;\n\n            _snapper.clearSnapped();\n        }\n        return true;\n    };\n\n    this.handleDoubleClick = function(event) {\n        return true;\n    };\n\n    this.onCameraChange = function () {\n        for (var key in _measurementsManager.measurementsList) {\n            if (_measurementsManager.measurementsList.hasOwnProperty(key)) {\n                var measurement = _measurementsManager.measurementsList[key];\n                measurement.indicator.updateScale();\n            }\n        }\n\n        _snapper.indicator.onCameraChange();\n    };\n\n    this.handleSingleTap = function (event) {\n        if (!_singleClickHandled) {\n            _consumeSingleClick = true;\n            _snapper.onMouseDown({x: event.canvasX, y:event.canvasY});\n            this.handleSingleClick(event);\n        }\n        _singleClickHandled = !_singleClickHandled;\n\n        return true;\n    };\n\n    this.handleDoubleTap = function(event) {\n        if (_currentMeasurement && _currentMeasurement.measurementType === MeasureCommon.MeasurementTypes.MEASUREMENT_AREA && _currentMeasurement.countPicks() > 2) {\n            // fake single click over the first handle, to close the area.\n            var firstPick = _currentMeasurement.getPick(1);\n            var firstPickPoint = MeasureCommon.getSnapResultPosition(firstPick, _viewer);\n            var firstPickPosition = MeasureCommon.project(firstPickPoint, viewer);\n            event.canvasX = firstPickPosition.x;\n            event.canvasY = firstPickPosition.y;\n            _consumeSingleClick = true;\n            _snapper.onMouseDown(firstPickPosition);\n            this.handleSingleClick(event);\n            _singleClickHandled = !_singleClickHandled;\n        }\n\n        return true;\n    };\n\n    this.handleResize = function() {\n        for (var key in _measurementsManager.measurementsList) {\n            if (_measurementsManager.measurementsList.hasOwnProperty(key)) {\n                var measurement = _measurementsManager.measurementsList[key];\n                if (measurement.indicator) {\n                    measurement.indicator.handleResize();\n                }\n            }\n        }\n    };\n\n    this.handleKeyDown = function(event, keyCode) {\n        switch (keyCode) {\n            case Autodesk.Viewing.KeyCode.BACKSPACE:\n            case Autodesk.Viewing.KeyCode.DELETE:\n            if (_currentMeasurement && _currentMeasurement.measurementType === MeasureCommon.MeasurementTypes.MEASUREMENT_AREA && !this.areAllPicksSet()) {\n                if (_currentMeasurement.countPicks() > 2 ) {\n                    this.deleteCurrentPick();\n                } else {\n                    this.deleteCurrentMeasurement();    \n                }\n            } else {\n                this.deleteCurrentMeasurement();\n            }\n\n            return true;\n        }\n\n        return false;\n    };\n\n    this.getJson = function() {\n        // remove all indicator objects to avoid circular reference\n        // const list = _measurementsManager.measurementsList;\n        // Object.keys(list).map(i=>{ delete(list[i].indicator) });\n        // var tmp = JSON.stringify(list);\n        // Object.keys(list).map(i=>{ list[i].attachIndicator(_viewer, this, avem.MeasureToolIndicator) })\n        // return tmp;\n\n        const e = _measurementsManager.measurementsList, t = Object.keys(e).map(t => ({...e[t], indicator: void 0}));\n        return JSON.stringify(t)\n    }\n    \n\n    // de-serializes JSON into Area-Measurement objects\n    this.loadJson = function(json) {\n        for (var key in json) \n            this.addMeasurement(json[key])\n    }\n    \n    \n    \n    this.addPick = function(inp) {\n        var json = JSON.parse(JSON.stringify(inp));\n        // i = y.setPick(t.id, y.getPick(1).clone());\n        var p = _currentMeasurement.setPick(json.id, _currentMeasurement.getPick(1).clone())\n        Object.assign(p, {\n            geomType:json.geomType,\n            fromTopology:false,\n            viewportIndex2d:json.viewportIndex2d,\n            geomVertex: new THREE.Vector3(json.geomVertex.x,json.geomVertex.y,json.geomVertex.z),\n            intersectPoint: new THREE.Vector3(json.intersectPoint.x,json.intersectPoint.y,json.intersectPoint.z),\n            radius:json.radius\n        });\n    }\n\n    this.addMeasurement = function(json) {\n\n        // for (var t in (y = w.createMeasurement(e.measurementType)).MarkupID = e.id, e.picks) e.picks[t] ? this.addPick(e.picks[t]) : delete e.picks[t];\n        // y.closedArea = !0, m = Object.keys(e.picks).length + 1, y.attachIndicator(a, this, u), this.onMeasurementChanged()\n\n        _currentMeasurement = _measurementsManager.createMeasurement(json.measurementType);\n        _currentMeasurement.MarkupID = json.id;\n        for (var key in json.picks) {\n            if (!json.picks[key])\n                delete(json.picks[key])\n            else\n                this.addPick(json.picks[key])\n        }\n        _currentMeasurement.closedArea = true;\n        _activePoint = Object.keys(json.picks).length+1;\n        //clean up non object arrays\n        \n        _currentMeasurement.attachIndicator(_viewer, this, MeasureToolIndicator);\n        this.onMeasurementChanged();\n    }\n\n    this.onSwitchMeasurement = function(e) {\n        this.loadJson(e.detail);\n    }\n\n    this.onRemoveMeasurement = function(e) {\n        var MarkupID = e.detail;\n        //var item = _measurementsManager.measurementsList.filter(i=>{return i.MarkupID=MarkupID});\n        var item = _measurementsManager.measurementsList[Object.keys(_measurementsManager.measurementsList).filter(i=>{return _measurementsManager.measurementsList[i].MarkupID==MarkupID})];\n        console.log('removing MarkupID / itemid',MarkupID, item.id);\n        this.selectMeasurementById(item.id);\n        this.clearCurrentMeasurement();        \n    }\n};\n\n","import { Indicator } from './Indicator'\n\n    var av = Autodesk.Viewing;\n    var MeasureCommon = Autodesk.Viewing.MeasureCommon;\n\n    // /** @constructor */\n    export function CalibrationToolIndicator(viewer, measurement, calibrationTool)\n    {\n        Indicator.call(this, viewer, measurement, calibrationTool);\n        this.calibrationTool = calibrationTool;\n        this.calibrationLabel = null;\n        this.endpoints = null;\n        this.tmpVector = new THREE.Vector3();\n        this.p1 = null;\n        this.p2 = null;\n\n        this.rubberbandDefaultMaterial = new THREE.MeshBasicMaterial({\n            color: 0xe8b22c,\n            opacity: 1,\n            transparent: false,\n            depthTest: false,\n            depthWrite: false,\n            side: THREE.DoubleSide\n        });\n\n        this.rubberbandSnappedMaterial = new THREE.MeshBasicMaterial({\n            color: 0x005BCE,\n            opacity: 1,\n            transparent: false,\n            depthTest: false,\n            depthWrite: false,\n            side: THREE.DoubleSide\n        });\n\n        this.rubberbandTipMaterial = new THREE.MeshBasicMaterial({\n            color: 0x000000,\n            opacity: 1,\n            transparent: false,\n            depthTest: false,\n            depthWrite: false,\n            side: THREE.DoubleSide\n        });\n\n    }\n\n    CalibrationToolIndicator.prototype = Object.create(Indicator.prototype);\n    CalibrationToolIndicator.prototype.constructor = CalibrationToolIndicator;\n    var proto = CalibrationToolIndicator.prototype;\n    \n    var kEndpointOffset = 15;\n    \n    var kCrossWidth = 1.5;\n    var kTipXWidth = 2;\n    var kLineWidth = 3;\n\n    var kTipXLength = 3;\n    var kCrossLength = 5;\n\n    var kDashSize = 2;\n    var kGapSize = 1;\n\n    proto.createEndpoint = function(name) {\n        this.endpoints[name] = {};\n        this.endpoints[name].position = null;\n\n        var label = this.endpoints[name].label = document.createElement('div');\n        label.className = 'calibration-endpoint';\n\n        this.viewer.container.appendChild(label);\n\n        var text = document.createElement('div');\n        text.className = 'calibration-endpoint-text';\n        text.textContent = name.toString();\n        label.appendChild(text);\n        \n        if (av.isTouchDevice()) {\n            this.initLabelMobileGestures(label, name, this.calibrationTool);\n        }\n        // Disable hover for mobile devices\n        if(!av.isMobileDevice()) {\n            MeasureCommon.safeToggle(label, 'enable-hover', true);\n\n            this.initMouseEvent(label, name);\n    \n            label.addEventListener('mousewheel', this.viewer.toolController.mousewheel);\n            \n        }   \n    };\n\n    proto.init = function() {\n\n        MeasureCommon.createCommonOverlay(this.viewer, this.overlayName);\n        \n        if (!this.calibrationLabel) {\n            this.calibrationLabel = document.createElement('div');\n            this.calibrationLabel.className = 'calibration-label';\n            this.hideLabel(this.calibrationLabel);\n            this.viewer.container.appendChild(this.calibrationLabel);\n            this.calibrationLabel.addEventListener('mousewheel', this.viewer.toolController.mousewheel);\n\n            var text = document.createElement('div');\n            text.className = 'calibration-label-text';\n            this.calibrationLabel.appendChild(text);\n        }\n\n        this.endpoints = [];\n\n        this.handleButtonUpBinded = this.calibrationTool.handleButtonUp.bind(this.calibrationTool);\n        window.addEventListener('mouseup', this.handleButtonUpBinded);\n\n        this.onCameraChangeBinded = this.onCameraChange.bind(this);\n        this.viewer.addEventListener(av.CAMERA_CHANGE_EVENT, this.onCameraChangeBinded);\n    };\n\n    proto.destroy = function() {\n        this.clear();\n\n        Indicator.prototype.destroy.call(this);\n\n        if (this.calibrationLabel) {\n            this.calibrationLabel.removeEventListener('mousewheel', this.viewer.toolController.mousewheel);\n            this.viewer.container.removeChild(this.calibrationLabel);\n            this.calibrationLabel = null;\n        }\n\n        \n        this.viewer.impl.clearOverlay(this.overlayName);\n        this.viewer.impl.removeOverlayScene(this.overlayName);\n        \n        window.removeEventListener('mouseup', this.handleButtonUpBinded);\n        this.viewer.removeEventListener(av.CAMERA_CHANGE_EVENT, this.onCameraChangeBinded);\n    };\n\n    proto.clearRubberband = function() {\n        this.viewer.impl.clearOverlay(this.overlayName);\n    };\n\n    proto.clear = function() {\n\n        this.clearRubberband();\n        \n        this.hideLabel(this.calibrationLabel);\n        \n        for (var name in this.endpoints) {\n            if (this.endpoints.hasOwnProperty(name)) {\n                this.hideClick(name);\n                this.endpoints[name].position = null;\n            }\n        }\n    };\n\n    proto.updateLabelValue = function(text) {\n        if (!text || text === \"\") {\n            this.calibrationLabel.childNodes[0].textContent = null;\n            this.hideLabel(this.calibrationLabel);\n        }\n        else {\n            this.calibrationLabel.childNodes[0].setAttribute(\"data-i18n\", text);\n            this.calibrationLabel.childNodes[0].textContent = av.i18n.translate(text);\n            this.showLabel(this.calibrationLabel);\n            this.calibrationTool.render();\n        }\n    };\n\n    proto.changeLabelClickableMode = function(clickable) {\n        if (clickable) {\n            this.calibrationLabel.childNodes[0].style.pointerEvents='all';\n        }\n        else {\n            this.calibrationLabel.childNodes[0].style.pointerEvents='none';\n        }\n    };\n\n    proto.showAddCalibrationLabel = function() {\n        var self = this;\n        this.updateLabelValue(\"Add Calibration\");\n        this.changeLabelClickableMode(true);\n        this.calibrationTool.render();\n        \n        this.calibrationLabel.addEventListener(\"click\", function onClick() {\n            self.calibrationLabel.childNodes[0].style.pointerEvents = 'none';\n            self.calibrationTool.render();\n            self.updateLabelValue(null);\n            self.calibrationTool.showPanel();\n            self.calibrationLabel.removeEventListener(\"click\", onClick);\n        });    \n    };\n\n    proto.updateLabelsPosition = function() {\n        for (var i = 1; i <= Object.keys(this.endpoints).length; i++) {\n            if (this.endpoints[i].position) {\n                var label = this.endpoints[i].label;\n                var pos = MeasureCommon.project(this.endpoints[i].position, this.viewer, kEndpointOffset);\n                label.style.left = (pos.x - parseInt(label.clientWidth) / 2) + 'px';\n                label.style.top = (pos.y - parseInt(label.clientHeight) / 2) + 'px';\n                label.point = this.endpoints[i].position;\n\n                // Detect and move in case of overlapping.\n                this.labelsOverlapDetection(this.endpoints[i].label, this.endpoints);\n            }\n        }\n\n        this.hideLabelsOutsideOfView();\n    };\n\n    function isLeftIntersect(current, other) {\n        return current.right >= other.left && current.right <= other.right;\n    }\n\n    function isRightIntersect(current, other) {\n        return current.left >= other.left && current.left <= other.right;\n    }\n\n    function isMiddleIntersect(current, other) {\n        return current.left <= other.left && current.right >= other.right;\n    }\n\n    function isVerticalIntersect(current, other) {\n        return current.top < other.bottom && current.bottom > other.top;\n    }\n\n    function moveLeft(currentLabel, currentRect, otherRect) {\n        currentLabel.style.left = parseInt(currentLabel.style.left, 10) - (currentRect.right - otherRect.left) + 'px';\n    }\n\n    function moveRight(currentLabel, currentRect, otherRect) {\n        currentLabel.style.left = parseInt(currentLabel.style.left, 10) + (otherRect.right - currentRect.left) + 'px';\n    }\n\n    function moveDown(currentLabel, currentRect, otherRect) {\n        currentLabel.style.top = parseInt(currentLabel.style.top, 10) + (otherRect.bottom - currentRect.top) + 'px';\n    }\n\n\n    proto.labelsOverlapDetection = function(staticLabel, labelsList) {\n\n        for (var i = 1; i <= Object.keys(labelsList).length ; i++) {\n\n            var dynamicLabel = labelsList[i].label;\n\n            if (staticLabel !== dynamicLabel) {\n                var staticRect = staticLabel.getBoundingClientRect();\n                var dynamicRect = dynamicLabel.getBoundingClientRect();\n\n                if (isVerticalIntersect(dynamicRect, staticRect)) {\n\n                    if (isLeftIntersect(dynamicRect, staticRect)) {\n                        moveLeft(dynamicLabel, dynamicRect, staticRect);\n                    }\n                    else if (isRightIntersect(dynamicRect, staticRect)) {\n                        moveRight(dynamicLabel, dynamicRect, staticRect);\n                    }\n                    else if (isMiddleIntersect(dynamicRect, staticRect)) {\n                        moveDown(dynamicLabel, dynamicRect, staticRect);\n                    }\n                }\n            }\n        }\n    };\n\n    proto.renderCalibrationLabel = function() {\n\n        if (this.showMeasureResult && this.calibrationLabel && this.p1 && this.p2) {\n            \n            var point = { x: (this.p1.x + this.p2.x)/2, y: (this.p1.y + this.p2.y)/2, z: (this.p1.z + this.p2.z)/2 };\n            var mid = MeasureCommon.project(point, this.viewer);\n\n            this.labelPosition = new THREE.Vector2(mid.x, mid.y);\n\n            if (this.calibrationLabel.childNodes[0].textContent) {\n                this.showLabel(this.calibrationLabel);\n            }\n\n            this.calibrationLabel.style.top  = this.labelPosition.y - Math.floor(this.calibrationLabel.clientHeight / 2) + 'px';\n            this.calibrationLabel.style.left = this.labelPosition.x - Math.floor(this.calibrationLabel.clientWidth / 2) + 'px' ;\n            this.calibrationLabel.point = point;\n\n            if (this.viewer.model.is2d()) {\n                this.alignLabelWithLine(this.calibrationLabel, this.p1, this.p2, this.calibrationLabel.clientHeight, this.viewer);\n            }\n        }\n    };\n\n    proto.drawMeasurementLineTip = function(point, direction, normal, flip) {\n\n        var tmpVec = new THREE.Vector3();\n        var geometry = new THREE.Geometry();\n        var p1Scale = this.setScale(point);\n\n        flip = flip ? -1 : 1;\n\n        var tipMaterial = (this.snapper.isSnapped() && !this.showMeasureResult) ? this.rubberbandSnappedMaterial : this.rubberbandTipMaterial;\n\n        // black tip\n        tmpVec.addVectors(point, normal.clone().multiplyScalar(kCrossLength * p1Scale));\n        geometry.vertices[0] = tmpVec.clone();\n        tmpVec.subVectors(point, normal.clone().multiplyScalar(kCrossLength * p1Scale));\n        geometry.vertices[1] = tmpVec.clone();\n        this.drawLineAsCylinder(geometry, tipMaterial, kCrossWidth, this.overlayName);\n\n        geometry.vertices[0] = point;\n        tmpVec.subVectors(point, direction.clone().multiplyScalar(kCrossLength * p1Scale * flip));\n        geometry.vertices[1] = tmpVec.clone();\n        this.drawLineAsCylinder(geometry, tipMaterial, kCrossWidth, this.overlayName);\n\n        // yellow tip\n        tmpVec.addVectors(point, normal.clone().multiplyScalar(kTipXLength * p1Scale));\n        geometry.vertices[0] = tmpVec.clone();\n        tmpVec.subVectors(point, normal.clone().multiplyScalar(kTipXLength * p1Scale));\n        geometry.vertices[1] = tmpVec.clone();\n        this.drawLineAsCylinder(geometry, this.rubberbandDefaultMaterial, kTipXWidth, this.overlayName);\n\n        tmpVec.addVectors(point, normal.clone().multiplyScalar(kTipXLength * p1Scale));\n        tmpVec.addVectors(tmpVec, direction.clone().multiplyScalar(kTipXLength * p1Scale));\n        geometry.vertices[0] = tmpVec.clone();\n        tmpVec.subVectors(point, normal.clone().multiplyScalar(kTipXLength * p1Scale));\n        tmpVec.subVectors(tmpVec, direction.clone().multiplyScalar(kTipXLength * p1Scale));\n        geometry.vertices[1] = tmpVec.clone();\n        this.drawLineAsCylinder(geometry, this.rubberbandDefaultMaterial, kTipXWidth, this.overlayName);\n    };\n\n    proto.renderDistanceMeasurement = function(p1, p2) {\n\n        this.viewer.impl.clearOverlay(this.overlayName);\n\n        if (!p1 || !p2)\n            return;\n\n        var geometry = new THREE.Geometry();\n        var lineDirection = new THREE.Vector3().subVectors(p2, p1).normalize();\n        var lineNormal = lineDirection.clone().cross(this.viewer.navigation.getEyeVector()).normalize();\n        var p1Scale = this.setScale(p1);\n        \n        var dashSize = kDashSize * p1Scale;\n        var gapSize = kGapSize * p1Scale;\n\n        // Main line\n        \n        var lineMaterial = ((Math.abs(p1.x - p2.x) <= 0.1 || Math.abs(p1.y - p2.y) <= 0.1 \n                            || this.snapper.getSnapResult().isPerpendicular) && !this.showMeasureResult) \n                            ? this.rubberbandSnappedMaterial : this.rubberbandDefaultMaterial;\n\n        if (this.showMeasureResult) {\n            // Single solid line.\n            geometry.vertices[0] = p1;\n            geometry.vertices[1] = p2;\n            this.drawLineAsCylinder(geometry, lineMaterial, kLineWidth, this.overlayName);\n        }\n        else {\n            this.drawDashedLine(p1, p2, dashSize, gapSize, lineMaterial, kLineWidth, this.overlayName); \n        }\n        \n        this.drawMeasurementLineTip(p1, lineDirection, lineNormal, false);\n        \n        if (this.showMeasureResult) {\n            this.drawMeasurementLineTip(p2, lineDirection, lineNormal, true);\n        }\n\n        this.p1 = p1;\n        this.p2 = p2;\n\n        this.renderCalibrationLabel();\n    };\n\n    proto.onCameraChange = function() {\n        if (this.measurement.isComplete()) {\n            this.renderDistanceMeasurement(this.p1, this.p2);\n        }   \n        this.updateLabelsPosition();         \n    };\n\n","\n\n    \"use strict\";\n\n    var av = Autodesk.Viewing,\n        ave = Autodesk.Viewing.Extensions,\n        avp = Autodesk.Viewing.Private,\n        avu = Autodesk.Viewing.UI,\n        MeasureCommon = Autodesk.Viewing.MeasureCommon;\n\n    //\n    // /** @constructor */\n    //\n    //\n    export var CalibrationPanel = function(calibrationTool, viewer, id, title, options)\n    {\n        var self = this;\n\n        options = options || {};\n        options.addFooter = false;\n\n        avu.DockingPanel.call(this, viewer.container, id, title, options);\n\n        this.viewer = viewer;\n        this.calibrationTool = calibrationTool;\n        this.parentContainer = viewer.container;\n        this.container.style.left = '0px';\n        this.container.style.top = '0px';\n        this.container.style.resize = 'none';\n\n        this.container.classList.add('calibration-panel');\n\n        this.addEventListener( this.closer, \"click\", function(e) {\n            self.setVisible(false);\n            self.calibrationTool.clearSize();\n            self.calibrationTool.showAddCalibrationLabel();\n        });\n\n        if (!options.heightAdjustment)\n            options.heightAdjustment = 40;\n        if (!options.marginTop)\n            options.marginTop = 0;\n        options.left = false;\n\n        this.createScrollContainer(options);\n\n        this.calibrationMenu = document.createElement(\"div\");\n\n        this.scrollContainer.appendChild( this.calibrationMenu );\n\n        // Table\n        this.table = document.createElement(\"table\");\n        this.table.className = \"adsk-lmv-tftable calibration-table\";\n        this.tbody = document.createElement(\"tbody\");\n        this.table.appendChild(this.tbody);\n        this.calibrationMenu.appendChild(this.table);\n\n        // Define Size Row\n        this.row = this.tbody.insertRow(0);\n        this.requestedSizeTextbox = document.createElement('input');\n        this.requestedSizeTextbox.className = 'docking-panel-textbox';\n        this.requestedSizeTextbox.type = 'text';\n        this.requestedSizeTextbox.autofocus= 'true';\n\n        this.addEventListener(this.requestedSizeTextbox, \"keyup\", function(e) {\n            var value = self.requestedSizeTextbox.value;\n            if (value !== \"\" && value.split(\".\")[0] === \"\") {\n                self.requestedSizeTextbox.value = \"0\" + value;\n            }\n            self.updateLabel();\n        });\n\n\n        this.addEventListener(this.requestedSizeTextbox, \"keypress\", function(e) {\n            var key = e.key || String.fromCharCode(e.keyCode);\n            // Handling backspace and arrows for firefox\n            if (key == \"Backspace\" || key == \"ArrowLeft\" || key == \"ArrowRight\"){\n                return;\n            }\n\n            // Escape (For IE11)\n            if (e.keyCode == av.KeyCode.ESCAPE) {\n                self.setVisible(false);\n                self.calibrationTool.clearSize();\n                self.calibrationTool.showAddCalibrationLabel();\n                return;\n            }\n\n            var requestedSize = self.requestedSizeTextbox.value;\n            var cursorIndex = self.requestedSizeTextbox.selectionStart;\n            requestedSize = [requestedSize.slice(0, cursorIndex), key, requestedSize.slice(cursorIndex)].join('');\n            \n            if (requestedSize == \".\") {\n                return;\n            }\n\n            var isSimple = self.units[self.unitList.selectedIndex].simpleInput;\n        \n            if (!isPositiveNumber(requestedSize) || (isSimple && (!isSimpleDecimal(requestedSize) || Autodesk.Viewing.Private.calculatePrecision(requestedSize) > self.calibrationTool.getMaxPrecision()))) {\n                 e.preventDefault();\n            }\n        });\n\n        var caption = \"Define Size\";\n        var cell = this.row.insertCell(0);\n        this.caption = document.createElement(\"div\");\n        this.caption.setAttribute(\"data-i18n\", caption);\n        this.caption.textContent = av.i18n.translate(caption);\n        cell.appendChild(this.caption);\n\n        cell = this.row.insertCell(1);\n        cell.appendChild(this.requestedSizeTextbox);\n\n        // Unit Type Row\n        this.units = [\n            { name: 'Feet and fractional inches', units: 'ft-and-fractional-in', matches: ['ft-and-fractional-in'], simpleInput: false },\n            { name: 'Feet and decimal inches', units: 'ft-and-decimal-in', matches: ['ft-and-decimal-in'], simpleInput: false },\n            { name: 'Meters', units: 'm', matches: ['m'], simpleInput: true },\n            { name: 'Centimeters', units: 'cm', matches: ['cm'], simpleInput: true },\n            { name: 'Millimeters', units: 'mm', matches: ['mm'], simpleInput: true }\n        ];\n\n        var unitNames = [];\n        for (var i = 0; i < this.units.length; ++i) {\n            unitNames.push(this.units[i].name);\n        }\n        this.unitList = new avp.OptionDropDown(\"Unit type\", this.tbody, unitNames, 0, null, { paddingLeft: 0, paddingRight: 15 });\n        this.addEventListener(this.unitList, \"change\", function(e) {\n            self.updateLabel();\n        });\n\n        // Set Calibration button\n        var setCalibration = document.createElement('div');\n        setCalibration.classList.add('docking-panel-primary-button');\n        setCalibration.classList.add('calibration-button');\n\n        setCalibration.setAttribute(\"data-i18n\", \"Set Calibration\");\n        setCalibration.textContent = av.i18n.translate(\"Set Calibration\");\n\n        setCalibration.addEventListener('click', function () {\n            var index = self.unitList.selectedIndex;\n            var requestedUnits = self.units[index].units;\n            self.calibrationTool.calibrate(requestedUnits, self.requestedSizeTextbox.value);\n        }, false);\n\n        this.calibrationMenu.appendChild(setCalibration);\n        \n\n    }; // end constructor\n\n    var isPositiveNumber = function (n) {\n        // The first character of the string has to be a digit.\n        return n.match(/^(\\d+)/);\n    };\n\n    var isSimpleDecimal = function (n) {\n        // Add \"0\" to the end of the string, to check if there are trailing spaces.\n        n += '0';\n        return !isNaN(parseFloat(n)) && !isNaN(+n) && parseFloat(n) >= 0;\n    };\n\n    CalibrationPanel.prototype = Object.create(avu.DockingPanel.prototype);\n    ave.ViewerPanelMixin.call(CalibrationPanel.prototype);\n\n\n    CalibrationPanel.prototype.uninitialize = function uninitialize() {\n        this.viewer = null;\n        avu.DockingPanel.prototype.uninitialize.call(this);\n    };\n\n    CalibrationPanel.prototype.findUnits = function findUnits() {\n        var i,\n            j,\n            selectedUnits = this.calibrationTool.getCurrentUnits();\n        for (i = 0; i < this.units.length; ++i) {\n            var matches = this.units[i].matches;\n            if (matches) {\n                for (j = 0; j < matches.length; ++j) {\n                    if (matches[j] === selectedUnits) {\n                        return i;\n                    }\n                }\n            }\n        }\n        return 0;\n    };\n\n    CalibrationPanel.prototype.setPanelValue = function(size) {\n        this.unitList.setSelectedIndex(this.findUnits());\n        this.requestedSizeTextbox.value = size;\n    };\n\n    CalibrationPanel.prototype.updateLabel = function() {\n        var index = this.unitList.selectedIndex;\n        var requestedUnits = this.units[index].units;\n        var size = this.requestedSizeTextbox.value;\n        var parsedNumber = Autodesk.Viewing.Private.UnitParser.parsePositiveNumber(size, requestedUnits);\n        var text = Autodesk.Viewing.Private.formatValueWithUnits(parsedNumber, requestedUnits, 3, Autodesk.Viewing.Private.calculatePrecision(size));\n\n        if (size === \"\") {\n            this.calibrationTool.updateLabelValue(null);\n        } else if (!isNaN(parsedNumber)) {\n            this.calibrationTool.updateLabelValue(text);\n        }\n    };\n\n    CalibrationPanel.prototype.updatePanelPosition = function (labelPosition, p1, p2, labelOffset) {\n\n        var width = parseInt(this.container.getBoundingClientRect().width);\n        var height = parseInt(this.container.getBoundingClientRect().height);\n\n        var cornerX;\n        var cornerY;\n\n        if (!labelPosition || !p1 || !p2) {\n            cornerX = Math.floor((this.viewer.canvas.clientWidth - width) / 2);\n            cornerY = Math.floor((this.viewer.canvas.clientHeight - height) / 2);\n        }\n        else {\n            p1 = MeasureCommon.project(p1, this.viewer);\n            p2 = MeasureCommon.project(p2, this.viewer);\n            var rubberbandDirection = new THREE.Vector2().copy(p1).sub(p2).normalize();\n\n            var normal;\n            if (p1.x < p2.x) {\n                normal = new THREE.Vector2(rubberbandDirection.y, -rubberbandDirection.x);\n            } else {\n                normal = new THREE.Vector2(-rubberbandDirection.y, rubberbandDirection.x);\n            }\n\n            var offset = labelOffset + Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2)) / 2;\n\n            normal = normal.multiplyScalar(offset);\n            var pos =  labelPosition.sub(normal);\n\n            cornerX = pos.x - Math.floor(width / 2);\n            cornerY = pos.y - Math.floor(height / 2);\n\n            // if panel exceeds screen bounds, just put the panel in the center of the screen.\n            if ((cornerX < 0) || (cornerX + width > this.viewer.canvas.clientWidth) || (cornerY < 0) || (cornerY + height > this.viewer.canvas.clientHeight)) {\n                cornerX = Math.floor((this.viewer.canvas.clientWidth - width) / 2);\n                cornerY = Math.floor((this.viewer.canvas.clientHeight - height) / 2);\n            }\n        }\n\n        this.container.style.left = cornerX + 'px';\n        this.container.style.top  = cornerY + 'px';\n    };\n\n    //\n    // /** @constructor */\n    //\n    //\n    export var CalibrationRequiredDialog = function(measureExt, viewer, id, title, options)\n    {\n        var self = this;\n\n        options = options || {};\n        options.addFooter = false;\n\n        avu.DockingPanel.call(this, viewer.container, id, title, options);\n\n        this.viewer = viewer;\n        this.measureExt = measureExt;\n        this.parentContainer = viewer.container;\n        this.container.classList.add('calibration-panel');\n        this.container.style.width = \"380px\";\n        this.container.style.height = \"190px\";\n        \n        if (!options.heightAdjustment)\n            options.heightAdjustment = 70;\n        if (!options.marginTop)\n            options.marginTop = 0;\n        options.left = false;\n\n        this.createScrollContainer(options);\n        this.dialogBox = document.createElement(\"div\");\n        this.scrollContainer.appendChild( this.dialogBox );\n\n        // text\n        var calibrateNow = document.createElement('div');\n        calibrateNow.className = 'calibration-text';\n        var text = \"Calibration Message\";\n        calibrateNow.setAttribute(\"data-i18n\", text);\n        calibrateNow.textContent = av.i18n.translate(text);\n        this.dialogBox.appendChild(calibrateNow);\n\n        var buttonsWrapper = document.createElement('div');\n        buttonsWrapper.className = 'calibration-buttons-wrapper';\n        this.dialogBox.appendChild(buttonsWrapper);\n        \n        // Cancel button\n        var cancel = document.createElement('div');\n        cancel.classList.add('docking-panel-secondary-button');\n        cancel.classList.add('calibration-button-left');\n        cancel.setAttribute(\"data-i18n\", \"Cancel\");\n        cancel.textContent = av.i18n.translate(\"Cancel\");\n        cancel.addEventListener('click', function () {\n            self.setVisible(false);\n        }, false);\n        buttonsWrapper.appendChild(cancel);\n\n        // Calibrate-Now button\n        var calibrateNowButton = document.createElement('div');\n        calibrateNowButton.classList.add('docking-panel-primary-button');\n        calibrateNowButton.classList.add('calibration-button-right');\n        calibrateNowButton.setAttribute(\"data-i18n\", \"Calibrate Now\");\n        calibrateNowButton.textContent = av.i18n.translate(\"Calibrate Now\");\n        calibrateNowButton.addEventListener('click', function () {\n            self.measureExt.enableCalibrationTool(true);\n            self.setVisible(false);\n        }, false);\n        buttonsWrapper.appendChild(calibrateNowButton);\n        \n\n    }; // end constructor\n\n    CalibrationRequiredDialog.prototype = Object.create(avu.DockingPanel.prototype);\n    ave.ViewerPanelMixin.call(CalibrationRequiredDialog.prototype);\n\n\n    CalibrationRequiredDialog.prototype.uninitialize = function uninitialize() {\n        this.viewer = null;\n        avu.DockingPanel.prototype.uninitialize.call(this);\n    };\n","import { CalibrationToolIndicator } from './CalibrationToolIndicator'\nimport { CalibrationPanel } from './CalibrationPanels'\n\n//\n// /** @constructor */\n//\n//\nexport var CalibrationTool = function( viewer, options, sharedMeasureConfig, snapper)\n{   \n    var av = Autodesk.Viewing;\n    var avem = Autodesk.Viewing.Extensions.Measure;\n    var MeasureCommon = Autodesk.Viewing.MeasureCommon;\n\n    var _names  = [\"calibration\"];\n    var _priority = 50;\n    var _viewer  = viewer;\n    var _measurement = new MeasureCommon.Measurement(MeasureCommon.MeasurementTypes.MEASUREMENT_DISTANCE);\n    var _options = options || {};\n\n    // Shared State with MeasureTool and Indicator\n    var _sharedMeasureConfig = sharedMeasureConfig;\n\n    var _maxPrecision = options.maxPrecision || 5;\n    var _isCalibrated = (sharedMeasureConfig.calibrationFactor != null); // True when the user set the calibration, or used a Previous calibration factor.\n    \n    var _snapper = snapper;\n\n    var _active = false;\n    var _isDragging = false;\n    var _isPressing = false;\n\n    var _distance = null; // The length of the current measurement.\n    var _calibrationTaken = false; // True when the user selected two valid points and set the calibration.\n    var _selectedSize = null;\n    var _selectedUnits = null;\n    var _selectedP1 = null;\n    var _selectedP2 = null;\n    var _waitingForInput = false; // True when the user selected two valid points.\n    var _picksBackup = [];\n    var _cursorPosition = null;\n\n    var _activePoint = 0;\n    \n    var _endpointMoved = false;\n\n    var _consumeSingleClick = false;\n    var _singleClickHandled = false;\n    var _downX = null;\n    var _downY = null;\n\n    // GUI.\n    var _calibrationPanel = null;\n    var _cursor = \"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAYCAYAAAD+vg1LAAAAAXNSR0IArs4c6QAAAwZJREFUSA2tVEtLW0EUvjGJefoqSY0x0WBSiY+oNWiUINkU6ioLaaAlG1eudNVFoT+grgopiCkEIbUK1o0lusmurRSEWmmKG6MNtNhNosWqyU2CZPpN8cr15nFD7YHDzHnON2fOGYZhmHkw4XEW+wD4xkT4lMvl6CE0+Y2ohh+dz+cZn89HVS/5+n/d/wVMkXq9Xor2v5SBgsmymQwZHx+vOqlKpXKDXWI3eU6Tg+kqSjSh3W4/s9lsvzUajaNcAK3xY7Dyci3nd6WXSCS60dHRvMfjSRcKBfWV4SYbrVarB8p0PB5nY7HYmdVq/aDX67WlckpKKcvpOjs7X09OTvoPDw8z2Wy2Bu+imJqa+npycnJXGHOt3YRGoSyVSvvMZrNkYWFBs7GxkaoBAXFJcDJhcCW5rq5ur62trQ/EOhyOBhDT2Nj4qVKMqA31ve1yub7Rfufo/PycDA4OxpuamhqECaouhVqtfuD3+1tqa2uZQCCQDoVCWTwknVQDDvIKE1clI1ja09Ozg0cjx8fHpL+/P+50OhMU8f7+Punt7f2I5NdqXRXi9fV1z9jYWCuIWV5eziSTyWAqlXq1urqaw6AwOMiCG4lOYtEturu732xubhK0FQHSvfr6+lsog4HWPIPvIBqNErRiqCiwkkKpVFowZd8xZSQYDLImk+kJ52+xWJ4tLS3hU8yTkZGRBD2Ms4mu6Nun4XA4f3p6SoaGhuJ0+rgg/Bsmt9udYFmWzM3NZdDT05ztWsE5JV0R1AqUCfTt0fb2tjESiRRmZmaOUOcI3w9DY5mdnb03PDzMoDQ/MZFRzM20lO/E38vl8vt46UdAq0WNJWixlEwmu8B1bXioOxwjpgXJ0hMTE1og1qysrDghf+HnKtoD7c7u7i5ZXFzMGY3GF7iFuRR3dHTMr62tXWxtbZH29vZ3RYmECozu54ODAzpdP2hphHZOVigUVjChvgMDA+85fdm1q6vrrU6n+4WR9Zd1ujQ0Nzc/NBgMScSExXwZ2j5oL5Wo46UD/ZvxUemo+AdW1zJzUYr16wAAAABJRU5ErkJggg==), auto\";\n    var _hasUI = Autodesk.Viewing.Private.GuiViewer3D && viewer instanceof Autodesk.Viewing.Private.GuiViewer3D;\n\n    var MeasureCommon = Autodesk.Viewing.MeasureCommon;\n\n    function getActivePick()\n    {\n        switch (_activePoint) {\n            case 0:\n                return null;\n            case 1:\n            case 2:\n                return _measurement.getPick(_activePoint);\n            case 3:\n                return _measurement.getPick(_measurement.countPicks());\n        }\n    }\n\n    function getPreviousPick()\n    {\n        switch (_activePoint) {\n            case 0:\n                return null;\n            case 1:\n                return _measurement.getPick(_measurement.countPicks());\n            case 2:\n            case 3:\n                return _measurement.getPick(1);\n        }\n    }\n\n    function hasPreviousPick()\n    {\n        switch (_activePoint) {\n            case 0:\n                return false;\n            case 1:\n                return _measurement.hasPick(_measurement.countPicks());\n            case 2:\n            case 3:\n                return _measurement.hasPick(1);\n        }\n    }\n\n    function noPicksSet() {\n        _activePoint = 0;\n    }\n\n    function allPicksSet() {\n        _activePoint = 3;\n        _measurement.indicator.changeAllEndpointsEditableStyle(true);\n    }\n\n    function isNoPicksSet() {\n        return _activePoint === 0;\n    }\n\n    function areAllPicksSet() {\n        return _activePoint === 3;   \n    }\n\n    this.register = function()\n    {\n        if (_hasUI && !_calibrationPanel) {\n            _calibrationPanel = new CalibrationPanel( this, _viewer, \"calibration-panel\", \"Calibration\", _options );\n            _viewer.addPanel(_calibrationPanel);\n        }\n\n        this.onCameraChangeBinded = this.onCameraChange.bind(this);\n        this.screenSizeChangedBinded = this.screenSizeChanged.bind(this);\n    };\n\n    this.deregister = function()\n    {   \n        this.deactivate();\n        \n        if (_calibrationPanel) {\n            _viewer.removePanel( _calibrationPanel );\n            _calibrationPanel.uninitialize();\n            _calibrationPanel = null;\n        }\n    };\n\n    this.isActive = function()\n    {\n        return _active;\n    };\n\n    this.getNames = function()\n    {\n        return _names;\n    };\n\n    this.getName = function()\n    {\n        return _names[0];\n    };\n\n    this.getPriority = function()\n    {\n        return _priority;\n    };\n\n    this.getCursor = function() {\n        return _isDragging ? null : _cursor;\n    };\n\n    this.activate = function()\n    {\n        _active = true;\n        _isDragging = false;\n        this.isEditingEndpoint = false;\n        this.editByDrag = false;\n        noPicksSet();\n\n        _viewer.toolController.activateTool(_snapper.getName());\n        _viewer.toolController.activateTool(\"magnifyingGlass\");\n\n\n        if (!_measurement.indicator) {\n            _measurement.attachIndicator(_viewer, this, CalibrationToolIndicator);\n        }\n\n        _measurement.indicator.clear();\n\n        if (_calibrationTaken && _selectedP1 && _selectedP2) {\n            _measurement.setPick(1, _selectedP1.clone());\n            _measurement.setPick(2, _selectedP2.clone());\n\n            allPicksSet();\n\n            var parsedRequestedSize = Autodesk.Viewing.Private.UnitParser.parsePositiveNumber(_selectedSize, _selectedUnits);\n            _measurement.indicator.updateLabelValue(Autodesk.Viewing.Private.formatValueWithUnits(parsedRequestedSize, _selectedUnits, 3, _sharedMeasureConfig.precision));\n            _distance = _measurement.distanceXYZ;\n            _measurement.indicator.changeLabelClickableMode(false);\n            _waitingForInput = true;\n            var valid = this.render();\n            _measurement.indicator.changeAllEndpointsEditableStyle(true);\n\n            if (valid) {\n                if (_calibrationPanel) {\n                    _calibrationPanel.setPanelValue(_selectedSize);\n                }\n                \n                this.showPanel();\n            }\n        }\n\n        _viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, this.onCameraChangeBinded);\n        _viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT, this.screenSizeChangedBinded);\n    };\n\n    this.deactivate = function()\n    {   \n        if (!_active)\n            return;\n\n        _active = false;\n\n        this.hidePanel();\n        this.updateViewportId(true);\n        _waitingForInput = false;\n        _measurement.clearAllPicks();\n\n        if(_snapper && _snapper.isActive()) {\n            _viewer.toolController.deactivateTool(_snapper.getName());\n        }\n\n        _viewer.toolController.deactivateTool(\"magnifyingGlass\");\n\n        if (_measurement.indicator) {\n            _measurement.indicator.clear();\n            _measurement.indicator.destroy();\n            _measurement.indicator = null;\n        }\n\n        _viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, this.onCameraChangeBinded);\n        _viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT, this.screenSizeChangedBinded);\n    };\n\n    this.getActivePointIndex = function() {\n        return _activePoint;\n    };\n\n    this.setCalibrationFactor = function ( calibrationFactor ) {\n        _sharedMeasureConfig.calibrationFactor = calibrationFactor;\n    };\n\n    this.getCalibrationFactor = function () {\n        return _sharedMeasureConfig.calibrationFactor;\n    };\n\n    this.updateLabelValue = function (value) {\n        _measurement.indicator.updateLabelValue(value);\n    };\n\n    this.isCalibrationValid = function(requestedUnits, requestedSize) { \n        var parsedRequestedSize = Autodesk.Viewing.Private.UnitParser.parsePositiveNumber(requestedSize, requestedUnits); \n        return !isNaN(parsedRequestedSize); \n    };\n\n    this.calibrate = function(requestedUnits, requestedSize)\n    {\n\n        var calibrationFactor = null;\n        \n        var parsedRequestedSize = Autodesk.Viewing.Private.UnitParser.parsePositiveNumber(requestedSize, requestedUnits);\n\n        if (!isNaN(parsedRequestedSize)) {\n            var currentSize = Autodesk.Viewing.Private.convertUnits(_viewer.model.getUnitString(), requestedUnits, 1, _distance);\n            if (currentSize !== 0 && !isNaN(currentSize)) {\n                calibrationFactor = parsedRequestedSize / currentSize;\n                _sharedMeasureConfig.calibrationFactor = calibrationFactor;\n                _sharedMeasureConfig.units = requestedUnits;\n                var defualtPrecision = _viewer.model.is2d() ? 3 : 1;\n                var requestedPrecision = Autodesk.Viewing.Private.calculatePrecision(requestedSize);\n                _sharedMeasureConfig.precision = Math.max((_sharedMeasureConfig.precision ? _sharedMeasureConfig.precision : defualtPrecision), requestedPrecision);\n                _selectedSize = requestedSize;\n                _selectedUnits = requestedUnits;\n                _isCalibrated = true;\n                _calibrationTaken = true;\n                _selectedP1 = _measurement.getPick(1).clone();\n                _selectedP2 = _measurement.getPick(2).clone();\n            }\n        }\n        \n        if (calibrationFactor) {\n            _viewer.getExtension('Autodesk.Measure').enableCalibrationTool(false);\n            _viewer.dispatchEvent({ type: 'finished-calibration' });\n        }\n    };\n\n    this.calibrateByScale = function(requestedUnits, requestedScale) {\n        _sharedMeasureConfig.calibrationFactor = requestedScale;\n        \n        if (_sharedMeasureConfig.units !== requestedUnits ) {\n            _sharedMeasureConfig.units = requestedUnits;\n            _selectedUnits = requestedUnits;\n        }\n\n        _isCalibrated = true;\n    };\n\n    this.getCurrentUnits = function () {\n        return _sharedMeasureConfig.units;\n    };\n\n    this.hidePanel = function() {\n        if (_calibrationPanel) {\n            _calibrationPanel.setVisible(false);\n        }\n        else {\n            _viewer.dispatchEvent({ type: MeasureCommon.Events.CLOSE_CALIBRATION_PANEL_EVENT });\n        }\n    };\n\n    this.showPanel = function() {\n\n        var self = this;\n\n        if (_calibrationPanel) {\n            window.setTimeout(function () { _calibrationPanel.requestedSizeTextbox.focus();}, 0);\n            _calibrationPanel.setVisible(true);\n            _calibrationPanel.updatePanelPosition(_measurement.indicator.labelPosition, _measurement.indicator.p1, _measurement.indicator.p2, _measurement.indicator.calibrationLabel.clientHeight);\n            window.addEventListener(\"keyup\", function onKeyUp(e){\n                var key = e.key || String.fromCharCode(e.keyCode);\n                if (key == \"Escape\" && self.isActive()) {\n                    self.hidePanel();\n                    self.clearSize();\n                    self.showAddCalibrationLabel();\n                    \n                    window.removeEventListener(\"keyup\", onKeyUp);\n                }\n            });\n        }\n        else {\n            _viewer.dispatchEvent({ type: MeasureCommon.Events.OPEN_CALIBRATION_PANEL_EVENT, data: {size: _selectedSize, units: _selectedUnits } });\n        }\n    };\n\n    this.showAddCalibrationLabel = function() {\n        _measurement.indicator.showAddCalibrationLabel();\n    };\n\n    this.isCalibrated = function() {\n        return _isCalibrated;\n    };\n\n    this.clearSize = function () {\n        _measurement.indicator.updateLabelValue(null);\n\n        if (_calibrationPanel) {\n            _calibrationPanel.requestedSizeTextbox.value = \"\";   \n        }\n        else {\n            _viewer.dispatchEvent({ type: MeasureCommon.Events.CLEAR_CALIBRATION_SIZE_EVENT });\n        }\n    };\n\n    this.getMaxPrecision = function() {\n        return _maxPrecision;\n    };\n    \n    this.clearMeasurement = function() {\n\n        noPicksSet();\n\n        this.clearPick(1);\n        this.clearPick(2);\n\n        _measurement.indicator.clear();\n        \n        this.updateViewportId(true);\n        this.hidePanel();\n\n        _waitingForInput = false;\n    };\n\n    this.clearPick = function(pickNumber) {\n        if (_measurement.hasPick(pickNumber)) {\n            _measurement.clearPick(pickNumber);\n            _measurement.indicator.hideClick(pickNumber);\n        }\n    };\n\n    this.repickEndpoint = function(pickNumber) {\n        this.clearPick(pickNumber);\n        this.editEndpoint(null, pickNumber);\n    };\n\n    this.getSnapper = function() {\n        return _snapper;\n    };\n\n    this._handleMouseEvent = function (event) {\n\n        var valid = false;\n\n        if (_snapper.isSnapped()) {\n\n            // User picked a new point after two points where already set (or none) - Start a new measurement.\n            if (areAllPicksSet() || isNoPicksSet()) {\n                this.clearMeasurement();\n                _activePoint = 1;\n            }\n            \n            _snapper.copyResults(getActivePick());\n\n            valid = true;\n\n        } \n        else { \n            // In order to draw rubber-band, set the cursor position, so the indicator will use it as active point.\n            if (event && _viewer.model.is2d()) {\n                var viewport = _viewer.container.getBoundingClientRect();\n                var x = event.canvasX || event.clientX - viewport.left;\n                var y = event.canvasY || event.clientY - viewport.top;\n\n                if (x && y) {\n                    _cursorPosition = MeasureCommon.inverseProject({ x:x, y:y }, _viewer);\n                }\n            }\n\n            // In case a measurement is set, and the user clicks on a blank spot - don't do nothing.\n            if (_consumeSingleClick && _measurement && !this.isEditingEndpoint) {\n                if (_activePoint === _measurement.getMaxNumberOfPicks() + 1) {\n                    return true;\n                }\n            }\n\n            var lastPick = getActivePick();\n            if (lastPick) {\n                lastPick.clear();\n            }\n        }\n\n        this.correctPickPosition();\n\n        if (_consumeSingleClick) {\n            this._doConsumeSingleClick(valid);\n        }\n        \n        if (!isNoPicksSet()) {\n            var renderSucceeded = this.render();\n\n            // If it's the first pick, we don't expect the render of the rubberband to be succeeded.\n            // So enter here only if it's not the first pick.\n            if (_measurement.hasPick(2)) {\n                valid &= renderSucceeded;\n            }\n        }\n\n        if (_consumeSingleClick) {\n            if (_measurement.isComplete() && valid) {\n                _distance = _measurement.distanceXYZ;\n                this.clearSize();\n                this.showPanel();\n                _waitingForInput = true;\n            }\n            else {\n                this.hidePanel();\n                _measurement.indicator.updateLabelValue(null);\n                _waitingForInput = false;\n            }\n        }\n\n        // If valid is false, the last pick is not revelant, and will clear it in case of a click.\n        return valid;\n    };\n\n    this.updateViewportId = function(clear) {\n        if (_viewer.model && _viewer.model.is2d()) {\n            if (clear || isNoPicksSet()) {\n                viewer.impl.updateViewportId(0);\n                _snapper.setViewportId(null);\n            }\n            else if (!_isPressing) {\n                var viewport = getPreviousPick().viewportIndex2d || getActivePick().viewportIndex2d;\n                \n                // Pass viewport Id to LineShader to make all other geometries with different viewport transparent\n                viewer.impl.updateViewportId(viewport);\n                if (_snapper)\n                    _snapper.setViewportId(viewport);  \n            \n            }\n        }\n    };\n\n    this._doConsumeSingleClick = function(valid) {\n\n        this.updateViewportId(_measurement.isComplete());\n\n        _measurement.indicator.clear();\n    };\n\n\n    this.handleButtonDown = function (event, button) {\n        if (av.isMobileDevice()) \n            return false;\n\n        _isDragging = true;\n        if (button === 0 && !event.ctrlKey && !event.metaKey && !event.shiftKey && !event.altKey) {\n            _consumeSingleClick = true;\n            _downX = event.canvasX;\n            _downY = event.canvasY;\n        }\n        return false;\n    };\n\n    this.handleMouseMove = function (event) {\n        if (av.isMobileDevice())\n            return false;\n\n        if (event.canvasX !== _downX || event.canvasY !== _downY) {\n            _consumeSingleClick = false;    \n        }\n\n        _endpointMoved = this.isEditingEndpoint;    \n\n        if (!isNoPicksSet() && !areAllPicksSet()) {\n            this.clearPick(_activePoint);\n            this._handleMouseEvent(event);\n        }\n\n        _snapper.indicator.render();\n        \n        return false;\n    };\n\n    this.restoreMouseListeners = function () {\n\n        // When a press event has happend, the default behavior of firefly.js is to disable other mouse events,\n        // So they won't be triggered as well.\n        // The solution is to enable them after the end of the pressing.\n\n        _viewer.toolController.getTool(\"gestures\").controller.enableMouseButtons(true);\n    };\n\n    this.handlePressHold = function (event) {\n        _consumeSingleClick = false;\n\n        if (av.isTouchDevice()) {\n            switch( event.type )\n            {\n                case \"press\":\n                    _isPressing = true;\n                    if (areAllPicksSet()) {\n                        this.clearMeasurement();\n                    } else {\n                        this.clearPick(_activePoint);\n                    }\n                    this._handleMouseEvent(event);\n                    _snapper.indicator.render();\n\n                    return true;\n\n                case \"pressup\":\n                    _consumeSingleClick = true;\n                    this.restoreMouseListeners();\n                    _singleClickHandled = !_singleClickHandled;\n                    this.handleSingleClick(event);\n                    _isPressing = false;\n                    return true;\n            }\n        }\n        return false;\n\n    };\n\n    this.correctPickPosition = function() {\n        \n        var active = getActivePick();\n            \n        if (active && !active.getGeometry() && _cursorPosition) {\n            active.geomType = MeasureCommon.SnapType.SNAP_VERTEX;\n            active.geomVertex = _cursorPosition;\n            active.intersectPoint = _cursorPosition;\n        }\n\n        if (hasPreviousPick()) {\n            var passive = getPreviousPick();\n            MeasureCommon.correctPerpendicularPicks(passive, active, viewer, _snapper);\n        }\n    };\n\n    this.render = function() {\n\n        var hasResult = _measurement.computeResult(_measurement.picks, _viewer, _snapper);\n        _measurement.indicator.render(_measurement.picks, _consumeSingleClick || _waitingForInput);\n\n        return hasResult;\n    };\n\n    this.editEndpoint = function(event, endpointNumber) {\n        if (_activePoint === endpointNumber) {\n            _measurement.indicator.changeEndpointOnEditStyle(endpointNumber, false);\n            this.undoEditEndpoint();\n            return;\n        }\n\n        _activePoint = endpointNumber;\n        this.isEditingEndpoint = true;\n\n        _measurement.indicator.changeEndpointOnEditStyle(endpointNumber, true);\n        _measurement.indicator.changeAllEndpointsEditableStyle(false);\n\n        for (var key in _measurement.picks) {\n            if (_measurement.picks.hasOwnProperty(key)) {\n                _picksBackup[key] = _measurement.getPick(key).clone();\n            }\n        }\n\n        this.updateViewportId();\n\n        this.hidePanel();\n        _measurement.indicator.updateLabelValue(null);\n        _waitingForInput = false;\n\n        if(!av.isMobileDevice()) {\n            this._handleMouseEvent(event);\n        }\n    };\n\n    this.undoEditEndpoint = function() {\n        _measurement.indicator.clear();\n\n        for (var key in _measurement.picks) {\n            if (_measurement.picks.hasOwnProperty(key)) {\n                _measurement.setPick(key, _picksBackup[key].clone());\n            }\n        }\n        \n        this.updateViewportId(true);\n        this.isEditingEndpoint = false;\n        _waitingForInput = true;\n\n        allPicksSet();\n        var valid = this.render();\n        \n        if (valid) {\n            this.showPanel();\n        }\n    };\n\n    this.handleGesture = function(event)\n    {   \n        if (av.isTouchDevice()){\n            \n            _consumeSingleClick = false;\n        \n            if (_isPressing) {\n                \n                this.clearPick(_activePoint);\n\n                switch( event.type )\n                {\n                    case \"dragstart\":\n                        this._handleMouseEvent(event);\n                        _snapper.indicator.render();\n\n                        return true;\n\n                    case \"dragmove\":\n                        this._handleMouseEvent(event);\n                        _snapper.indicator.render();\n\n                        return true;\n\n                    case \"dragend\":\n                        _isPressing = false;\n                        _consumeSingleClick = true;\n\n                        if (!this.editByDrag) {\n                            _singleClickHandled = !_singleClickHandled;\n                            this.handleSingleClick(event);    \n                        }\n\n                        this.editByDrag = false;\n                        this.restoreMouseListeners();\n                        return true;\n\n                    case \"pinchend\":\n                        _consumeSingleClick = true;\n                        _singleClickHandled = !_singleClickHandled;\n                        this.handleSingleClick(event);\n                        this.restoreMouseListeners();\n                        return true;\n                }\n            }\n        }\n\n        return false;\n    };\n\n    this.handleButtonUp = function (event) {\n        _isDragging = false;\n        _downX = null;\n        _downY = null;\n        \n        if (_endpointMoved) {\n            _consumeSingleClick = true;\n            _singleClickHandled = !_singleClickHandled;\n            this.handleSingleClick(event);\n            _endpointMoved = false;\n        }\n\n        return false;\n    };\n\n    this.handleSingleClick = function (event) {\n        if (_consumeSingleClick) {\n            \n            _snapper.indicator.clearOverlays();\n\n            _measurement.indicator.changeEndpointOnEditStyle(_activePoint, false);\n\n            if (this._handleMouseEvent(event)) {\n                _measurement.indicator.showEndpoints();\n                _measurement.indicator.updateLabelsPosition();\n                _activePoint++;\n            }\n            else {\n                if (this.isEditingEndpoint) {\n                    this.undoEditEndpoint();\n                }\n                else {\n                    this.clearMeasurement();\n                }\n            }\n\n            if (_measurement.isComplete()) {\n                allPicksSet();\n            }\n\n            _consumeSingleClick = false;\n            _singleClickHandled = !_singleClickHandled;\n            this.isEditingEndpoint = false;\n\n            _snapper.clearSnapped();\n        }\n        return true;\n    };\n\n    this.handleDoubleClick = function() {\n        return true;\n    };\n\n    this.handleSingleTap = function (event) {\n        if (!_singleClickHandled) {\n            _consumeSingleClick = true;\n            _snapper.onMouseDown({x: event.canvasX, y:event.canvasY});\n            this.handleSingleClick(event);\n        }\n        _singleClickHandled = !_singleClickHandled;\n\n        return true;\n    };\n\n    this.handleDoubleTap = function() {\n        return true;\n    };\n\n    this.handleResize = function() {\n        if (_measurement.indicator) {\n            _measurement.indicator.handleResize();\n        }\n    };\n\n    this.onCameraChange = function() {\n        if (_snapper.indicator) {\n            _snapper.indicator.onCameraChange();\n        }\n    };\n\n    this.screenSizeChanged = function(event) {\n        this.onCameraChange();\n    };\n};\n","\nexport var MagnifyingGlass = function(viewer) {\n\n    var _viewer = viewer;\n    var _active = false;\n    var _names = [\"magnifyingGlass\"];\n    var _priority = 70;\n    var _isPressing = false;\n    var _radius = 60;\n    var _zoom = 2;\n    var _offset = 15;\n    var _magnifyingGlassCanvas = null;\n    var _imageData = null;\n    var _imageBuffer = null;\n    var _clientX = null;\n    var _clientY = null;\n    var _needsClear = false;\n    var av = Autodesk.Viewing;\n    \n\n    this.isActive = function() {\n\n        return _active;\n    };\n\n    this.activate = function() {\n\n        _active = true;\n        this.updateMagnifyingGlassBinded = this.updateMagnifyingGlass.bind(this);\n    };\n\n    this.updateMagnifyingGlass = function() {\n        if (_needsClear) {\n            _magnifyingGlassCanvas && _magnifyingGlassCanvas.classList.remove('visible');\n            _needsClear = false;\n        }\n        else {\n            var pixelRatio = window.devicePixelRatio;\n            var diameter = 2 * _radius;\n            var normlizedDiameter = diameter * pixelRatio;\n            var x = pixelRatio * (_clientX - (_radius  / _zoom));\n            var y = pixelRatio * (_clientY - (_radius  / _zoom));\n            \n            if (!_magnifyingGlassCanvas) {\n                _magnifyingGlassCanvas = document.createElement(\"canvas\");\n                _magnifyingGlassCanvas.className = 'magnifying-glass';\n                _magnifyingGlassCanvas.width = normlizedDiameter;\n                _magnifyingGlassCanvas.height = normlizedDiameter;\n                _magnifyingGlassCanvas.style.width = diameter + 'px';\n                _magnifyingGlassCanvas.style.height = diameter + 'px';\n\n                // Swap canvas\n                _magnifyingGlassCanvas.getContext(\"2d\").translate(0, normlizedDiameter);\n                _magnifyingGlassCanvas.getContext(\"2d\").scale(1,-1);\n\n                _viewer.container.appendChild(_magnifyingGlassCanvas);\n                _imageData = _magnifyingGlassCanvas.getContext(\"2d\").createImageData(Math.ceil(normlizedDiameter / _zoom), Math.ceil(normlizedDiameter / _zoom));\n                _imageBuffer = new Uint8Array(_imageData.data.buffer);\n            }\n\n            var ctx = _magnifyingGlassCanvas.getContext(\"2d\");\n            \n            // Read the pixels from the frame buffer\n            var gl = _viewer.canvas.getContext(\"webgl\") || _viewer.canvas.getContext(\"experimental-webgl\");         \n            gl.readPixels(x, _viewer.canvas.height - y - _imageData.height, _imageData.width, _imageData.height, gl.RGBA, gl.UNSIGNED_BYTE, _imageBuffer);\n            // Put the pixel into the magnifying context.\n            ctx.putImageData(_imageData, 0, 0);\n            // Scale the image\n            ctx.drawImage(_magnifyingGlassCanvas, 0, 0, _imageData.width, _imageData.height, 0, 0, normlizedDiameter, normlizedDiameter);\n            this.setGlassPosition(_magnifyingGlassCanvas, _clientX, _clientY, diameter, _offset); \n\n            _magnifyingGlassCanvas.classList.toggle('visible', true);\n        }\n    };\n\n    this.deactivate = function() {\n        this.clearMagnifyingGlass();\n        _active = false;\n    };\n\n    this.getNames = function() {\n\n        return _names;\n    };\n\n    this.getName = function() {\n\n        return _names[0];\n    };\n\n    this.getPriority = function() {\n        return _priority;\n    };\n\n    this.setGlassPosition = function(canvas, x, y, diameter, offset) {\n            \n        // check the left border of canvas\n        canvas.style.left = (x - diameter/2) + 'px';\n\n        // check the top border of canvas\n        if (y - diameter - offset > 0) {\n            canvas.style.top  = (y - diameter - offset) + 'px';    \n        }\n        else {\n            canvas.style.top = (y + offset) + 'px';    \n        }\n    };\n\n    this.requestUpdate = function() {\n        if(!_viewer.hasEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT, this.updateMagnifyingGlassBinded)) {\n           _viewer.addEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT, this.updateMagnifyingGlassBinded, { once: true });\n        }\n    };\n\n    this.drawMagnifyingGlass = function(clientX, clientY) {\n        _clientX = clientX;\n        _clientY = clientY;\n        _viewer.impl.invalidate(false, false, true);\n        this.requestUpdate();\n    };\n\n    this.clearMagnifyingGlass = function () {\n        _needsClear = true;\n        this.requestUpdate();\n    };\n\n    this.handlePressHold = function (event) {\n\n        if (av.isTouchDevice()) {\n            switch( event.type )\n            {\n                case \"press\":\n                    _isPressing = true;\n                    this.drawMagnifyingGlass(event.canvasX, event.canvasY);\n                    break;\n\n                case \"pressup\":\n                    this.clearMagnifyingGlass();\n                    _isPressing = false;\n                    break;\n            }\n        }\n        return false;\n\n    };\n\n    this.handleGesture = function(event) {\n\n        if (_isPressing && av.isTouchDevice()) {\n            switch( event.type )\n            {\n                case \"dragstart\":\n                    this.drawMagnifyingGlass(event.canvasX, event.canvasY);\n                    break;\n\n                case \"dragmove\":\n                    this.drawMagnifyingGlass(event.canvasX, event.canvasY);\n                    break;\n\n                case \"dragend\":\n                    this.clearMagnifyingGlass();\n                    _isPressing = false;\n                    break;\n\n                case \"pinchstart\":\n                    this.drawMagnifyingGlass(event.canvasX, event.canvasY);\n                    break;\n\n                case \"pinchmove\":\n                    this.drawMagnifyingGlass(event.canvasX, event.canvasY);\n                    break;\n\n                case \"pinchend\":\n                    this.clearMagnifyingGlass();\n                    break;\n            }\n        }\n\n        return false;\n    };\n\n    this.handleMouseMove = function (event) {\n        return false;\n    };\n\n    this.handleWheelInput = function (delta) {\n        return false;\n    };\n\n    this.handleButtonUp = function (event, button) {\n        return false;\n    };\n\n};\n","\n    var av = Autodesk.Viewing;\n    var avu = Autodesk.Viewing.UI;\n    var avp = Autodesk.Viewing.Private;\n    var MeasureCommon = Autodesk.Viewing.MeasureCommon;\n\n    // /** @constructor */\n    export function MeasureToolbar(measureExtension)\n    {\n        this.measureExtension = measureExtension;\n        this.measureTool = this.measureExtension.measureTool;\n        this.viewer = this.measureExtension.viewer;\n        this.visible = false;\n        this.buttonsList = [];\n    }\n\n    var proto = MeasureToolbar.prototype;\n\n    proto.init = function() {\n        var self = this;\n\n        // Add Measure tool toolbar to main toolbar\n        var toolbar = this.viewer.getToolbar(true);\n        var navigationBar = toolbar.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID);\n        var toolbarOptions = {};\n        toolbarOptions.index = toolbar.indexOf(navigationBar) + 1;\n        this.measureToolbar = new avu.ControlGroup(Autodesk.Viewing.TOOLBAR.MEASURETOOLSID);\n        toolbar.addControl(this.measureToolbar, toolbarOptions);\n    \n\n        // Create a button for the measure simple distance.\n        this.measureSimpleDistanceBtn = new avu.Button(\"toolbar-measureTool-simple-distance\");\n        this.measureSimpleDistanceBtn.setToolTip(\"Distance\");\n        this.measureSimpleDistanceBtn.setIcon(\"adsk-icon-measure-distance-new\");\n        this.measureSimpleDistanceBtn.onClick = function() {\n            var enable = self.measureSimpleDistanceBtn.getState() !== avu.Button.State.ACTIVE;\n            if (enable) {\n                self.measureExtension.activate('distance');\n            } else {\n                self.measureTool.deselectAllMeasurements();\n            }\n        };\n\n        this.measureToolbar.addControl(this.measureSimpleDistanceBtn);\n        this.buttonsList[MeasureCommon.MeasurementTypes.MEASUREMENT_DISTANCE] = this.measureSimpleDistanceBtn;\n\n\n        // Create a button for the measure Angle.\n        this.measureAngleBtn = new avu.Button(\"toolbar-measureTool-angle\");\n        this.measureAngleBtn.setToolTip(\"Angle\");\n        this.measureAngleBtn.setIcon(\"adsk-icon-measure-angle-new\");\n        this.measureAngleBtn.onClick = function () {\n            var enable = self.measureAngleBtn.getState() !== avu.Button.State.ACTIVE;\n            if (enable) {\n                self.measureExtension.activate('angle');\n            } else {\n                self.measureTool.deselectAllMeasurements();\n            }\n        };\n        this.measureToolbar.addControl(this.measureAngleBtn);\n        this.buttonsList[MeasureCommon.MeasurementTypes.MEASUREMENT_ANGLE] = this.measureAngleBtn;\n\n        if (this.viewer.model && this.viewer.model.is2d()) {\n            // Create a button for the measure distance.\n            this.measureAreaBtn = new avu.Button(\"toolbar-measureTool-area\");\n            this.measureAreaBtn.setToolTip(\"Area\");\n            this.measureAreaBtn.setIcon(\"adsk-icon-measure-area-new\");\n            this.measureAreaBtn.onClick = function() {\n                var enable = self.measureAreaBtn.getState() !== avu.Button.State.ACTIVE;\n                if (enable) {\n                    self.measureExtension.activate('area');\n                } else {\n                    self.measureTool.deselectAllMeasurements();\n                }\n            };\n\n            this.measureToolbar.addControl(this.measureAreaBtn);\n            this.buttonsList[MeasureCommon.MeasurementTypes.MEASUREMENT_AREA] = this.measureAreaBtn;\n        }\n\n        // Create a button for the Calibration tool.\n        this.calibrationToolBtn = new avu.Button( \"toolbar-calibrationTool\");\n        this.calibrationToolBtn.setToolTip(\"Calibrate\");\n        this.calibrationToolBtn.setIcon(\"adsk-icon-measure-calibration\");\n        this.calibrationToolBtn.onClick = function(e) {\n            var enable = self.calibrationToolBtn.getState() !== avu.Button.State.ACTIVE;\n            if(enable) {\n                self.measureExtension.activate('calibrate');\n            } else  {\n                self.measureExtension.enableCalibrationTool(false);\n            }\n        };\n\n        this.measureToolbar.addControl(this.calibrationToolBtn);\n        this.buttonsList[MeasureCommon.MeasurementTypes.CALIBRATION] = this.calibrationToolBtn;\n\n        var separator = document.createElement('div');\n        separator.className = 'measure-toolbar-seperator';\n\n        this.measureToolbar.container.appendChild(separator);\n        \n\n        // Create a button for the Trash.\n        this.deleteBtn = new avu.Button( \"toolbar-delete\");\n        this.deleteBtn.setToolTip(\"Delete measurement\");\n        this.deleteBtn.setIcon(\"adsk-icon-measure-trash\");\n        this.deleteBtn.onClick = function() {\n            self.measureExtension.deleteCurrentMeasurement();\n        };\n\n        this.measureToolbar.addControl(this.deleteBtn);\n\n        // Create a button for the Settings panel.\n        this.settingsBtn = new avu.Button( \"toolbar-settings\");\n        this.settingsBtn.setToolTip(\"Measure settings\");\n        this.settingsBtn.setIcon(\"adsk-icon-measure-settings\");\n\n        this.settingsControlPanel = document.createElement('div');\n        this.settingsControlPanel.classList.add('docking-panel');\n        this.settingsControlPanel.classList.add('docking-panel-container-solid-color-b');\n        this.settingsControlPanel.classList.add('measure-settings-popup');\n        this.settingsControlPanel.classList.add('hide');\n\n        this.settingsBtn.onClick = function (event) {\n            if (this.settingsControlPanel.classList.contains('hide')) {\n                this.settingsControlPanel.classList.remove('hide');\n                this.setButtonActive(this.settingsBtn);\n            }\n            else {\n                this.settingsControlPanel.classList.add('hide');\n                this.setButtonInactive(this.settingsBtn);\n            }\n        }.bind(this);\n\n        this.measureToolbar.container.appendChild(this.settingsControlPanel);\n        this.settingsControlPanel.root = this.settingsBtn;\n        this.measureToolbar.addControl(this.settingsBtn);\n\n\n        // Settings Panel\n        this.table = document.createElement(\"table\");\n        this.table.classList.add(\"adsk-lmv-tftable\");\n        this.table.classList.add(\"calibration-table\");\n\n        this.tbody = document.createElement(\"tbody\");\n        this.table.appendChild(this.tbody);\n        this.settingsControlPanel.appendChild(this.table);\n\n        this.units = [\n            { name: 'Unknown', units: '', matches: [''] },                                      // localized in OptionDropDown() call below\n            { name: 'Decimal feet', units: 'decimal-ft', matches: ['ft', 'decimal-ft'] },             // localized in OptionDropDown() call below\n            { name: 'Feet and fractional inches', units: 'ft-and-fractional-in', matches: ['ft-and-fractional-in'] },         // localized in OptionDropDown() call below\n            { name: 'Feet and decimal inches', units: 'ft-and-decimal-in', matches: ['ft-and-decimal-in'] }, // localized in OptionDropDown() call below\n            { name: 'Decimal inches', units: 'decimal-in', matches: ['in', 'decimal-in'] },           // localized in OptionDropDown() call below\n            { name: 'Fractional inches', units: 'fractional-in', matches: ['fractional-in'] },  // localized in OptionDropDown() call below\n            { name: 'Meters', units: 'm', matches: ['m'] },                                     // localized in OptionDropDown() call below\n            { name: 'Centimeters', units: 'cm', matches: ['cm'] },                              // localized in OptionDropDown() call below\n            { name: 'Millimeters', units: 'mm', matches: ['mm'] },                              // localized in OptionDropDown() call below\n            { name: 'Meters and centimeters', units: 'm-and-cm', matches: ['m-and-cm'] }        // localized in OptionDropDown() call below\n        ];\n\n        var initialIndex = this.findUnits(),\n            unitNames = [];\n        \n        // It is not possible to hide elements in Safari.\n        if (av.isSafari() && this.viewer.model.getDisplayUnit()){\n            // We will remove the 'Unknown' unit from the units array.\n            this.units.shift();\n        }\n        \n        for (var i = 0; i < this.units.length; ++i) {\n            unitNames.push(this.units[i].name);\n        }\n\n        this.unitList = new avp.OptionDropDown(\"Unit type\", this.tbody, unitNames, initialIndex, null, { paddingLeft: 0, paddingRight: 15 });\n        this.unitList.addEventListener(\"change\", function(e) {\n            var index = self.unitList.selectedIndex;\n            var toUnits = self.units[index].units;\n            self.measureTool.setUnits(toUnits);\n            self.setupPrecision();\n            avp.logger.track({ category: 'pref_changed', name: 'measure/units', value: toUnits });\n        });\n\n        this.precisionList = new avp.OptionDropDown(\"Precision\", this.tbody, [], -1, null, { paddingLeft: 0, paddingRight: 15 });\n        this.precisionList.addEventListener(\"change\", function(e) {\n            var index = self.precisionList.selectedIndex;\n            self.measureTool.setPrecision(index);\n            avp.logger.track({ category: 'pref_changed', name: 'measure/precision', value: index });\n        });\n\n        this.isolate = new avp.OptionCheckbox(\"Isolate measurement\", this.tbody, false);\n        this.isolate.addEventListener(\"change\", function(e) {\n            var enable = self.isolate.checked;\n            self.measureTool.setIsolateMeasure(enable);\n            if (enable) {\n                self.measureTool.isolateMeasurement();\n            }\n            else {\n                self.measureTool.clearIsolate();\n            }\n            avp.logger.track({ category: 'pref_changed', name: 'measure/isolate', value: enable });\n        });\n\n        this.setupPrecision();\n\n        this.updateSettingsPanel();\n\n        if (this.viewer.model && this.viewer.model.is2d()) {\n            this.isolate.setVisibility(false);\n        }\n\n        if (!this.measureExtension.sharedMeasureConfig.units) {\n            this.disableUnitOption();\n        }\n        // Only disable option if the browser is not Safari\n        else if (!Autodesk.Viewing.isSafari()){\n            this.disableUnitOption(0);  // disable \"Unknown\" option when the model has units\n        }\n\n\n        // Create a button for 'Done'.\n        this.measureDoneBtn = new avu.Button(\"toolbar-measureTool-done\");\n        var doneText = Autodesk.Viewing.i18n.translate('Done');\n        this.measureDoneBtn.setToolTip(doneText);\n        var cancelLabel = document.createElement('label');\n        cancelLabel.textContent = doneText;\n        var btnContainer = this.measureDoneBtn.container;\n        btnContainer.appendChild(cancelLabel);\n        btnContainer.classList.add('adsk-label-button');\n        var iconEle = btnContainer.getElementsByClassName('adsk-button-icon');\n        iconEle && iconEle[0] && (iconEle[0].style.display = 'none');\n\n        this.measureDoneBtn.onClick = function() {\n            this.measureExtension.exitMeasurementMode();\n        }.bind(this);\n        this.measureToolbar.addControl(this.measureDoneBtn);\n\n        // this.settingsControlPanel.style.width = this.measureToolbar.container.getBoundingClientRect().width + 'px';\n        this.measureToolbar.setVisible(false);\n\n    };\n\n    proto.closeToolbar = function() {\n\n        this.measureExtension.enableMeasureTool(false);\n        this.measureExtension.enableCalibrationTool(false);\n        this.toggleVisible();\n\n        var toolbar = this.viewer.getToolbar(false);\n        var viewerToolbarContainer = toolbar.container;\n        var viewerContainerChildrenCount = viewerToolbarContainer.children.length;\n        \n        for(var i = 0; i < viewerContainerChildrenCount; ++i) {\n            viewerToolbarContainer.children[i].style.display = \"\";\n        }\n\n        var modelTools = toolbar.getControl(av.TOOLBAR.MODELTOOLSID);\n        modelTools.addControl(this.measureExtension.measurementToolbarButton, {index: this.measureExtension.measurementToolbarButton.index });\n    };\n\n    proto.toggleVisible = function() {\n        this.visible = !this.visible;\n        this.measureToolbar.setVisible(this.visible);\n        if (!this.visible) {\n            this.settingsControlPanel.classList.add('hide');\n            this.setButtonInactive(this.settingsBtn);\n        }\n    };\n\n    proto.setButtonActive = function(button) {\n        button.setState(avu.Button.State.ACTIVE);\n    };\n\n    proto.setButtonInactive = function(button) {\n        button.setState(avu.Button.State.INACTIVE);\n    };\n\n    proto.deactivateAllButtons = function() {\n        for (var key in this.buttonsList) {\n            if (this.buttonsList.hasOwnProperty(key)) {\n                var button = this.buttonsList[key];\n                this.setButtonInactive(button);   \n            }\n        }\n    };\n\n    proto.activateButtonByType = function(measurementType) {\n        this.setButtonActive(this.buttonsList[measurementType]);\n    };            \n\n    proto.setupPrecision = function() {\n        while (this.precisionList.dropdownElement.lastChild) {\n            this.precisionList.dropdownElement.removeChild(this.precisionList.dropdownElement.lastChild);\n        }\n\n        var selectedUnits = this.measureTool.getUnits(),\n            precisions;\n\n        if (selectedUnits === 'ft-and-fractional-in' || selectedUnits === 'fractional-in') {\n            precisions = ['1', '1/2', '1/4', '1/8', '1/16', '1/32', '1/64'];\n        } else {\n            precisions = ['0', '0.1', '0.01', '0.001', '0.0001', '0.00001'];\n        }\n\n        for (var i = 0; i < precisions.length; ++i) {\n            var elem = document.createElement('option');\n            elem.value = i;\n            elem.textContent = precisions[i];\n            this.precisionList.dropdownElement.appendChild(elem);\n        }\n\n        var selectedIndex = this.measureTool.getPrecision();\n        if (precisions.length <= selectedIndex) {\n            selectedIndex = precisions.length - 1;\n            this.measureTool.setPrecision(selectedIndex);\n        }\n        this.precisionList.dropdownElement.selectedIndex = selectedIndex;\n    };\n\n    proto.findUnits = function() {\n        var i,\n            j,\n            selectedUnits = this.measureTool.getUnits();\n        for (i = 0; i < this.units.length; ++i) {\n            var matches = this.units[i].matches;\n            if (matches) {\n                for (j = 0; j < matches.length; ++j) {\n                    if (matches[j] === selectedUnits) {\n                        return i;\n                    }\n                }\n            }\n        }\n        return 0;\n    };\n\n    proto.disableUnitOption = function( index ) {\n        if (index != null) {\n            this.unitList.dropdownElement.children[index].style.display = \"none\";\n            if (av.isIE11) {\n                // IE11 can't hide <option> elements...\n                this.unitList.dropdownElement.children[index].disabled = true;\n                this.unitList.dropdownElement.children[index].style.visibility = \"hidden\";\n            }\n        } else {  // disable all options\n            this.unitList.dropdownElement.disabled = true;\n        }\n    };\n\n    proto.updateSettingsPanel = function() {\n        this.unitList.dropdownElement.selectedIndex = this.findUnits();\n        this.precisionList.dropdownElement.selectedIndex = this.measureTool.getPrecision();\n        this.setupPrecision();\n    };\n\n\n","import { MeasureTool } from './MeasureTool'\nimport { CalibrationTool } from './CalibrationTool'\nimport { MagnifyingGlass } from './MagnifyingGlass'\nimport { CalibrationRequiredDialog } from './CalibrationPanels'\nimport { MeasureToolbar } from './MeasureToolbar'\n\n\nimport CSS_1 from './Measure.css'       // IMPORTANT!!\nimport CSS_2 from './Calibration.css'   // IMPORTANT!!\n\n'use strict';\n\nvar avem = AutodeskNamespace('Autodesk.Viewing.Extensions.Measure'),\n    av = Autodesk.Viewing,\n    avp = Autodesk.Viewing.Private,\n    avu = av.UI;\nvar MeasureCommon = Autodesk.Viewing.MeasureCommon; // Comes form main viewer bundle.\n\nvar NONE = 0;\nvar MEASURE_TOOL = 1;\nvar CALIBRATION_TOOL = 2;\n\nvar DEFAULT_MEASUREMENT_TYPE = MeasureCommon.MeasurementTypes.MEASUREMENT_DISTANCE;\n\n/**\n * Provides UI controls to perform distance and angle measurements for 2D and 3D models.\n * \n * The extension id is: `Autodesk.Measure`\n * \n * @example\n *   viewer.loadExtension('Autodesk.Measure')\n *  \n * @memberof Autodesk.Viewing.Extensions\n * @alias Autodesk.Viewing.Extensions.MeasureExtension\n * @see {@link Autodesk.Viewing.Extension} for common inherited methods.\n * @constructor\n*/\nexport var MeasureExtension = function(viewer, options) {\n    Autodesk.Viewing.Extension.call(this, viewer, options);\n    this.modes = ['distance','angle','area','calibrate'];\n    this.name = 'measure';\n};\n\nMeasureExtension.prototype = Object.create(Autodesk.Viewing.Extension.prototype);\nMeasureExtension.prototype.constructor = MeasureExtension;\n\n\nMeasureExtension.prototype.onToolbarCreated = function() {\n    this.viewer.removeEventListener(av.TOOLBAR_CREATED_EVENT, this.bindedOnToolbarCreated);\n    this.bindedOnToolbarCreated = null;\n    this.createUI();\n};\n\n/**\n * Load the measure extension.\n * @returns {boolean} True if measure extension is loaded successfully.\n * \n * @alias Autodesk.Viewing.Extensions.MeasureExtension#load\n*/\nMeasureExtension.prototype.load = function() {\n\n    var self   = this;\n    var viewer = this.viewer;\n    this.hasUI = Autodesk.Viewing.Private.GuiViewer3D && viewer instanceof Autodesk.Viewing.Private.GuiViewer3D;\n\n    this.escapeHotkeyId = 'Autodesk.Measure.Hotkeys.Escape';\n\n    // Register the Measure tool\n    if (!viewer.toolController){\n        return false;\n    }\n\n    this.options = this.options || {};\n    var measureToolOptions = {};\n\n    measureToolOptions.onCloseCallback = function() {\n        self.enableMeasureTool(false);\n    };\n\n    // Shared State with measureTool & calibrationTool.\n    // Gets populated when a model is received.\n    this.sharedMeasureConfig = { \n        units: null,\n        precision: null,\n        calibrationFactor: null\n    };\n\n\tmeasureToolOptions.snapperOptions = this.options.snapperOptions;\n\n    this.forceCalibrate = this.options.forceCalibrate;\n\n    this.isCalibrated = (this.options.calibrationFactor != null);\n\n    this.snapper = new MeasureCommon.Snapper(viewer, {\n        renderSnappedTopology: true\n    });\n    viewer.toolController.registerTool(this.snapper);\n\n    this.measureTool = new MeasureTool(viewer, measureToolOptions, this.sharedMeasureConfig, this.snapper);\n    viewer.toolController.registerTool(this.measureTool);\n\n    this.calibrationTool = new CalibrationTool(viewer, this.options, this.sharedMeasureConfig, this.snapper);\n    viewer.toolController.registerTool(this.calibrationTool);\n\n    this.magnifyingGlass = new MagnifyingGlass(viewer);\n    viewer.toolController.registerTool(this.magnifyingGlass);\n\n    this.onFinishedCalibration = function() {\n        if (self.measureToolbar) {\n            self.measureToolbar.updateSettingsPanel();\n        }\n\n        self.activateInitiator && self.activateInitiator();\n    };\n\n    viewer.addEventListener('finished-calibration', this.onFinishedCalibration);\n\n    this.onMeasurementChanged = function(event) {\n        var type = event.data.type;\n        self.changeMeasurementType(type);\n    };\n\n    viewer.addEventListener(MeasureCommon.Events.MEASUREMENT_CHANGED_EVENT, this.onMeasurementChanged);\n\n    if (viewer.model) {\n        onModelLoaded(this, viewer.model);\n    } else {\n        viewer.addEventListener(av.MODEL_ROOT_LOADED_EVENT, function(event){\n            if(self.unloaded) return false;\t\n            onModelLoaded(self, event.model);\t\n        }, { once: true });\n    }\n\n    return true;\n};\n\nfunction onModelLoaded(measureExt, model) {\n    populateSharedMeasureConfig(measureExt, model);\n\n    if (measureExt.viewer.toolbar) {\n        measureExt.createUI();\n    } else {\n        measureExt.bindedOnToolbarCreated = measureExt.onToolbarCreated.bind(measureExt);\n        measureExt.viewer.addEventListener(av.TOOLBAR_CREATED_EVENT, measureExt.bindedOnToolbarCreated);\n    }\n}\n\n\nfunction populateSharedMeasureConfig(measureExt, model) {\n    measureExt.sharedMeasureConfig.units = model.getDisplayUnit();\n    measureExt.sharedMeasureConfig.precision = model.is2d() ? 3 : 1;\n    measureExt.sharedMeasureConfig.calibrationFactor = measureExt.options.calibrationFactor;\n}\n\n/**\n * Unload the measure extension.\n * @returns {boolean} True if measure extension is unloaded successfully.\n * \n * @alias Autodesk.Viewing.Extensions.MeasureExtension#unload\n*/\nMeasureExtension.prototype.unload = function () {\n    var viewer = this.viewer;\n\n    // Remove the ui from the viewer.\n    this.destroyUI();\n    if (this.bindedOnToolbarCreated) {\n        this.viewer.removeEventListener(av.TOOLBAR_CREATED_EVENT, this.bindedOnToolbarCreated);\n        this.bindedOnToolbarCreated = null;\n    }\n\n    viewer.removeEventListener('finished-calibration', this.onFinishedCalibration);\n    viewer.removeEventListener(MeasureCommon.Events.MEASUREMENT_CHANGED_EVENT, this.onMeasurementChanged);\n\n    viewer.toolController.deregisterTool(this.snapper);\n    this.snapper = null;\n\n    viewer.toolController.deregisterTool(this.measureTool);\n    this.measureTool = null;\n\n    viewer.toolController.deregisterTool(this.calibrationTool);\n    this.calibrationTool = null;\n\n    viewer.toolController.deregisterTool(this.magnifyingGlass);\n    this.magnifyingGlass = null;\n\n    this.unloaded = true;\n    return true;\n};\n\n/**\n * Enable/disable the measure tool.\n * It does not update the toolbar UI.\n * \n * @param {boolean} active - True to activate, false to deactivate.\n * @returns {boolean} True if a change in activeness occurred.\n */\nMeasureExtension.prototype.setActive = function(active) {\n    return this.enableMeasureTool(active);\n};\n\n/**\n * Toggles activeness of the measure tool.\n * It does not update the toolbar UI.\n * \n * @return {boolean} Whether the tool is active.\n */\nMeasureExtension.prototype.toggle = function() {\n    if (this.isActive()) {\n        this.enableMeasureTool(false);\n    } else {\n        this.enableMeasureTool(true);\n    }\n    return this.isActive();\n};\n\n/**\n * Get the current measurement in the measure tool.\n * @param {string} [unitType] - Either: \"decimal-ft\", \"ft\", \"ft-and-decimal-in\", \"decimal-in\", \"fractional-in\", \"m\", \"cm\", \"mm\" or \"m-and-cm\".\n * @param {number} [precision] - precision index (0: 0, 1: 0.1, 2: 0.01, 3: 0.001, 4: 0.0001, 5: 0.00001).\n * When units type is \"ft\", \"in\" or \"fractional-in\", then the precisions are 0: 1, 1: 1/2, 2: 1/4, 3: 1/8, 4: 1/16, 5: 1/32, 6: 1/64.\n * @returns {object|null} Object with properties of the current measurement, or null.\n */\nMeasureExtension.prototype.getMeasurement = function(unitType, precision) {\n    var measurement = null;\n    if (this.measureTool.isActive()) {\n        measurement = this.measureTool.getMeasurement(unitType, precision);\n    }\n    return measurement;\n};\n\n/**\n * Get all available units in measure tool.\n * @returns {object[]} Array of all available units.\n*/\nMeasureExtension.prototype.getUnitOptions = function() {\n    var units = [\n        { name: 'Unknown', type: '' },\n        { name: 'Decimal feet', type: 'decimal-ft' },\n        { name: 'Feet and fractional inches', type: 'ft' },\n        { name: 'Feet and decimal inches', type: 'ft-and-decimal-in' },\n        { name: 'Decimal inches', type: 'decimal-in' },\n        { name: 'Fractional inches', type: 'fractional-in' },\n        { name: 'Meters', type: 'm' },\n        { name: 'Centimeters', type: 'cm' },\n        { name: 'Millimeters', type: 'mm' },\n        { name: 'Meters and centimeters', type: 'm-and-cm' }\n    ];\n\n    return units;\n};\n\n/**\n * Get all available precisions in measure tool.\n * @param {boolean} isFractional - Set true to get fractional precisions.\n * @return {string[]} List of all available precisions.\n*/\nMeasureExtension.prototype.getPrecisionOptions = function(isFractional) {\n\n    var precisions;\n\n    if (isFractional)\n        precisions = ['1', '1/2', '1/4', '1/8', '1/16', '1/32', '1/64'];\n    else\n        precisions = ['0', '0.1', '0.01', '0.001', '0.0001', '0.00001'];\n\n    return precisions;\n};\n\n/**\n * Get the default measure unit in measure tool.\n * @returns {string} The default measure unit.\n*/\nMeasureExtension.prototype.getDefaultUnit = function() {\n    var unit = this.viewer.model.getDisplayUnit();\n\n    return unit;\n};\n\nMeasureExtension.prototype.openCalibrationRequiredDialog = function (initiator) {\n    if (this.hasUI) {\n        if (!this.CalibrationRequiredDialog) {\n            this.CalibrationRequiredDialog = new CalibrationRequiredDialog(this, this.viewer, \"calibration-required\", \"Calibration Required\", this.options );\n        }\n\n        this.CalibrationRequiredDialog.setVisible(true);\n    }\n    else {\n        this.viewer.dispatchEvent({ type: MeasureCommon.Events.CALIBRATION_REQUIRED_EVENT });\n    }\n\n    if (initiator === 'measure') {\n        this.activateInitiator = function() {\n            this.enableMeasureTool(true, DEFAULT_MEASUREMENT_TYPE);\n            this.activateInitiator = null;\n        };\n    } else if (initiator === 'dimension') {\n        this.activateInitiator = function() {\n            this.viewer.dispatchEvent({ type: MeasureCommon.Events.FINISHED_CALIBRATION_FOR_DIMENSION_EVENT });\n            this.activateInitiator = null;\n        };\n    }\n};\n/**\n * @param mode Measurement Mode\n * @returns {boolean}\n */\n\n /**\n  * Activates the tool and UI to start measuring.\n  * \n  * @param {string} [mode] - Either 'distance', 'angle', 'area' (2D only) or 'calibrate'. Default is 'distance'.\n * \n * @alias Autodesk.Viewing.Extensions.MeasureExtension#activate\n  */\nMeasureExtension.prototype.activate = function (mode) {\n    if (this.activeStatus && this.mode === mode) {\n        return;\n    }\n    this.enterMeasurementMode();\n\n    var success;\n\n    switch (mode) {\n        default:\n        case 'distance':\n            success = this.enableMeasureTool(true, MeasureCommon.MeasurementTypes.MEASUREMENT_DISTANCE);\n            break;\n        case 'angle':\n            success = this.enableMeasureTool(true, MeasureCommon.MeasurementTypes.MEASUREMENT_ANGLE);\n            break;\n        case 'area':\n            if(!this.viewer.model.is2d()) {\n                console.warn('Area mode is applicable on 2D models only');\n            } else {\n                success = this.enableMeasureTool(true, MeasureCommon.MeasurementTypes.MEASUREMENT_AREA);\n            }\n            break;\n        case 'calibrate':\n            success = this.enableCalibrationTool(true);\n            break;\n    }\n\n    this.mode = success ? mode : '';\n    this.activeStatus = true;\n    return true;\n};\n\n/**\n * Deactivates measuring tool and UI.\n * \n * @returns {boolean}\n * \n * @alias Autodesk.Viewing.Extensions.MeasureExtension#deactivate\n */\nMeasureExtension.prototype.deactivate = function () {\n    if(this.activeStatus) {\n        this.exitMeasurementMode();\n        this.enableMeasureTool(false);\n        this.activeStatus = false;\n    }\n    return true;\n};\n\n/**\n * Enable/disable the measure tool.\n * @param {boolean} enable - True to enable, false to disable.\n * @returns {boolean} True if the tool state was changed.\n * @private\n */\nMeasureExtension.prototype.enableMeasureTool = function(enable, measurementType) {\n    if (measurementType === MeasureCommon.MeasurementTypes.MEASUREMENT_AREA && this.viewer.model && !this.viewer.model.is2d()) {\n        return false;\n    }\n\n    var toolController = this.viewer.toolController,\n        isActive = (this.selectedTool === MEASURE_TOOL);\n\n    if (!this.viewer.model || (!enable && isActive)) {\n        if (this.measureTool.isActive()) {\n            toolController.deactivateTool(\"measure\");\n\n            if (this.measureToolbar) {\n                this.measureToolbar.deactivateAllButtons();\n            }\n        }\n\n        this.selectedTool = NONE;\n\n        return true;\n    }\n\n    this.forceCalibrate |= this.viewer.model.getData().isLeaflet;\n\n    if (!measurementType) {\n        measurementType = DEFAULT_MEASUREMENT_TYPE;\n    }\n\n    if (enable && !isActive) {\n        // Fetch topology when opening Measure tool for the first time.\n        this.checkAndFetchTopology(toolController.getTool('measure'));\n\n        if (!this.forceCalibrate || (this.forceCalibrate && this.calibrationTool.isCalibrated()) || measurementType === MeasureCommon.MeasurementTypes.MEASUREMENT_ANGLE) {\n            if (this.calibrationTool.isActive()) {\n                toolController.deactivateTool(\"calibration\");\n            }\n            \n            if (this.measureToolbar) {\n                this.measureToolbar.updateSettingsPanel();\n            }\n\n            toolController.activateTool(\"measure\");\n\n            this.selectedTool = MEASURE_TOOL;\n\n            \n\n            this.changeMeasurementType(measurementType);\n            return true;\n        }\n        else {\n            this.viewer.addEventListener(avem.OPEN_TOOL_AFTER_CALIBRAION, function(){\n                this.enableMeasureTool(true);                \n            }.bind(this), {once: true});\n            \n            this.openCalibrationRequiredDialog('measure');\n            return false;\n        }\n\n    } else if (enable && isActive) {\n        if (!this.forceCalibrate || (this.forceCalibrate && this.calibrationTool.isCalibrated()) || measurementType === MeasureCommon.MeasurementTypes.MEASUREMENT_ANGLE) {\n            this.changeMeasurementType(measurementType);\n            return true;\n        }\n        else {\n            this.openCalibrationRequiredDialog('measure');\n            return false;\n        }\n    }\n\n    return false;\n};\n\nMeasureExtension.prototype.changeMeasurementType = function(measurementType) {\n    this.measureTool.changeMeasurementType(measurementType);\n    if (this.measureToolbar) {\n        this.measureToolbar.deactivateAllButtons();\n        this.measureToolbar.activateButtonByType(measurementType);\n    }\n};\n\n/**\n * Enable/disable the measure tool.\n * @param {boolean} enable - True to enable, false to disable.\n * @returns {boolean} True if the tool state was changed.\n * @private\n */\nMeasureExtension.prototype.enableCalibrationTool = function(enable) {\n    var toolController = this.viewer.toolController,\n        isActive = (this.selectedTool == CALIBRATION_TOOL);\n\n    if (enable && !isActive) {\n        if (this.measureTool.isActive()) {\n            toolController.deactivateTool(\"measure\");\n        }\n        \n        toolController.activateTool(\"calibration\");\n        this.viewer.dispatchEvent({ type: MeasureCommon.Events.UNITS_CALIBRATION_STARTS_EVENT });\n        \n        if (this.measureToolbar) {\n            this.measureToolbar.deactivateAllButtons();\n            this.measureToolbar.activateButtonByType(MeasureCommon.MeasurementTypes.CALIBRATION);\n        }\n\n        this.selectedTool = CALIBRATION_TOOL;\n        return true;\n\n    } else if (!enable && isActive) {\n        if (this.calibrationTool.isActive()) {\n            this.mode = '';\n            toolController.deactivateTool(\"calibration\");\n            if (this.measureToolbar) {\n                this.measureToolbar.deactivateAllButtons();\n            }\n        }\n\n        this.selectedTool = NONE;\n        return true;\n    }\n    return false;\n};\n\n/**\n * @private\n */\nMeasureExtension.prototype.enterMeasurementMode = function() {\n\n    if (this._measurementMode) return;\n    this._measurementMode = true;\n\n    if (!this.viewer.getToolbar) {\n        return; // Adds support for Viewer3D instance\n    }\n\n    var toolbar = this.viewer.getToolbar(false);    \n    var viewerToolbarContainer = toolbar.container;\n    var viewerContainerChildrenCount = viewerToolbarContainer.children.length;\n    for(var i = 0; i < viewerContainerChildrenCount; ++i) {\n        viewerToolbarContainer.children[i].style.display = \"none\";\n    }\n\n    this.navigationControls = toolbar.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID);\n    this.navigationControls.setVisible(true);\n    this.navigationControls.container.style.display = '';\n\n    this.measureControls = toolbar.getControl(Autodesk.Viewing.TOOLBAR.MEASURETOOLSID);\n    this.measureControls.setVisible(true);\n    this.measureControls.container.style.display = '';\n    \n    var modelTools = toolbar.getControl(av.TOOLBAR.MODELTOOLSID);\n    var measureButtonId = this.measurementToolbarButton.getId();\n    this.measurementToolbarButton.index = modelTools.indexOf(measureButtonId);\n    modelTools.removeControl(measureButtonId);\n\n    this.measureToolbar.toggleVisible();\n\n    if (this.viewer.centerToolBar) {\n        this.viewer.centerToolBar();\n    }\n\n    this.enableMeasureTool(true, DEFAULT_MEASUREMENT_TYPE);\n};\n\n/**\n * @private\n */\nMeasureExtension.prototype.exitMeasurementMode = function() {\n    if (!this._measurementMode) return;\n    this.measureToolbar && this.measureToolbar.closeToolbar();\n    if (this.CalibrationRequiredDialog && this.CalibrationRequiredDialog.isVisible()) {\n        this.CalibrationRequiredDialog.setVisible(false);\n    }\n    this._measurementMode = false;\n};\n\n/**\n * Create measure button in toolbar.\n * @private\n*/\nMeasureExtension.prototype.createUI = function()\n{\n    var self   = this;\n    var viewer = this.viewer;\n\n    var toolbar = viewer.getToolbar(true);\n\n    // Add Measure button to toolbar\n    var modelTools = toolbar.getControl(av.TOOLBAR.MODELTOOLSID);\n    this.measurementToolbarButton = new avu.Button('toolbar-measurementSubmenuTool');\n    this.measurementToolbarButton.setToolTip('Measure');\n    this.measurementToolbarButton.setIcon(\"adsk-icon-measure\");\n    modelTools.measurementToolbarButton = this.measurementToolbarButton;\n    modelTools.addControl(this.measurementToolbarButton, {index:0});\n    \n    this.measureToolbar = new MeasureToolbar(this);\n    this.measureToolbar.init();\n\n    this.measurementToolbarButton.onClick = this.activate.bind(this);\n\n    // Escape hotkey to exit tool.\n    //\n    var hotkeys = [{\n        keycodes: [\n            Autodesk.Viewing.KeyCode.ESCAPE\n        ],\n        onRelease: function () {\n            if (self._measurementMode) {\n                self.exitMeasurementMode();\n                return true;\n            }\n        }\n    }];\n    viewer.getHotkeyManager().pushHotkeys(this.escapeHotkeyId, hotkeys);\n\n    // Finally\n    this.uiCreated = true;\n};\n\n\n/**\n * @private\n */\nMeasureExtension.prototype.checkAndFetchTopology = function(tool) {\n\n    if (!this.uiCreated || !this.viewer.model.is3d()) {\n        tool && tool.setNoTopology();\n        return;\n    }\n\n    if (this.viewer.modelHasTopology()){\n        tool && tool.setTopologyAvailable();\n        return;\n    }\n\n    // Fetch topology from backend.\n    tool && tool.setFetchingTopology();\n    this.viewer.model.fetchTopology()\n    .then(function(topoData){\n        tool && tool.setTopologyAvailable();\n    })\n    .catch(function(err){\n        avp.logger.log(err); // No topology\n        tool && tool.setNoTopology();\n    });\n};\n\n/**\n * Destroy measure button in toolbar.\n * @private\n*/\nMeasureExtension.prototype.destroyUI = function()\n{\n    var viewer = this.viewer;    \n\n    var toolbar = viewer && viewer.getToolbar && viewer.getToolbar(false);\n    if (toolbar) {\n        var modelTools = toolbar.getControl(av.TOOLBAR.MODELTOOLSID);\n        if (modelTools) {\n            var submenu = null;\n            \n            if (this.measurementToolbarButton) {\n                submenu = modelTools.getControl(\"toolbar-inspectSubMenu\");\n                if (submenu) {\n                    submenu.removeControl(this.measurementToolbarButton.getId());\n                } else {\n                    modelTools.removeControl(this.measurementToolbarButton.getId());\n                }\n            }\n\n            this.measurementToolbarButton = null;\n        }\n    }\n\n    viewer.getHotkeyManager().popHotkeys(this.escapeHotkeyId);\n};\n\nMeasureExtension.prototype.setUnits = function(units) {\n    this.measureTool.setUnits(units);\n};\n\nMeasureExtension.prototype.getUnits = function() {\n    return this.measureTool.getUnits();\n};\n\nMeasureExtension.prototype.setPrecision = function(precision) {\n    this.measureTool.setPrecision(precision);\n};\n\nMeasureExtension.prototype.getPrecision = function() {\n    return this.measureTool.getPrecision();\n};\n\nMeasureExtension.prototype.calibrate = function(requestedUnits, requestedSize) {\n    this.calibrationTool.calibrate(requestedUnits, requestedSize);\n};\n\nMeasureExtension.prototype.calibrateByScale = function(requestedUnits, requestedScale) {\n    this.calibrationTool.calibrateByScale(requestedUnits, requestedScale);\n};\n\nMeasureExtension.prototype.isCalibrationValid = function(requestedUnits, requestedSize) { \n    return this.calibrationTool.isCalibrationValid(requestedUnits, requestedSize); \n};\n\nMeasureExtension.prototype.getCalibrationFactor = function() {\n    return this.calibrationTool.getCalibrationFactor();\n};\n\nMeasureExtension.prototype.showAddCalibrationLabel = function() {\n    this.calibrationTool.showAddCalibrationLabel();\n};\n\n/**\n * Deletes the selected measurement.\n * \n * @alias Autodesk.Viewing.Extensions.MeasureExtension#deleteCurrentMeasurement\n */\nMeasureExtension.prototype.deleteCurrentMeasurement = function() {\n    this.measureTool.deleteCurrentMeasurement();\n};\n\nMeasureExtension.prototype.selectMeasurementById = function(id) {\n    this.measureTool.selectMeasurementById(id);\n};\n\nav.theExtensionManager.registerExtension('Autodesk.Measure', MeasureExtension);\n\n\n"],"sourceRoot":""}